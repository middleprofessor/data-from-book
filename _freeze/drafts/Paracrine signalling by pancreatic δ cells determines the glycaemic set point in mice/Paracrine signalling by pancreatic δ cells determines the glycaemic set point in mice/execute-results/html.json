{
  "hash": "09e15a1fa8409ec9b0d27637b428de6d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"xxx\"\nsubtitle: \"Data From Fig 1h, i -- Paracrine signalling by pancreatic δ cells determines the glycaemic set point in mice\"\nauthor: \"Jeff Walker\"\ndate: '20 Aug 2024'\ndate-modified: \"2024-09-05\"\ncategories: [\"nested subsampling\", \"linear mixed model\", \"ggplot\", \"simulation\"]\ndescription: \"xxx\"\ndraft: true\nformat: \n  html: \n    toc: true \n    toc-location: right\nexecute: \n  freeze: true\n  message: false\n  warning: false\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n\n\n![ggplot better-than-replication of Fig 2b from the article. It's better because the plot shows the nested subsampling design...and the p-values account for this design](../../figs/ER calcium depletion as a key driver for impaired ER-to-mitochondria calcium transfer and mitochondrial dysfunction in Wolfram syndrome/fig2b_ggplot.png){width=4in fig-align=\"left\"}\n\n## Vital info\n\nData From: [Liiv, M., Vaarmann, A., Safiulina, D., Choubey, V., Gupta, R., Kuum, M., ... & Kaasik, A. (2024). ER calcium depletion as a key driver for impaired ER-to-mitochondria calcium transfer and mitochondrial dysfunction in Wolfram syndrome. Nature Communications, 15(1), 6143.](https://www.nature.com/articles/s41467-024-50502-x){target=\"_blank\"}\n\nFig: 2b [download data](../../data from/ER calcium depletion as a key driver for impaired ER-to-mitochondria calcium transfer and mitochondrial dysfunction in Wolfram syndrome/Source data for Figures and Table.xlsx){target=\"_blank\"}\n\nkey words: \n\nPublished methods: ANOVA model with Sidak adjustment for the *p*-values\n\nDesign: Randomized Complete Block Design with nested subsampling (RCBDSS)\n\nResponse: ER Ca++ levels\n\nKey learning concepts: analyzing replicated experiments with RM-ANOVA or LMMs\n\nMore info: [Chapter 16 Models for non-independence -- linear mixed models](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/lmm){target=\"_blank\"}\n\n## TL;DR\n\nFig 2b contains four replicates of an experiment, each with four treatment levels. The data were analyzed with an ANOVA model. There is nothing unusual about this. This is too bad because replicated experiments are examples of Randomized Complete Block Designs, where each experiment is a block. Analyzing blocked designs using best-practice models increases power, so the usual ANOVA model is a lost opportunity. What is *highly* unusual about this publication is the researchers identified the experiments in the archived data, which means I can reanalyze the data with a best practice model, either a linear mixed model or an equivalent repeated measures (RM) ANOVA.\n\nThe data in Fig 2b is actually more complex than that for a simple RCBD. In the experiment, there are four replicates of an experiment, where each experiment contains three replicate dishes for each treatment and ten measures from each dish. The researchers analyzed the data as if the sample size (n) is 10 x 3 x 4 = 120, which assumes all measurements within a treatment are independent. In fact, measures within a dish share variance, dishes within a treatment:experiment combination share variance, and dishes across treatments within an experiment share variance. The researchers' analysis is pseudoreplicated. A simulation of the data shows that the Type I error rate, which leads to false discovery, is about three times the expected rate.\n\n* the design is actually 2 x 2 factorial but I'll treat it as if its 4 x 0.\n\n## The experiment\n\nWithin one experimental replicate, there were three culture dishes per treatment and the researchers measured Ca++ levels in ten neurons per culture dish. The experiment was replicated four times.\n\nFrom an e-mail from A. Vaarmann: \"A single block corresponds to measurements from 10 neurons from one cell culture dish. Each cell culture preparation contributes at least 3 dishes to one treatment group, so 3 times 10 neurons equals 30 neurons per group. This also answers your second question. All measurements within three blocks (three blocks of 10 rows with a blank row in between blocks) correspond to one cell culture preparation i.e. n=30 per group as shown in the right panel of Fig. 1e (n = 30, 30, 30, or 29 neurons). In cases where n=60 (or more, e.g., n=90) as shown in the left panel of Fig.1e, the data from two replicate experiments are combined, with the only difference being that they are from different cell culture preparations. All other conditions are kept as similar as possible, i.e., the time between transfections and imaging, and the imaging settings.\n\nAll experiments have been repeated at least three times, i.e., with three cell culture preparations, but data from multiple cultures are combined only if the microscopy settings and the conditions between transfection and imaging are the same. That's why the neuron n varies in different panels of the figures.\"\n\nThe researchers analyzed the data as if the sample size, n, is 10 x 3 x 4 = 120, which assumes all measurements within a treatment are independent. In fact, measures within a dish share variance, dishes within a treatment:experiment combination share variance, and dishes across treatments within an experiment share variance. The researchers' analysis is pseudoreplicated.\n\n## Setup\n\n\n\n\n\n\n\n\n\n\n\n## Fig 1h,i: time effect\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"Paracrine signalling by pancreatic δ cells determines the glycaemic set point in mice\"\nfile_name <- \"42255_2023_944_MOESM3_ESM.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig1h_in <- read_excel(file_path,\n                    sheet = \"Fig. 1H\",\n                    range = \"A2:L3\",\n                    col_names = FALSE) |>\n  data.table() |>\n  transpose(make.names = 1)\nN <- nrow(fig1h_in)\nfig1h_wide <- data.table(\n  mouse = paste0(\"mouse_\", 1:N),\n  genotype = rep(c(\"WT\", \"CKO\"), c(7,4)),\n  fig1h_in\n) |>\n  clean_names()\nfig1h_wide[, genotype := factor(genotype, levels = c(\"WT\", \"CKO\"))]\nfig1h <- melt(fig1h_wide,\n              id.vars = c(\"mouse\", \"genotype\"),\n              variable.name = \"time\",\n              value.name = \"insulin\")\nfig1h[, time := factor(time, levels = c(\"x0_min\", \"x15_min\"))]\n\n\n# output as clean excel file\nfileout_name <- \"fig1h-prepost-Paracrine signalling by pancreatic δ cells determines the glycaemic set point in mice.xlsx\"\nfileout_path <- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig1h, fileout_path)\n```\n:::\n\n\n\n\n\n## Ancova\n\nexpected no difference at baseline. not true because cKO may have effect on baseline insulin -- these aren't drawn from same hat, even if the two hats have similar mean.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(x15_min ~ genotype + x0_min, data = fig1h_wide)\ncoef(summary(lm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Estimate Std. Error  t value   Pr(>|t|)\n(Intercept) 0.2632890  0.1365343 1.928372 0.08994631\ngenotypeCKO 0.2619382  0.1134987 2.307852 0.04985599\nx0_min      1.0107851  0.4345505 2.326048 0.04845976\n```\n\n\n:::\n:::\n\n\n\n\n\n## time series model\n\nallows for difference at baseline\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(insulin ~ time * genotype + (1 | mouse), data = fig1h)\ncoef(summary(lmm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          Estimate Std. Error       df   t value     Pr(>|t|)\n(Intercept)             0.27785714 0.06497805 13.55904 4.2761695 0.0008232028\ntimex15_min             0.26628571 0.06009677  9.00000 4.4309488 0.0016448953\ngenotypeCKO             0.09514286 0.10775390 13.55904 0.8829644 0.3926414100\ntimex15_min:genotypeCKO 0.26296429 0.09965922  9.00000 2.6386348 0.0269740803\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1_emm <- emmeans(lmm1, specs = c(\"time\", \"genotype\"))\nlmm1_pairs <- contrast(lmm1_emm,\n                       method = \"revpairwise\") |>\n  summary(infer = TRUE)\nplot_response(lmm1, lmm1_emm, lmm1_pairs)\n```\n\n::: {.cell-output-display}\n![](Paracrine-signalling-by-pancreatic-δ-cells-determines-the-glycaemic-set-point-in-mice_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggcheck_the_model(lmm1)\n```\n\n::: {.cell-output-display}\n![](Paracrine-signalling-by-pancreatic-δ-cells-determines-the-glycaemic-set-point-in-mice_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## fold change model\n\nusing glm offset\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm1 <- glm(x15_min ~ genotype + offset(log(x0_min)),\n            family = Gamma(link = \"log\"),\n            data = fig1h_wide)\nglm1_emm <- emmeans(glm1, specs = \"genotype\", type = \"response\")\ncoef(summary(glm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Estimate Std. Error   t value    Pr(>|t|)\n(Intercept) 0.85232355  0.2302067 3.7024272 0.004902104\ngenotypeCKO 0.05717101  0.3817546 0.1497585 0.884257470\n```\n\n\n:::\n\n```{.r .cell-code}\nexp(coef(summary(glm1))[,1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) genotypeCKO \n   2.345089    1.058837 \n```\n\n\n:::\n:::\n\n\n\n\n\nusing ratio\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfig1h_wide[, fold_change := x15_min/x0_min]\nlm2 <- lm(fold_change ~ genotype,\n            data = fig1h_wide)\ncoef(summary(lm2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Estimate Std. Error   t value    Pr(>|t|)\n(Intercept) 2.3450895  0.5402752 4.3405464 0.001875967\ngenotypeCKO 0.1379777  0.8959450 0.1540024 0.881005785\n```\n\n\n:::\n\n```{.r .cell-code}\nlm2_emm <- emmeans(lm2, specs = \"genotype\")\nlm2_pairs <- contrast(lm2_emm,\n                      method = \"revpairwise\") |>\n  summary(infer = TRUE)\nplot_response(lm2, lm2_emm, lm2_pairs)\n```\n\n::: {.cell-output-display}\n![](Paracrine-signalling-by-pancreatic-δ-cells-determines-the-glycaemic-set-point-in-mice_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n1. Notes on the fold change model\n\nTreats x0_min as if its a sampling effort, so assumes x15_min is proportional to this effort with constant of 1 (in log space). What this means is that we expect that if x0_min differs by dx from the mean we expect x15_min to differ by dx from the mean. This would occur if x15 is entirely a function of the individual and not the time. We don't expect this at all.\n\nwe expect individuals with more insulin at x0 to have more at x15 but should the slope be 1. What determines this slope?\n\n1. Things that grow at the same rate. If the femur is 1/4 of my height then if I grow twice as tall, the femur should still be 1/4 of my height. On a log-log plot of femur length and height, the slope of the points should be one.\n2. Sampling effort. If the proportion of x is 1/4 then if I sample twice as much the proportion should still be 1/4. On a log-log plot of cell-count vs volume sampled, the slope of the line should be one (this leads to the offset model)\n\nWe get the measured slope with the glm model but use x0_min as a covariate and not an offset. The measured slope is 0.28 and 1.0 is well above 95% CI.\n\nsome other examples of the response being the fold change from baseline\n\n1. https://aacrjournals.org/clincancerres/article/18/13/3677/287295/Prospective-Study-of-Changes-in-the-Metabolomic\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm2 <- glm(x15_min ~ genotype + log(x0_min),\n            family = Gamma(link = \"log\"),\n            data = fig1h_wide)\nout_table <- cbind(\n  coef(summary(glm2)),\n  confint(glm2)\n)\nout_table|>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|            | Estimate| Std. Error| t value| Pr(>&#124;t&#124;)|  2.5 %| 97.5 %|\n|:-----------|--------:|----------:|-------:|------------------:|------:|------:|\n|(Intercept) |   -0.221|      0.389|  -0.567|              0.586| -0.903|  0.508|\n|genotypeCKO |    0.398|      0.242|   1.643|              0.139| -0.075|  0.880|\n|log(x0_min) |    0.285|      0.264|   1.079|              0.312| -0.186|  0.749|\n\n\n:::\n:::\n\n\n\n\n\nWe can kinda get what this looks like with by plotting the regression lines for the offset and covariate models on the log-transformed data.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfig1h_wide[, y_hat_offset := predict(glm1, fig1h_wide)]\nfig1h_wide[, y_hat_cov := predict(glm2, fig1h_wide)]\nggplot(data = fig1h_wide,\n       aes(x = log(x0_min),\n           y = log(x15_min),\n           color = genotype)) +\n  geom_point() +\n  geom_line(aes(y = y_hat_offset)) +\n  geom_line(aes(y = y_hat_cov),\n            linetype = \"dashed\") +\n  NULL\n```\n\n::: {.cell-output-display}\n![](Paracrine-signalling-by-pancreatic-δ-cells-determines-the-glycaemic-set-point-in-mice_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\nglm model\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm3 <- glmmTMB(insulin ~ time * genotype + (1 | mouse),\n            family = Gamma(link = \"log\"),\n            data = fig1h)\ncoef(summary(glm3))$cond\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          Estimate Std. Error    z value     Pr(>|z|)\n(Intercept)             -1.3158710  0.1525495 -8.6258597 6.361295e-18\ntimex15_min              0.6776881  0.1809719  3.7447141 1.805993e-04\ngenotypeCKO              0.3200580  0.2506332  1.2769975 2.016031e-01\ntimex15_min:genotypeCKO  0.2146562  0.2978256  0.7207447 4.710666e-01\n```\n\n\n:::\n\n```{.r .cell-code}\nglm3_emm <- emmeans(glm3, specs = c(\"time\", \"genotype\"), type = \"response\")\nglm3_pairs <- contrast(glm3_emm,\n                       method = \"revpairwise\",\n                       simple = \"each\",\n                       combine = TRUE) |>\n  summary(infer = TRUE)\nglm3_pairs|>\n  kable(digits = 4) |>\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> genotype </th>\n   <th style=\"text-align:left;\"> time </th>\n   <th style=\"text-align:left;\"> contrast </th>\n   <th style=\"text-align:right;\"> ratio </th>\n   <th style=\"text-align:right;\"> SE </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> asymp.LCL </th>\n   <th style=\"text-align:right;\"> asymp.UCL </th>\n   <th style=\"text-align:right;\"> null </th>\n   <th style=\"text-align:right;\"> z.ratio </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> WT </td>\n   <td style=\"text-align:left;\"> . </td>\n   <td style=\"text-align:left;\"> x15_min / x0_min </td>\n   <td style=\"text-align:right;\"> 1.9693 </td>\n   <td style=\"text-align:right;\"> 0.3564 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 1.2532 </td>\n   <td style=\"text-align:right;\"> 3.0947 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.7447 </td>\n   <td style=\"text-align:right;\"> 0.0007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CKO </td>\n   <td style=\"text-align:left;\"> . </td>\n   <td style=\"text-align:left;\"> x15_min / x0_min </td>\n   <td style=\"text-align:right;\"> 2.4408 </td>\n   <td style=\"text-align:right;\"> 0.5770 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 1.3525 </td>\n   <td style=\"text-align:right;\"> 4.4051 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.7749 </td>\n   <td style=\"text-align:right;\"> 0.0006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> . </td>\n   <td style=\"text-align:left;\"> x0_min </td>\n   <td style=\"text-align:left;\"> CKO / WT </td>\n   <td style=\"text-align:right;\"> 1.3772 </td>\n   <td style=\"text-align:right;\"> 0.3452 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 0.7364 </td>\n   <td style=\"text-align:right;\"> 2.5756 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.2770 </td>\n   <td style=\"text-align:right;\"> 0.8064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> . </td>\n   <td style=\"text-align:left;\"> x15_min </td>\n   <td style=\"text-align:left;\"> CKO / WT </td>\n   <td style=\"text-align:right;\"> 1.7070 </td>\n   <td style=\"text-align:right;\"> 0.4288 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 0.9114 </td>\n   <td style=\"text-align:right;\"> 3.1968 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.1286 </td>\n   <td style=\"text-align:right;\"> 0.1332 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfig1h_wide[, .(fc = mean(x15_min)/mean(x0_min),\n               logfc = (log(mean(x15_min)) - log(mean(x0_min)))), by = .(genotype)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   genotype       fc     logfc\n     <fctr>    <num>     <num>\n1:       WT 1.958355 0.6721047\n2:      CKO 2.418901 0.8833132\n```\n\n\n:::\n\n```{.r .cell-code}\nexp(0.8833132 - 0.6721047)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.23517\n```\n\n\n:::\n\n```{.r .cell-code}\nexp(0.2146562)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.239436\n```\n\n\n:::\n\n```{.r .cell-code}\n2.418901/1.958355\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.23517\n```\n\n\n:::\n:::\n\n\n\n\n\n## Fig 1l: dose effect\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"Paracrine signalling by pancreatic δ cells determines the glycaemic set point in mice\"\nfile_name <- \"42255_2023_944_MOESM3_ESM.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig1l_in <- read_excel(file_path,\n                    sheet = \"Fig. 1L\",\n                    range = \"A2:m3\",\n                    col_names = FALSE) |>\n  data.table() |>\n  transpose(make.names = 1)\nN <- nrow(fig1l_in)\nfig1l_wide <- data.table(\n  mouse = paste0(\"mouse_\", 1:N),\n  genotype = rep(c(\"WT\", \"CKO\"), c(6,6)),\n  fig1l_in\n) |>\n  clean_names()\nfig1l_wide[, genotype := factor(genotype, levels = c(\"WT\", \"CKO\"))]\nfig1l_wide[x3_m_m > 0.6, x3_m_m := NA]\nfig1l_wide[x11_m_m > 0.6, x11_m_m := NA]\nsetnames(fig1l_wide, old = c(\"x3_m_m\", \"x11_m_m\"), new = c(\"3mM\", \"11mM\"))\n\nfig1l <- melt(fig1l_wide,\n              id.vars = c(\"mouse\", \"genotype\"),\n              variable.name = \"dose\",\n              value.name = \"insulin\")\nfig1l[, time := factor(dose, levels = c(\"3mM\", \"11mM\"))]\n\n\n# output as clean excel file\nfileout_name <- \"fig1l-prepost-Paracrine signalling by pancreatic δ cells determines the glycaemic set point in mice.xlsx\"\nfileout_path <- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig1l, fileout_path)\n```\n:::\n\n\n\n\n\n## 2-factor model\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(insulin ~ genotype * dose, data = fig1l)\ncoef(summary(lm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Estimate Std. Error    t value   Pr(>|t|)\n(Intercept)           0.03180000 0.01492922  2.1300512 0.04807311\ngenotypeCKO          -0.00400000 0.02111310 -0.1894558 0.85197919\ndose11mM              0.02553333 0.02021426  1.2631349 0.22359079\ngenotypeCKO:dose11mM  0.02966667 0.02922977  1.0149470 0.32435937\n```\n\n\n:::\n:::\n\n\n\n\n\n## exploration\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrac <- 1/4\nn <- 10^3\ncells_0 <- rnorm(n, mean = 1000, sd = 100)\nmarked_0 <- frac*cells_0 + rnorm(n, mean = 0, sd = 10)\ncells_1 <- cells_0 + rnorm(n, mean = 0, sd = 10)\nmarked_1 <- marked_0/cells_0*cells_1 + rnorm(n, mean = 0, sd = 10)\ncor(cells_0, marked_0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9214387\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(cells_1, marked_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8634122\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(marked_0, marked_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.92789\n```\n\n\n:::\n\n```{.r .cell-code}\nfd <- data.table(\n  \"cells_0\" = cells_0,\n  \"marked_0\" = marked_0,\n  \"cells_1\" = cells_1,\n  \"marked_1\" = marked_1\n)\n\nlm1 <- lm(marked_0 ~ cells_0, data = fd)\ncoef(summary(lm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Estimate Std. Error  t value Pr(>|t|)\n(Intercept) 3.9397449 3.29316465  1.19634 0.231848\ncells_0     0.2459702 0.00328298 74.92284 0.000000\n```\n\n\n:::\n\n```{.r .cell-code}\nlm2 <- lm(log(marked_0) ~ log(cells_0), data = fd)\ncoef(summary(lm2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  -1.2832115 0.09161724 -14.00622 7.973409e-41\nlog(cells_0)  0.9849159 0.01327381  74.19995 0.000000e+00\n```\n\n\n:::\n\n```{.r .cell-code}\nlm3 <- lm(log(marked_1) ~ log(cells_1), data = fd)\ncoef(summary(lm3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Estimate Std. Error   t value      Pr(>|t|)\n(Intercept)  -1.2611905 0.12646529 -9.972622  2.152380e-22\nlog(cells_1)  0.9816955 0.01832251 53.578668 6.911238e-296\n```\n\n\n:::\n\n```{.r .cell-code}\nlm4 <- lm(log(marked_1) ~ log(marked_0), data = fd)\ncoef(summary(lm4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Estimate Std. Error    t value  Pr(>|t|)\n(Intercept)   0.03209996 0.07061300  0.4545899 0.6495031\nlog(marked_0) 0.99415309 0.01280359 77.6464310 0.0000000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 10^3\nsize_0 <- exp(rnorm(n, mean = log(10), sd = log(1.2)))\n# mean(size_0)\n# sd(size_0)\nalpha <- 0.9\nlogsize_0 <- rnorm(n, mean = 0, sd = 1) # centered scaled in log space\nlogheight_0 <- alpha * logsize_0 + sqrt(1 - alpha^2)*rnorm(n, mean = 0, sd = 1)\nloglength_0 <- alpha * logsize_0 + sqrt(1 - alpha^2)*rnorm(n, mean = 0, sd = 1)\ncor(logheight_0, loglength_0)\nlogsize_1 <- 2 * logsize_0\nlogheight_1 <- alpha * 2*logsize_0 + sqrt(1 - alpha^2)*rnorm(n, mean = 0, sd = 1)\nloglength_1 <- alpha * 2*logsize_0 + sqrt(1 - alpha^2)*rnorm(n, mean = 0, sd = 1)\ncor(logheight_1, loglength_1)\n\n# mean(height_0)\n# sd(height_0)\n# sd(height_0)^2\nlength_0 <- 1/4*height_0 + rnorm(n, mean = 0, sd = sd(height_0)/10)\n# mean(length_0)\n# sd(length_0)\ncor(height_0, length_0)\nheight_2 <- 2 * height_0 + rnorm(n, mean = 0, sd = sd(height_0) * sqrt(2))\n# mean(height_2)\n# sd(height_2)\n# sd(height_2)^2\nlength_2 <- 1/4*height_0 + rnorm(n, mean = 0, sd = sd(height_0)/10)\n\nggplot(data = fd,\n       x = log(height_0),\n       y = log(length_0)) +\n  geom_point()\n```\n:::\n",
    "supporting": [
      "Paracrine-signalling-by-pancreatic-δ-cells-determines-the-glycaemic-set-point-in-mice_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}