{
  "hash": "10f75e05be2653db3a14aa8691815b1e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multiple testing\"\nsubtitle: \"Data From Fig 3d-u -- Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice\"\nauthor: \"Jeff Walker\"\ndate: '2 October 2024'\ndate-modified: \"2024-10-02\"\ncategories: [\"xxx\"]\ndescription: \"xxx\"\ndraft: true\nformat: \n  html: \n    toc: true \n    toc-location: right\nexecute: \n  message: false\n  warning: false\n  freeze: true\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n## Vital info\n\nData From: [Su, H., Guo, H., Qiu, X. et al. Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice. Nat Commun 14, 6729 (2023). https://doi.org/10.1038/s41467-023-42473-2](https://www.nature.com/articles/s41467-023-42473-2){target=\"_blank\"}\n\nFig: xxx [download data](../../data from/Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice/41467_2023_42473_MOESM7_ESM.xlsx){target=\"_blank\"}\n\nkey words: \n\nPublished methods: xxx\n\nDesign: xxx\n\nResponse: xxx\n\nKey learning concepts: multiple testing\n\nMore info: [xxx](xxx){target=\"_blank\"}\n\n## The experiment\n\nxxx\n\nTreatments\n\n1. xxx\n2. xxx\n\n## Setup\n\n\n\n\n\n\n\n## Fig 3d-u\n\nresearchers used: t-test on all data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice\"\nfile_name <- \"41467_2023_42473_MOESM7_ESM.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\n# note I had to insert rows in the excel file \n# in between some of the\n# sets because of inconsistency in the file\nfig3_import <- function(range_in = \"xxx\"){\n  fig3_wide <- read_excel(file_path,\n                    sheet = \"Fig. 3\",\n                    range = range_in) |>\n    data.table()\n  fig3_long <- melt(fig3_wide,\n                    measure.vars = colnames(fig3_wide),\n                    variable.name = \"treatment\",\n                    value.name = \"cardiolipin\") |>\n    na.omit()\n  fig3_long[, treatment := factor(treatment,\n                                  levels = colnames(fig3_wide))]\n  return(fig3_long)\n}\n\nfig3 <- data.table(NULL)\nrow_1 <- 12\nfor(fig_id in letters[4:21]){\n  row_2 <- row_1 + 5\n  range_in <- paste0(\n    \"B\",row_1,\":E\",row_2\n  )\n  fig3 <- rbind(\n    fig3,\n    data.table(\n      figure = fig_id,\n      fig3_import(range_in))\n  )\n  row_1 <- row_2 + 4\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlipin_id <- unique(fig3$figure)\nn_cardiolipins <- length(lipin_id)\n\np_table <- data.table(NULL)\nfor(set_i in 1:n_cardiolipins){\n  subdata <- fig3[figure == lipin_id[set_i]]\n  m1 <- lm(cardiolipin ~ treatment, data = subdata)\n  m1_pairs <- emmeans(m1, specs = \"treatment\") |>\n    contrast(method = \"revpairwise\",\n             adjust = \"none\") |>\n    summary() |>\n    data.table()\n  # authors are keeping contrasts in rows 1,2,6 and use t-test\n  p1 <- t.test(subdata[treatment == \"WT-Saline\", cardiolipin],\n               subdata[treatment == \"WT-CL\", cardiolipin],\n               var.equal = TRUE)$p.value\n  p2 <- t.test(subdata[treatment == \"WT-Saline\", cardiolipin],\n               subdata[treatment == \"KO-Saline\", cardiolipin],\n               var.equal = TRUE)$p.value\n  p3 <- t.test(subdata[treatment == \"KO-Saline\", cardiolipin],\n               subdata[treatment == \"KO-CL\", cardiolipin],\n               var.equal = TRUE)$p.value\n  p_table <- rbind(\n    p_table,\n    data.table(\n      lipin_id = lipin_id[set_i],\n      m1_pairs[c(1,2,6), .SD, .SDcols = c(\"contrast\", \"p.value\")],\n      ttest = c(p1, p2, p3)\n    )\n  )\n}\n\n  p_table[, holm := p.adjust(ttest, \"holm\") |> round(3)]\n  p_table[, fdr := p.adjust(ttest, \"fdr\") |> round(3)]\n  p_table[, ttest := round(ttest, 4)]\n  \n  data.table(\n    adjust = c(\"lm\",\"ttest\", \"holm\", \"fdr\"),\n    n_lt_5 = c(sum(p_table[, p.value] < 0.05),\n               sum(p_table[, ttest] < 0.05),\n               sum(p_table[, holm] < 0.05),\n               sum(p_table[, fdr] < 0.05))\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   adjust n_lt_5\n   <char>  <int>\n1:     lm     28\n2:  ttest     26\n3:   holm      6\n4:    fdr     16\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}