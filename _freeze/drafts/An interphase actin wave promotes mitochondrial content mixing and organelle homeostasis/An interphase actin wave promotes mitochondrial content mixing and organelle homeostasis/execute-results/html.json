{
  "hash": "4c156387fca51253ff4939728be186ae",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Models for Replicated Experiments: Randomized Complete Block Designs with Subsampling\"\nsubtitle: \"Data From Fig xxx -- An interphase actin wave promotes mitochondrial content mixing and organelle homeostasis\"\nauthor: \"Jeff Walker\"\ndate: '26 July 2024'\ndate-modified: \"2024-08-16\"\ncategories: [\"linear mixed model\", \"ratio paired t-test\", \"randomized complete block design\", \"ratio paired t-test\", \"pseudoreplication\"]\ndescription: \"The authors have many nice examples of replicated experiments, which are a kind of blocked experimental design. Here, I focus on three of the experiments -- each should be analyzed in the same way but were analyzed in a different way. More generally, experimental bench biology doesn't seem too aware of the best practice method for analyzing data from block designs, other than the special case of paired t-tests. \"\ndraft: true\nformat: \n  html: \n    toc: true \n    toc-location: right\nexecute: \n  message: false\n  warning: false\n  freeze: true\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n![ggplot better-than-replication of Fig 3b from the article. It's better than because the confidence intervals from the model are asymmetric and reflect the right (upward) skew of the data](../../figs/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/fig3b_ggplot.png){width=4in fig-align=\"left\"}\n\n## Vital info\n\nData From: [Serrano, J., Boyd, J., Brown, I.S. et al. The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity. Nat Commun 15, 4915 (2024). https://doi.org/10.1038/s41467-024-49100-8](https://www.nature.com/articles/s41467-024-49100-8){target=\"_blank\"}\n\nFig: xxx [download data](../../data from/An interphase actin wave promotes mitochondrial content mixing and organelle homeostasis/Source_data_1file.xlsx){target=\"_blank\"}\n\nkey words: \n\nPublished methods: ratio paired t-test\n\nDesign: Randomized Complete Block Design (RCBD)\n\nResponse: gel intensity\n\nKey learning concepts: asymmetric confidence intervals\n\nMore info: [Chapter 16 Models for non-independence -- linear mixed models](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/lmm){target=\"_blank\"}\n\n## The experiment\n\nThe researchers engineered mice to express human TAS1R2 receptor in the muscles of muscle-specific TAS1R2 knockout (mKO) mice. Aspartame is a TAS1R2 agonist in humans but not mice. Presumably Saline was injected in muscle on one side and Aspartame on the other side of the same mouse, so mouse is a block, hence the ratio paierd *t*-test.\n\nTreatments\n\n1. Veh -- Saline? injected into mTg mice muscle\n2. Asp -- Aspartame injected into mTg mice muscle\n\n## Setup\n\n\n\n\n\n\n\n## Fig 2g\n\nresearchers used: t-test on all data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"An interphase actin wave promotes mitochondrial content mixing and organelle homeostasis\"\nfile_name <- \"Source_data_1file.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig2g <- read_excel(file_path,\n                    sheet = \"Fig2G\",\n                    range = \"Q4:S27\",\n                    col_names = TRUE) |>\n  data.table() |>\n  melt(id.vars = c(\"experiment\"),\n              variable.name = \"treatment\",\n              value.name = \"wave_speed\") |>\n  na.omit()\nfig2g[, experiment := paste0(\"experiment_\", experiment)]\n\n# output as clean excel file\nfileout_name <- \"fig2g - RCBDS - An interphase actin wave promotes mitochondrial content mixing and organelle homeost\"\nfileout_path <- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig2g, fileout_path)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = fig2g,\n       aes(x = treatment,\n           y = wave_speed,\n           color = experiment)) +\n  geom_point(position = position_jitterdodge(jitter.width = 0))\n```\n\n::: {.cell-output-display}\n![](An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files/figure-html/fig2g-plot-each-experiment-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(wave_speed ~ treatment + (treatment | experiment), data = fig2g)\nvar_cor <- VarCorr(lmm1)\nvar_cor_dt <- var_cor |> as.data.frame() |> data.table()\nicc = var_cor_dt[1, vcov]/(var_cor_dt[1, vcov] + var_cor_dt[grp == \"Residual\", vcov])\nicc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2817159\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(wave_speed ~ treatment + (treatment | experiment), data = fig2g)\nlmm1_emm <- emmeans(lmm1, specs = \"treatment\")\nlmm1_pairs <- contrast(lmm1_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\nlmm1_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate   SE   df lower.CL upper.CL t.ratio p.value\n Wee1 - DMSO     2.05 1.17 2.99    -1.68     5.78   1.749  0.1789\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\nfig2g_agg <- fig2g[, .(wave_speed = mean(wave_speed)),\n                   by = .(treatment, experiment)]\nlmm2 <- lmer(wave_speed ~ treatment + (1 | experiment), data = fig2g_agg)\nlmm2_emm <- emmeans(lmm2, specs = \"treatment\")\nlmm2_pairs <- contrast(lmm2_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\nlmm2_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate    SE df lower.CL upper.CL t.ratio p.value\n Wee1 - DMSO     2.07 0.836  3   -0.592     4.73   2.475  0.0896\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfig2g_ss <- fig2g[experiment != \"5\"]\naov1 <- aov_4(wave_speed ~ treatment + (treatment | experiment), data = fig2g_ss, fun_aggregate = mean)\naov1_emm <- emmeans(aov1, specs = \"treatment\")\naov1_pairs <- contrast(aov1_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\naov1_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate   SE df lower.CL upper.CL t.ratio p.value\n Wee1 - DMSO     2.07 1.16  3    -1.62     5.76   1.787  0.1718\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot_response(lmm1, lmm1_emm, lmm1_pairs)\n```\n:::\n\n\n\n\n## Fig 2n\n\nresearchers used - don't give any statistics  but do show means of each experiment:treatment group, which suggests paired t.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"An interphase actin wave promotes mitochondrial content mixing and organelle homeostasis\"\nfile_name <- \"Source_data_1file.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig2n <- read_excel(file_path,\n                    sheet = \"Fig2N\",\n                    range = \"O2:Q42\",\n                    col_names = TRUE) |>\n  data.table() |>\n  melt(id.vars = c(\"experiment\"),\n              variable.name = \"treatment\",\n              value.name = \"fmnl1\") |>\n  na.omit()\nfig2n[, experiment := paste0(\"experiment_\", experiment)]\n\n# output as clean excel file\nfileout_name <- \"fig2n - RCBDS - An interphase actin wave promotes mitochondrial content mixing and organelle homeost\"\nfileout_path <- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig2n, fileout_path)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = fig2n,\n       aes(x = treatment,\n           y = fmnl1,\n           color = experiment)) +\n  geom_point(position = position_jitterdodge(jitter.width = 0))\n```\n\n::: {.cell-output-display}\n![](An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files/figure-html/fig2n-plot-each-experiment-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(fmnl1 ~ treatment + (treatment | experiment), data = fig2n)\nvar_cor <- VarCorr(lmm1)\nvar_cor_dt <- var_cor |> as.data.frame() |> data.table()\nicc = var_cor_dt[1, vcov]/(var_cor_dt[1, vcov] + var_cor_dt[grp == \"Residual\", vcov])\nicc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1879849\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(fmnl1 ~ treatment + (treatment | experiment), data = fig2n)\nlmm1_emm <- emmeans(lmm1, specs = \"treatment\")\nlmm1_pairs <- contrast(lmm1_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\nlmm1_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate   SE df lower.CL upper.CL t.ratio p.value\n Mut - WT     35.1 19.1  3    -25.6     95.9   1.839  0.1632\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\nfig2n_agg <- fig2n[, .(fmnl1 = mean(fmnl1)),\n                   by = .(treatment, experiment)]\nlmm2 <- lmer(fmnl1 ~ treatment + (1 | experiment), data = fig2n_agg)\nlmm2_emm <- emmeans(lmm2, specs = \"treatment\")\nlmm2_pairs <- contrast(lmm2_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\nlmm2_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate  SE df lower.CL upper.CL t.ratio p.value\n Mut - WT     35.1 6.5  3     14.4     55.8   5.404  0.0124\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfig2n_ss <- fig2n[experiment != \"5\"]\naov1 <- aov_4(fmnl1 ~ treatment + (treatment | experiment), data = fig2n_ss, fun_aggregate = mean)\naov1_emm <- emmeans(aov1, specs = \"treatment\")\naov1_pairs <- contrast(aov1_emm, method = \"revpairwise\", adjust = \"none\") |>\n  summary(infer = TRUE)\naov1_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast estimate  SE df lower.CL upper.CL t.ratio p.value\n Mut - WT     35.1 6.5  3     14.4     55.8   5.404  0.0124\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot_response(lmm1, lmm1_emm, lmm1_pairs)\n```\n:::\n\n\n\n# Fig 3e\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"An interphase actin wave promotes mitochondrial content mixing and organelle homeostasis\"\nfile_name <- \"Source_data_1file.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig3_import <- function(range, experiment){\n  fig3_part <- read_excel(file_path,\n                    sheet = \"Fig3E\",\n                    range = range,\n                    col_names = FALSE) |>\n  data.table()\n  colnames(fig3_part) <- c(\"sample\", \"ID\", \"area\", \"mean\", \"fluor\", \"bkgrnd\")\n  fig3_part[, treatment := ifelse(str_detect(ID, \"NToligo\"), \"Control\", \"FMNL1 si\")]\n  fig3_part[, treatment := factor(treatment, levels = c(\"Control\", \"FMNL1 si\"))]\n  fig3_part <- fig3_part[, .SD, .SDcols = c(\"treatment\", \"fluor\")]\n  fig3_part[, experiment := paste0(\"experiment_\", experiment)]\n  fig3_part[, fluor_nonneg := ifelse(fluor < 0, 0, fluor)]\n  return(fig3_part)\n}\nrange_list <- c(\"A9:F47\", \"A54:F93\", \"A100:F139\", \"A146:F185\")\nfig3e <- data.table(NULL)\nfor(experiment in 1:4){\n  fig3_exp <- fig3_import(range = range_list[experiment], experiment = experiment)\n  fig3e <- rbind(fig3e, fig3_exp)\n}\n\nfig3e[, log_fluor := ifelse(fluor > 0, log(fluor), NA)]\n\n# output as clean excel file\nfileout_name <- \"fig3e - RCBDS - An interphase actin wave promotes mitochondrial content mixing and organelle homeost\"\nfileout_path <- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig3e, fileout_path)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = fig3e,\n       aes(x = treatment,\n           y = fluor,\n           color = experiment)) +\n  geom_point(position = position_jitterdodge(jitter.width = 0))\n```\n\n::: {.cell-output-display}\n![](An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files/figure-html/fig3e-plot-each-experiment-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(fluor ~ treatment + (treatment | experiment), data = fig3e)\nvar_cor <- VarCorr(lmm1)\nvar_cor_dt <- var_cor |> as.data.frame() |> data.table()\nicc = var_cor_dt[1, vcov]/(var_cor_dt[1, vcov] + var_cor_dt[grp == \"Residual\", vcov])\nicc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2316418\n```\n\n\n:::\n:::\n\n\n\n### ratio paired t-test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfig3e_means <- fig3e[, .(mean_fluor = mean(fluor, na.rm = TRUE),\n                         mean_fluor_nn = mean(fluor_nonneg, na.rm = TRUE),\n                         mean_logfluor = mean(log_fluor, na.rm = TRUE)),\n                     by = .(treatment, experiment)]\nfig3e_means[, log_meanfluor := log(mean_fluor)]\nfig3e_means[, log_meanfluor_nn := log(mean_fluor_nn)]\n\n# test of log of means\na <- fig3e_means[treatment == \"Control\", log_meanfluor]\nb <- fig3e_means[treatment == \"FMNL1 si\", log_meanfluor]\nlog_ba <- log(b/a)\nt.test(log_ba, mu = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  log_ba\nt = 3.1939, df = 3, p-value = 0.04956\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.0002865932 0.1601810036\nsample estimates:\nmean of x \n0.0802338 \n```\n\n\n:::\n\n```{.r .cell-code}\n# test of log of means with no negative values\na <- fig3e_means[treatment == \"Control\", log_meanfluor_nn]\nb <- fig3e_means[treatment == \"FMNL1 si\", log_meanfluor_nn]\nlog_ba <- log(b/a)\nt.test(log_ba, mu = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  log_ba\nt = 3.1933, df = 3, p-value = 0.04959\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.0002728237 0.1602930075\nsample estimates:\n mean of x \n0.08028292 \n```\n\n\n:::\n\n```{.r .cell-code}\n# test of mean of logs\na <- fig3e_means[treatment == \"Control\", mean_logfluor]\nb <- fig3e_means[treatment == \"FMNL1 si\", mean_logfluor]\nlog_ba <- log(b/a)\nt.test(log_ba, mu = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  log_ba\nt = 2.8275, df = 3, p-value = 0.06633\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n -0.0111806  0.1892950\nsample estimates:\n mean of x \n0.08905719 \n```\n\n\n:::\n:::\n\n\n\n### A linear model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(mean_fluor ~ treatment, data = fig3e_means)\nggcheck_the_model(lm1)\n```\n\n::: {.cell-output-display}\n![](An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm1 <- lmer(fluor ~ treatment + (treatment | experiment), data = fig3e)\ncheck_lmm1 <- simulateResiduals(fittedModel = lmm1,\n                                       n = 250,\n                                       refit = FALSE)\nplot(check_lmm1)\n```\n\n::: {.cell-output-display}\n![](An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n### Effect of the single negative value\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlmm_a <- lmer(fluor ~ treatment + (treatment | experiment), data = fig3e)\ncoef(summary(lmm_a))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Estimate Std. Error       df  t value    Pr(>|t|)\n(Intercept)       49.95836   7.130305 3.000018 7.006484 0.005970303\ntreatmentFMNL1 si 21.47438   6.722226 3.008290 3.194534 0.049349060\n```\n\n\n:::\n\n```{.r .cell-code}\nlmm_b <- lmer(fluor_nonneg ~ treatment + (treatment | experiment), data = fig3e)\ncoef(summary(lmm_b))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Estimate Std. Error       df  t value    Pr(>|t|)\n(Intercept)       49.95836   7.130178 3.000119 7.006608 0.005969341\ntreatmentFMNL1 si 21.49085   6.727740 3.008078 3.194363 0.049360372\n```\n\n\n:::\n:::\n\n\n\n### models\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# paired t\nlmm0 <- lmer(mean_fluor ~ treatment + (1 | experiment), data = fig3e_means)\ncoef(summary(lmm0))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Estimate Std. Error       df  t value    Pr(>|t|)\n(Intercept)       49.95836   9.896203 3.767478 5.048236 0.008471291\ntreatmentFMNL1 si 21.49479   6.714987 3.000000 3.201017 0.049293492\n```\n\n\n:::\n\n```{.r .cell-code}\n# lmm\nlmm1 <- lmer(fluor ~ treatment + (treatment | experiment), data = fig3e)\ncoef(summary(lmm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Estimate Std. Error       df  t value    Pr(>|t|)\n(Intercept)       49.95836   7.130305 3.000018 7.006484 0.005970303\ntreatmentFMNL1 si 21.47438   6.722226 3.008290 3.194534 0.049349060\n```\n\n\n:::\n:::\n",
    "supporting": [
      "An-interphase-actin-wave-promotes-mitochondrial-content-mixing-and-organelle-homeostasis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}