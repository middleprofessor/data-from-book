{
  "hash": "55144af7497375b16ea5e6fa54e05d39",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Fig 2s -- Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\"\nauthor: \"Jeff Walker\"\ndate: '2 Jun 2024'\ndate-modified: \"2024-06-02\"\ncategories: [\"linear mixed model\", \"random intercept\", \"CRDS\", \"Nested ANOVA\", \"ggplot\"]\ndescription: \"Fig 2s is a Completely Randomized Design with subsampling (CRDS), with 28-49 technical replicates per mouse. The researchers used a Mann-Whitney test that ignored the technical replication. This analysis is massively pseudoreplicated because techanical replicates are not independent evidence of effect of treatment. Individual mouse ID was archived, which makes it easy to re-analyze with models that account for the non-independence. The p-value accounting for non-independence is 0.18 while the p-value using Mann-Whitney on all data is 0.0002. Whoops!\"\nformat: \n  html: \n    toc: true \n    toc-location: right\nexecute: \n  message: false\n  warning: false\neditor_options: \n  chunk_output_type: inline\nfreeze: auto\n\n---\n\n\n![Fig 2s from the article](../../figs/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/fig2s.png)\n\n## Vital info\n\nData From: [Osseni, Alexis, et al. \"Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.\" Nature Communications 13.1 (2022): 7108.](https://www.nature.com/articles/s41467-022-34831-3){target=\"_blank\"}\n\nFig: 2s [download data](../../data from/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/ncomms-source-data files OSSENI et al.xlsx){target=\"_blank\"}\n\nkey words: \n\nPublished methods: Mann-Whitney U on all data\n\nDesign: Completely Randomized Design with Subsampling (CRDS)\n\nResponse: fibrotic area\n\nKey learning concepts: linear mixed model, random intercept, nested ANOVA\n\nQuick learning explanation: Pseudoreplication is the analysis of subsampled (technical) replicates as if they were experimental replicates. This is a violation of the assumption of independence of errors. Nested data are measures within a discrete unit or a hierarchy of units, for example technical replicates within a tumor within a mouse.\n\nMore info: [Chapter 16 Models for non-independence -- linear mixed models](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/lmm){target=\"_blank\"}\n\n## The experiment\n\n\n\n\n## Setup\n\n\n\n\n\n## Import and Wrangle\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_from <- \"Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\"\nfile_name <- \"ncomms-source-data files OSSENI et al.xlsx\"\nfile_path <- here(data_folder, data_from, file_name)\n\nfig2s_wide <- read_excel(file_path,\n                    sheet = \"Figure 2\",\n                    range = \"E138:J186\",\n                    col_names = FALSE) |>\n  data.table()\nmouse_id <- paste(\"mouse\", 1:6, sep = \"_\")\ntreatment_levels <- c(\"MDX-Veh\", \"MDX-TubA\")\nmouse_treatment <- paste(rep(treatment_levels, each = 3), mouse_id)\ncolnames(fig2s_wide) <- mouse_treatment\nfig2s <- melt(fig2s_wide,\n              measure.vars = mouse_treatment,\n              variable.name = \"mouse_treatment\",\n              value.name = \"fibrotic_area\") |>\n  na.omit()\nfig2s[, c(\"treatment\", \"mouse_id\") := tstrsplit(mouse_treatment, \" \")]\nfig2s[, treatment := factor(treatment, levels = treatment_levels)]\n\nfile_out_name <- \"fig2s-CRDS-Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.xlsx\"\nfileout_path <- here(data_folder, data_from, file_out_name)\nwrite_xlsx(fig2s, fileout_path)\n```\n:::\n\n\n\n## Fit the models\n\nThe Mann-Whitney U test used by the authors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm0 <- wilcox.test(fig2s[treatment == treatment_levels[1], fibrotic_area], fig2s[treatment == treatment_levels[2], fibrotic_area])\nm0\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  fig2s[treatment == treatment_levels[1], fibrotic_area] and fig2s[treatment == treatment_levels[2], fibrotic_area]\nW = 8740, p-value = 0.000204\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\nA linear mixed-model is the best practice method\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lmer(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm1_emm <- emmeans(m1, specs = \"treatment\")\nm1_pairs <- contrast(m1_emm, method = \"revpairwise\") |>\n  summary(infer = TRUE)\nm1_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast               estimate     SE df lower.CL upper.CL t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0639 0.0393  4   -0.173   0.0452  -1.627  0.1792\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\nA nested ANOVA is a classical method that is equivalent to the linear mixed model above when there are an equal number of technical replicates per mouse, but will be close otherwise. In general, things will rarely go wrong if one uses a nested ANOVA instead of the linear mixed-model. GraphPad Prism does nested ANOVA but not a linear mixed model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- aov_4(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm2_emm <- emmeans(m2, specs = \"treatment\")\nm2_pairs <- contrast(m2_emm, method = \"revpairwise\") |>\n  summary(infer = TRUE)\nm2_pairs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast               estimate     SE df lower.CL upper.CL t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0647 0.0395  4   -0.174   0.0449  -1.639  0.1766\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n## Plotting technical replicates\n\nThe technical replicates are de-emphasized by using a gray color. The modeled means of each mouse are colored by treatment (these are the predicted means of the linear mixed model and not the simple mean of each mouse). The model means of each treatment are colord by treatment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get estimated means from linear model\nfig2s_means <- fig2s[, .(fibrotic_area = mean(fibrotic_area)), by = .(treatment, mouse_id)]\nfig2s_means[, fibrotic_area_model := predict(m1, fig2s_means)]\nm1_emm_dt <- m1_emm |>\n  summary() |>\n  data.table()\ngg <- ggplot(data = fig2s,\n             aes(x = treatment,\n                 y = fibrotic_area)) +\n  # technical reps\n  geom_jitter(color = \"gray\",\n              width = 0.2) +\n  geom_jitter(data = fig2s_means,\n              aes(x = treatment,\n                  y = fibrotic_area_model,\n                  color = treatment),\n              size = 3,\n              width = 0.1,\n              show.legend = FALSE) +\n  # mean and error\n  geom_point(data = m1_emm_dt,\n             aes(x = treatment,\n                 y = emmean,\n                 color = treatment),\n             size = 5,\n             show.legend = FALSE) +\n  geom_errorbar(data = m1_emm_dt,\n                aes(x = treatment, \n                    y = emmean,\n                    ymin = lower.CL, ymax = upper.CL,\n                    color = treatment),\n                width = 0.05,\n                show.legend = FALSE) +\n  ylab(\"Fibrotic Area\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\ngg\n```\n\n::: {.cell-output-display}\n![](Fig-2s-Pharmacological-inhibition-of-HDAC6-improves-muscle-phenotypes-in-dystrophin-deficient-mice-by-downregulating-TGF-β-via-Smad3-acetylationtled_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Fig-2s-Pharmacological-inhibition-of-HDAC6-improves-muscle-phenotypes-in-dystrophin-deficient-mice-by-downregulating-TGF-β-via-Smad3-acetylationtled_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}