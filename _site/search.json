[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Data From began in 2018 as the name of a project that I used to collect example data sets for my Applied Biostatics class at the University of Southern Maine and for the R Markdown book Statistics for the Experimental Biologist that I was creating for this class.\n\nJeffrey A. Walker\nDepartment of Biological Sciences\nUniversity of Southern Maine\nwalker at maine dot edu\n\n\nOther sites\nStatistics for the Experimental Biologist\nBike Geometry Project – Exploration and classification of gravel bike geometry"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "",
    "text": "Fig 4h"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#vital-info",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#vital-info",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Vital info",
    "text": "Vital info\nData From: Doan, Alexander E., et al. “FOXO1 is a master regulator of memory programming in CAR T cells.” Nature (2024): 1-8.\nFig: 4h download data (note the tab is incorrectly labeled Figure 4i”)\nkey words: pseudoreplication, technical replicates, nested, simulation, confidence interval\nPublished methods: Wilcoxan rank-sum test (non-parametric t-test alternative)\nDesign: 2 x 1 CRDS\nResponse: per-cell module score, which is a combined expression level for a specified gene set.\nKey learning concepts: Pseudoreplication. Nested design.\nMore info: Chapter 16 Models for non-independence – linear mixed models\nQuick learning explanation: Pseudoreplication is the analysis of subsampled (technical) replicates as if they were experimental replicates. This is a violation of the assumption of independence of errors. Nested data are measures within a discrete unit or a hierarchy of units, for example technical replicates within a tumor within a mouse.\nComments: The researchers measured gene set expression levels in thousands of cells from mice assigned to two treatments, with five mice in each treatment. Cells from all mice within a treatment were pooled. The t-test assumes independent errors of all expression level scores but the scores of the different cells within a mouse are not independent – these are technical replicates or subsampled replicates – so the scores will be clustered (a clinical research term) or batched (a bench biology term) where each mouse is the cluster or batch.\nSingle-cell experiments of this design are effectively not worth the time and money because small p-values are almost guaranteed even if there is no true difference in expression level. That is, we are extremely unlikely to reliably learn anything. More generally, this design will result in extremely small p-values for very small, and possibly biologically meaningless, effect sizes. When this happens, researchers are likely to pursue research paths with trivial consequences for mouse health.\nAlways Remember: A p-value is a measure of evidence against the null model and not a measure of the truth of an effect. In bench biology, a p-value is best used to aid decision making – with a small p-value we can act as if an effect exists and pursue further experiments. If there is a high cost to these further experiments, we want a really small p-value (say &lt; 0.01) to act. If there is little cost to these further experiments we can use a larger p-value (say, &lt; 0.1) to act."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#pseudoreplication-red-flag",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#pseudoreplication-red-flag",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Pseudoreplication red flag",
    "text": "Pseudoreplication red flag\nLook at the figure!\nThe typical number of experimental replicates in bench biology is 3-8 with occasional replications up to about 30. The mere presence of many 10s or 100s of points per treatment is a red flag for pseudoreplication."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#background",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#background",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Background",
    "text": "Background\nCAR T cells are engineered immune cells that attack tumor cells. A common problem with CAR T cell treatment is the tumor cell killing activity diminishes over time. The researchers are interested in modifying the CAR T cells to maintain killing activity. FOX01 is a transcription factor that regulates genes that control the memory properties of T cells."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-experiment",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-experiment",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "The experiment",
    "text": "The experiment\nTreatment levels 1. tNGFR (control). This is truncated NGFR 2. FOX01_OE (treatment). This is a modification that overexpresses FOX01.\nUsing mice with osteosarcoma, five mice were infused with tNGFR CAR T cells and five mice were infused with FOX01_OE CAR T cells. Tumors were collected and CAR T cells were isolated and pooled across the five mice within a treatment for single-cell RNA sequencing.\nThe response is a per-cell module score, which is a combined expression level for a specified gene set, in log10 units."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-statistical-issue",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-statistical-issue",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "The statistical issue",
    "text": "The statistical issue\nThe treatments were not randomized to cell but to mouse, so the scores within mouse are not independent of each other because the cells within a tumor within a mouse share tumor environmental factors that cells within a tumor in other mice do not share."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#setup",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#setup",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Setup",
    "text": "Setup\n\n\nCode\nknitr::opts_chunk$set(echo = TRUE)\n\n# wrangling packages\nlibrary(here) # here makes a project transportable\nlibrary(janitor) # clean_names\nlibrary(readxl) # read excel, duh!\nlibrary(writexl) # write excel, duh!\nlibrary(data.table) # magical data frames\nlibrary(magrittr) # pipes\nlibrary(stringr) # string functions\nlibrary(forcats) # factor functions\n\n# analysis packages\nlibrary(emmeans) # the workhorse for inference\nlibrary(nlme) # gls and some lmm\nlibrary(lme4) # linear mixed models\nlibrary(lmerTest) # linear mixed model inference\nlibrary(afex) # ANOVA linear models\nlibrary(glmmTMB) # generalized linear models\nlibrary(MASS) # negative binomial and some other functions\nlibrary(car) # model checking and ANOVA\nlibrary(DHARMa) # model checking\nlibrary(mvtnorm)\n\n# graphing packages\nlibrary(ggsci) # color palettes\nlibrary(ggpubr) # publication quality plots\nlibrary(ggforce) # better jitter\nlibrary(cowplot) # combine plots\nlibrary(knitr) # kable tables\nlibrary(kableExtra) # kable_styling tables\n\n# ggplot_the_model.R packages not loaded above\nlibrary(insight)\nlibrary(lazyWeave)\n\n# use here from the here package\nhere &lt;- here::here\n# use clean_names from the janitor package\nclean_names &lt;- janitor::clean_names\n# use transpose from data.table\ntranspose &lt;- data.table::transpose\n\n# load functions used by this text written by me\n# ggplot_the_model.R needs to be in the folder \"R\"\n# if you didn't download this and add to your R folder in your\n# project, then this line will cause an error\nsource_path &lt;- here(\"R\", \"ggplot_the_model.R\")\nsource(source_path)\n\ndata_folder &lt;- \"data from\"\nimage_folder &lt;- \"images\"\noutput_folder &lt;- \"output\""
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#import-wrangle-and-summarize",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#import-wrangle-and-summarize",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Import, wrangle, and summarize",
    "text": "Import, wrangle, and summarize\nImport and wrangle using data.table.\n\n\nCode\ndata_from &lt;- \"FOXO1 is a master regulator of memory programming in CAR T cells\"\nfile_name &lt;- \"41586_2024_7300_MOESM9_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig4h_wide &lt;- read_excel(file_path,\n                    sheet = \"Figure 4i\",\n                    range = \"A4:h7659\",\n                    col_names = TRUE) |&gt;\n  data.table()\nsetnames(fig4h_wide,\n         old = names(fig4h_wide),\n         new = c(\"tNGFR_teff\", \"FOXO1OE_teff\", \"x1\",\n                 \"tNGFR_trm\", \"FOXO1OE_trm\", \"x2\",\n                 \"tNGFR_bulk\", \"FOXO1OE_bulk\"))\nfig4h_wide &lt;- fig4h_wide[, .SD, .SDcols = c(\"tNGFR_teff\", \"FOXO1OE_teff\",\n                                            \"tNGFR_trm\", \"FOXO1OE_trm\",\n                                            \"tNGFR_bulk\", \"FOXO1OE_bulk\")]\nfig4h &lt;- melt(fig4h_wide,\n             measure.vars = list(c(\"tNGFR_teff\", \"FOXO1OE_teff\"),\n                                 c(\"tNGFR_trm\", \"FOXO1OE_trm\"),\n                                 c(\"tNGFR_bulk\", \"FOXO1OE_bulk\")),\n             variable.name = \"treatment_code\",\n             value.name = c(\"teff\", \"trm\", \"bulk\"))\nfig4h[, treatment := ifelse(treatment_code == 1, \"tNGFR\", \"FOXO1OE\") |&gt;\n       factor(levels = c(\"tNGFR\", \"FOXO1OE\"))]\n\n\nSummarize data\n\n\nCode\nfig4h_long &lt;- melt(fig4h,\n                  id.vars = \"treatment\",\n                  measure.vars = c(\"teff\", \"trm\", \"bulk\"),\n                  variable.name = \"response\",\n                  value.name = \"score\")\nfig4h_summary &lt;- fig4h_long[!is.na(score), .(N = .N,\n                                mean = mean(score, na.rm = TRUE),\n                              sd = sd(score, na.rm = TRUE)),\n                          by = .(treatment, response)]\nfig4h_summary |&gt;\n  kable(caption = \"Summary data of three response measures\",\n        digits = c(1,1,0,3,3)) |&gt;\n  kable_styling()\n\n\n\n\nSummary data of three response measures\n\n\ntreatment\nresponse\nN\nmean\nsd\n\n\n\n\ntNGFR\nteff\n7346\n0.280\n0.332\n\n\nFOXO1OE\nteff\n7655\n0.499\n0.327\n\n\ntNGFR\ntrm\n7346\n0.031\n0.202\n\n\nFOXO1OE\ntrm\n7655\n0.105\n0.193\n\n\ntNGFR\nbulk\n7346\n0.379\n0.116\n\n\nFOXO1OE\nbulk\n7655\n0.448\n0.104"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#statistical-analysis-to-get-effect-sizes-but-no-inference",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#statistical-analysis-to-get-effect-sizes-but-no-inference",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Statistical analysis to get effect sizes (but no inference)",
    "text": "Statistical analysis to get effect sizes (but no inference)\nHere I fit a naïve linear model (t-test equivalent) ignoring nesting to get the effect size (fold change) and relative effects size (Cohen’s D).\n\n\nCode\nm1_teff &lt;- lm(teff ~ treatment, data = fig4h)\n#coef(summary(m1_teff))\nstats_table &lt;- data.table(\n  Response = \"TEFF\",\n  Difference = coef(summary(m1_teff))[2, 1],\n  \"Fold Change\" = 10^coef(summary(m1_teff))[2, 1],\n  Cohen = coef(summary(m1_teff))[2, 1]/summary(m1_teff)$sigma\n)\n\nm1_trm &lt;- lm(trm ~ treatment, data = fig4h)\nstats_table &lt;- rbind(stats_table,\n                     data.table(\n                       Response = \"TRM\",\n                       Difference = coef(summary(m1_trm))[2, 1],\n                       \"Fold Change\" = 10^coef(summary(m1_trm))[2, 1],\n                       Cohen = coef(summary(m1_trm))[2, 1]/summary(m1_trm)$sigma\n                     )\n)\n\nm1_bulk &lt;- lm(bulk ~ treatment, data = fig4h)\nstats_table &lt;- rbind(stats_table,\n                     data.table(\n                       Response = \"Bulk\",\n                       Difference = coef(summary(m1_bulk))[2, 1],\n                       \"Fold Change\" = 10^coef(summary(m1_bulk))[2, 1],\n                       Cohen = coef(summary(m1_bulk))[2, 1]/summary(m1_bulk)$sigma\n                     )\n)\nstats_table |&gt;\n  kable(digits = c(1,3,2,2)) |&gt;\n  kable_styling()\n\n\n\n\n\n\nResponse\nDifference\nFold Change\nCohen\n\n\n\n\nTEFF\n0.219\n1.65\n0.66\n\n\nTRM\n0.075\n1.19\n0.38\n\n\nBulk\n0.069\n1.17\n0.63\n\n\n\n\n\n\n\n\nThese fold-changes seem smallish, at least relative to fold changes for single genes (and not gene sets) that I typically see while scanning the bench biology literature. That said, what is important is not the fold change relative to other genes or gene sets but the biological consequences of the observed fold changes, a a kind of question that I’d love to see addressed more in the bench biology literature."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#what-wed-like-to-do-but-cannot",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#what-wed-like-to-do-but-cannot",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "What we’d like to do but cannot",
    "text": "What we’d like to do but cannot\nIf the cells for each mouse within a treatment hadn’t been pooled OR if we had the mouse ID for each cell, then we would simply average the scores over all cells within a mouse and use a t-test using the five values for tNGFR and five values for FOX01_OE."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#a-conservative-attempt-at-inference-using-resampling",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#a-conservative-attempt-at-inference-using-resampling",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "A conservative attempt at inference using resampling",
    "text": "A conservative attempt at inference using resampling\nThe experiment has five independent values per treatment. Assuming there is no variation in the response between mice (that is, all variation is among cells within a mouse), we can get a statistically-valid p-value by randomly sampling five values of each treatment and doing a t-test. This p-value will be very unstable due to the large variation within a treatment level relative to the difference between treatments, so a better method is to use the within-treamtent values as the sampling distribution.\nThe algorithm:\n\nSample five values of each treatment, with replacement\nDo a t-test\nSave the ttest statistic\nSave the effect (the difference in treatment means)\nRepeat 1-4 2000 times\n\nThe 95% confidence limits of the difference in means is computed as the 2.5 and 97.5 percentiles of the set of effects\nThe p-value is computed as the number of t-values less than zero (this is a one-sided test).\n\n\nCode\nset.seed(1)\nn_reps &lt;- 2000\nd_out &lt;- matrix(as.numeric(NA), nrow = n_reps, ncol = 3)\nt_out &lt;- matrix(as.numeric(NA), nrow = n_reps, ncol = 3)\ncolnames(d_out) &lt;- c(\"TEFF\", \"TRM\", \"Bulk\")\ncolnames(t_out) &lt;- c(\"TEFF\", \"TRM\", \"Bulk\")\n\ntngfr_teff &lt;- fig4h[treatment == \"tNGFR\", teff] |&gt;\n  na.omit()\nfox_teff &lt;- fig4h[treatment == \"FOXO1OE\", teff] |&gt;\n  na.omit()\ntngfr_trm &lt;- fig4h[treatment == \"tNGFR\", trm] |&gt;\n  na.omit()\nfox_trm &lt;- fig4h[treatment == \"FOXO1OE\", trm] |&gt;\n  na.omit()\ntngfr_bulk &lt;- fig4h[treatment == \"tNGFR\", bulk] |&gt;\n  na.omit()\nfox_bulk &lt;- fig4h[treatment == \"FOXO1OE\", bulk] |&gt;\n  na.omit()\n\nfor(i in 1:n_reps){\n  t_teff &lt;- t.test(sample(tngfr_teff, 5, replace = TRUE),\n                      sample(fox_teff, 5, replace = TRUE),\n                      equal.var = TRUE)\n  t_trm &lt;- t.test(sample(tngfr_trm, 5, replace = TRUE),\n                      sample(fox_trm, 5, replace = TRUE),\n                      equal.var = TRUE)\n  t_bulk &lt;- t.test(sample(tngfr_bulk, 5, replace = TRUE),\n                      sample(fox_bulk, 5, replace = TRUE),\n                      equal.var = TRUE)\n  d_out[i, \"TEFF\"] &lt;- t_teff$estimate |&gt; diff()\n  d_out[i, \"TRM\"] &lt;- t_trm$estimate |&gt; diff()\n  d_out[i, \"Bulk\"] &lt;- t_bulk$estimate |&gt; diff()\n\n  t_out[i, \"TEFF\"] &lt;- -t_teff$statistic\n  t_out[i, \"TRM\"] &lt;- -t_trm$statistic\n  t_out[i, \"Bulk\"] &lt;- -t_bulk$statistic\n\n}\n\nci &lt;- function(x){\n  return(quantile(x, c(0.025, 0.975)))\n}\n\nci_df &lt;- apply(d_out, 2, ci)\nci_table &lt;- data.table(\n  Response = colnames(ci_df),\n  t(ci_df)\n)\nci_table |&gt;\n  kable(caption = \"95% CIs of each response\",\n        digits = c(2, 2, 2)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n95% CIs of each response\n\n\nResponse\n2.5%\n97.5%\n\n\n\n\nTEFF\n-0.20\n0.64\n\n\nTRM\n-0.17\n0.31\n\n\nBulk\n-0.07\n0.20\n\n\n\n\n\n\n\n\nCode\nlt0 &lt;- function(x){\n  return(sum(x &lt; 0))\n}\n\np &lt;- apply(t_out, 2, lt0)/n_reps\np_table &lt;- data.table(\n  Response = names(p),\n  p = p)\np_table |&gt;\n  kable(caption = \"Resampled p-values of each response\",\n        digits = 2) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\nResampled p-values of each response\n\n\nResponse\np\n\n\n\n\nTEFF\n0.14\n\n\nTRM\n0.27\n\n\nBulk\n0.14\n\n\n\n\n\n\n\n\nA Confidence Interval is the set of bounds of the range of values that is consistent with the data and is useful to model the biological consequences of the low end vs. the high end.\nThe simplest use of a CI is to to simply use it as a binary p-value – if the CI includes zero, the p-value is not significant at the level of the CI (here, this is 5%). So, using the CI, we can infer that the p-value for each of the responses is not significant if we use 5% as our level. The directly measured p-values for all three responses are also not significant at this level and suggest we act as if there is no effect."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#better-p-valueskinda",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#better-p-valueskinda",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Better p-values…kinda",
    "text": "Better p-values…kinda\nThe resampling tests above are conservative because they use the total variance to estimate the t-value. What we really want is the variance among the mice, since this is the level that the treatment was applied, and this variance will be smaller than the total variance, so the denominator of the t-value will be smaller, the t-value will be bigger, and the p-value smaller! And we have a huge sample size to estimate this variance precisely.\nThe problem is, we don’t know the variance among the mice because the cells from mice within a treatment were pooled. So let’s model this and computed expected p-values across a range of among-mice variance. The amount of among-mice variance relative to the total variance (among-mice + among-cell) is the intraclass correlation coefficient (ICC), which ranges between zero and one. The further the ICC is from zero, the more correlated (dependent) the errors and the wrong the inference using a naïve test like that of the researchers.\nAlgorithm:\n\nStart with the lowest ICC in a pre-specified list of ICCs that range between 0 and 1\nUse the observed total variance and the ICC to compute the among-mouse (\\(\\sigma^2_\\alpha\\)) and among-cell (\\(\\sigma^2_\\varepsilon\\)) variances\nUse the among-mouse variance and the observed difference between treatment means to create fake mouse means with five mice per treatment and an expected difference between treatment means equal to the observed difference.\nUse the among-cell variance to create 1500 values per mouse (the average number of cells per mouse in the actual experiment) – these values are random “error” around each mouse mean.\nCompute the mean value for each mouse\nDo a t-test\nSave the t-value\nSave the p-value\nRepeat 2-8 2000 times\nCompute the Power of the modified experimental design at the specified ICC using the 2000 p-values\nCompute the expected p-value for this ICC by\n\n\nCompute the mean of the 2000 t-values\nCompute the p-value from the averaged t-value\n\n\nChange the ICC to the next higher ICC in the list and repeat 2-11.\n\n\n\nCode\nt_to_p &lt;- function(t){\n  p &lt;- 2 * pt(-abs(t), df = n * 2 - 2, lower.tail = TRUE)\n  return(p)\n}\n\nset.seed(1)\nn_reps &lt;- 2000\nn &lt;- 5\nn_ss &lt;- 1500\nsigma_total &lt;- summary(m1_teff)$sigma # estimated SD for TEFF\ndelta &lt;- .219 # observed difference for TEFF\nicc_vec &lt;- c(0.001, 0.005, 0.01, 0.02, 0.05, 0.1, 0.2, 0.3, 0.5, 0.75)\nt &lt;- numeric(n_reps)\ntable_out &lt;- data.table(NULL)\n#sigma_a^2: the variance among mice\n#sigma_e^2: the error variance (within mice)\nfor(sim_i in 1:length(icc_vec)){\n  icc &lt;- icc_vec[sim_i]\n  # icc = sigma_a^2/sigma_total^2\n  sigma_a &lt;- sqrt(icc * sigma_total^2)\n  # sigma_total^2 = sigma_a^2 + sigma_e^2\n  sigma_e &lt;- sqrt(sigma_total^2 - sigma_a^2)\n  for(rep_i in 1:n_reps){\n    tngfr_means &lt;- rnorm(n, sd = sigma_a) \n    fox_means &lt;- rnorm(n, sd = sigma_a) + delta \n    # slow\n    tngfr &lt;- rnorm(n * n_ss, mean = rep(tngfr_means, each = n_ss), sd = sigma_e) |&gt;\n      matrix(nrow = n_ss, ncol = n) |&gt;\n      apply(2, mean)\n    fox &lt;- rnorm(n * n_ss, mean = rep(fox_means, each = n_ss), sd = sigma_e) |&gt;\n      matrix(nrow = n_ss, ncol = n) |&gt;\n      apply(2, mean)\n    # fast shortcut since the estimated mean will be so close to true mean\n    # tngfr &lt;- tngfr_means\n    # fox &lt;- fox_means\n\n    t[rep_i] &lt;- t.test(tngfr, fox, var.equal = TRUE)$statistic\n  }\n  p &lt;- t_to_p(t)\n  table_out &lt;- rbind(\n    table_out,\n    data.table(\n      icc = icc,\n      t = mean(t),\n      power = sum(p &lt; 0.05)/n_reps\n    )\n  )\n  \n}\n\n\ntable_out[, p := 2 * pt(t, df = n * 2 - 2, lower.tail = TRUE)]\n\ngg1 &lt;- ggplot(data = table_out,\n              aes(x = icc,\n                  y = p)) +\n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dashed\") +\n  theme_pubr()\ngg2 &lt;- ggplot(data = table_out,\n              aes(x = icc,\n                  y = power)) +\n  geom_line() +\n  geom_hline(yintercept = 0.8, linetype = \"dashed\") +\n  theme_pubr()\nplot_grid(gg1, gg2, ncol = 2, labels = \"AUTO\")\n\n\n\n\n\n\n\n\n\nPanel A shows the expected, statistically valid p-value for the experimental design over a range of among-mouse variation relative to the total variation (the ICC). The modeling suggests that, given the observed difference, a modified experiment with known mouse ID for each cell would rarely observe small p-values unless the ICC were pretty small (less than about 0.25).\nPanel B shows the power of a modified experimental design with known mouse ID given different amounts of among-mouse variation relative to the total variation (the ICC) and using 5% as the significance level. Remember, Power is the probability of observing a p-value less than the set significance level. Typically, researchers want a power of 0.8 or higher to justify the time, cost and animal welfare of an experiment. The modeling suggests that a modified experimental design, with known mouse ID for each cell, and given the observed difference, would require a pretty small ICC (less than 0.15) in order to have good power.\nUnfortunately, we don’t know the actual ICC and it’s hard for me to make a reasonable guess, given my lack of familiarity with these kinds of data.\nAnd remember, the observed difference in expression levels seems kinda small."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#why-the-actual-experimental-design-isnt-worth-the-time-money-or-cost-to-animal-welfare",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#why-the-actual-experimental-design-isnt-worth-the-time-money-or-cost-to-animal-welfare",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Why the actual experimental design isn’t worth the time, money, or cost to animal welfare",
    "text": "Why the actual experimental design isn’t worth the time, money, or cost to animal welfare\nGiven the actual (not modified to know mouse ID) experimental design, what is the rate of false positives (Type I error) - that is, the rate of significant p-values if there really were no effect of treatment? Like the power above, this depends on the relative amounts of among-mice and among-cell variance.\nAlgorithm:\n\nStart with the lowest ICC in a pre-specified list of ICCs that range between 0 and 1\nUse the observed total variance and the ICC to compute the among-mouse (\\(\\sigma^2_\\alpha\\)) and among-cell (\\(\\sigma^2_\\varepsilon\\)) variances\nUse the among-mouse variance to create fake mouse means with five mice per treatment and an expected difference between treatment means equal to zero.\nUse the among-cell variance to create 1500 values per mouse (the average number of cells per mouse in the actual experiment) – these values are random “error” around each mouse mean.\nCompute the mean value for each mouse\nDo a t-test\nSave the p-value\nRepeat 2-7 2000 times\nCompute the Type I error rate of the experimental design at the specified ICC using the 2000 p-values\nChange the ICC to the next higher ICC in the list and repeat 2-9.\n\n\n\nCode\nset.seed(1)\nn_reps &lt;- 2000\nn &lt;- 5\nn_ss &lt;- 1500\nsigma_total &lt;- summary(m1_teff)$sigma\nicc_vec &lt;- c(0, 0.001, 0.005, 0.01, 0.02, 0.05, 0.1, 0.2, 0.3, 0.5, 0.75)\np &lt;- numeric(n_reps)\ntable_out &lt;- data.table(NULL)\n#sigma_a^2: the variance among mice\n#sigma_e^2: the error variance (within mice)\nfor(sim_i in 1:length(icc_vec)){\n  icc &lt;- icc_vec[sim_i]\n  # icc = sigma_a^2/sigma_total^2\n  sigma_a &lt;- sqrt(icc * sigma_total^2)\n  # sigma_total^2 = sigma_a^2 + sigma_e^2\n  sigma_e &lt;- sqrt(sigma_total^2 - sigma_a^2)\n  for(rep_i in 1:n_reps){\n    mean_vec &lt;- rep(rnorm(n, sd = sigma_a), each = n_ss)\n    samp_1 &lt;- rnorm(n * n_ss, mean = mean_vec, sd = sigma_e)\n    mean_vec &lt;- rep(rnorm(n, sd = sigma_a), each = n_ss)\n    samp_2 &lt;- rnorm(n * n_ss, mean = mean_vec, sd = sigma_e)\n    p[rep_i] &lt;- t.test(samp_1, samp_2, var.equal = TRUE)$p.value\n  }\n  table_out &lt;- rbind(\n    table_out,\n    data.table(\n      icc = icc,\n      Type_I = sum(p &lt; 0.05)/n_reps\n    )\n  )\n  \n}\n\nggplot(data = table_out,\n       aes(x = icc,\n           y = Type_I)) +\n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dashed\") +\n  theme_pubr()\n\n\n\n\n\n\n\n\n\nThe plot shows that at effectively any ICC not super close to zero, the Type I error rates are elevated and this elevation is extreme at even very small ICC – at an ICC of 0.005, this rate is 51%! At any biologically realistic ICC, the experimental design will result in significant p-values the majority of the time when the true treatment effect is zero!"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#published-methods-cut-and-pasted-from-the-article",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#published-methods-cut-and-pasted-from-the-article",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Published Methods, cut and pasted from the article",
    "text": "Published Methods, cut and pasted from the article\nTo determine whether FOXO1 was also capable of increasing the activ- ity of CAR T cells against solid tumours, we infused tNGFR or FOXO1OE HER2.BBζ CAR T cells into 143B osteosarcoma-bearing NSG mice.\nTo generate single-cell RNA-seq libraries of tumour-infiltrating CAR T cells, Her2+ tumours were collected from five mice per condition, and human CD45+ cells were isolated by NGFR selection as described above (see ‘Cell selection’). Tumour-infiltrating CAR T cells were further purified by sorting human CD3+ TILs from each isolate using a Cytek Aurora Cell Sorter. A total of 20,000 CAR TILs were sorted from each tumour and pooled across five mice per group. Cells were barcoded and sequencing libraries were generated using the 10X Chromium Next GEM Single Cell 3’ v.3.1 kit (10X Genomics) according to the manufacturer’s instructions. Libraries were sequenced at the CHOP High Throughput Sequencing Core on an Illumina NovaSeq 6000 with an average read depth of 50,000 reads per cell.\nGene set scores for Teff, TRM and Treg cell subtypes were calculated with AddModuleScore (Seurat), using curated gene lists from a previous study58 (Extended Data Fig. 9g–i). AddModuleScore was also used to calculate a per-cell FOXO1 transcriptional activity score, using the top 100 upregulated genes in CD8+ HA.28ζ CAR T cells overexpressing FOXO1 versus tNGFR (Fig. 2)."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "",
    "text": "Fig 3g from the article"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#vital-info",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#vital-info",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Vital info",
    "text": "Vital info\nData From: Wang, Yu, et al. “The role of somatosensory innervation of adipose tissues.” Nature 609.7927 (2022): 569-574.\nFig: 3g download data\nkey words:\nPublished methods: repeated measures ANOVA\nDesign: Randomized Split Plot Design (RSPD)\nResponse: fold-change in gene expression\nKey learning concepts: linear mixed model, random intercept, split-plot, repeated measures ANOVA\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#the-experiment",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#the-experiment",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "The experiment",
    "text": "The experiment\nTreatments\nFactor 1: tx\n\nSaline (control). In the Excel file, this is labeled “SAL”. This should result in intact sympathetic activity.\n6-OHDA (treatment). In the Excel file, this is labeled “OHDA”. This is 6-hydroxydopamine, a sympathetic neurotoxin that inhibits sympathatic activity.\n\nFactor 2: surgery\n\nCre- (control). In the Excel file, this is labeled “YFP”. This is a control for the Cre injection. This should result in an intact sensory system of fat.\nCre+ (treatment). In the Excel file, this is labeled “Cre”. This should result in an ablated sensory system of fat.\n\nBlocking or whole plot factor: ear_tag. This is the mouse ID.\nFor the tx treatment, either saline or 6-OHDA was delivered to both sides of a mouse. For the surgery treatment, one side was injected with Cre- and one with Cre+.\nThere are six response variables, each a log2 fold-change for the thermogenic and lipogenic genes:\n\nUcp1\nElovl3\nCidea\nFasn\nAcacb\nChREBPβ\n\ncomments:\n\nSplit plot design. Cre ablation of one limb under two different conditions. Each condition is a different mouse. Researchers used RMANOVA.\nuse base 2 for fold change! Yaaaay!\nAll statistical results in Excel file! Yaaaay! This should be mandatory."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#what-is-a-randomized-split-plot-design-rspd",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#what-is-a-randomized-split-plot-design-rspd",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "What is a randomized split plot design (RSPD)?",
    "text": "What is a randomized split plot design (RSPD)?\nThis is a randomized split plot design. tx (Sal or OHDA) is randomly assigned to Mouse - a mouse is the “plot”. Within a mouse, surgery (YFP or Cre) is assigned to side – this is the “subplot”. Mouse acts like a blocking factor for surgery but a completely randomized factor for tx. There is no subplot replication within a plot (mouse) so the linear mixed model (using R formula notation) is\nfc ~ tx * surgery + (1 | ear_tag)\nThe factor ear_tag is a random intercept.\nA question I had with this is, can I replicate the researcher’s results, as they used “Repeated Measures ANOVA” in GraphPad Prism. In general, I can replicate GraphPad results with a blocked design but I haven’t tried a split plot design (generally because I don’t think that I’ve found a paper with a split plot design that was analyzed in GraphPad using RM ANOVA)\nAdvantages of the linear mixed model\n\nit can handle missing data – ANOVA throws out data points if there is any value missing value within the Plot variable (here, this is mouse ear_tag)\nit is easy to handle non-normal data using generalized linear mixed models – ANOVA is for linear models only, although one can transform the response.\nit is flexible, for example it is easy to add covariates. This isn’t so important for the bench biology data that I mostly see, although it is useful for example if a response was dependent on mouse weight and we wanted to adjust for weight without using a ratio.\n\nAdvantages of the RM ANOVA model 1. It always works! LMM algorithms can fail, and not infrequently."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#setup",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#setup",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#import-and-wrangle",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#import-and-wrangle",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\nNote: there are two sets of Fig 3g data. The bottom set looks like it is the top set recentered so that the mean of the SAL-YFP treatment has is mean zero. Since the data in the figure looked centered this way, I’ll import the bottom set.\n\n\nCode\ndata_from &lt;- \"The role of somatosensory innervation of adipose tissues\"\nfile_name &lt;- \"41586_2022_5137_MOESM7_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig3g &lt;- read_excel(file_path,\n                    sheet = \"3g\",\n                    range = \"B34:K58\",\n                    col_names = TRUE) |&gt;\n  data.table() |&gt;\n  clean_names()\nfig3g[, surgery := factor(surgery, levels = c(\"YFP\", \"Cre\"))]\nfig3g[, tx := factor(tx, levels = c(\"SAL\", \"OHDA\"))]"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#fit-the-models",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#fit-the-models",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Fit the models",
    "text": "Fit the models\nCreate a function to fit the same models to each of the six responses. This is better practice than cut and paste because its less like to leave bugs if edits are made to code. Two models are fit: lmm1 – a linear mixed model with a random intercept, aov1 – a repeated measures ANOVA model\n\n\nCode\nlmm1_fit &lt;- function(y_label){\n  # y_label is the column name of the response variable\n  r_formula &lt;- paste(y_label, \"~ tx * surgery + (1 | ear_tag)\") |&gt;\n    formula()\n  lmm1 &lt;- lmer(r_formula, data = fig3g)\n  return(lmm1)\n}\n\naov1_fit &lt;- function(y_label){\n  # y_label is the column name of the response variable\n  r_formula &lt;- paste(y_label, \"~ tx * surgery + (surgery | ear_tag)\") |&gt;\n    formula()\n  aov1 &lt;- aov_4(r_formula, data = fig3g)\n  return(aov1)\n}\n\nfig3g_lmm1 &lt;- list()\nfig3g_aov1 &lt;- list()\ny_list &lt;- c(\"ucp1\", \"elovl3\", \"cidea\", \"fasn\", \"acacb\", \"ch_reb_pb\")\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1[[y_label]] &lt;- lmm1_fit(y_label)\n  fig3g_aov1[[y_label]] &lt;- aov1_fit(y_label)\n}\n\n# get emmeans using function\n\nemmeans_out &lt;- function(m1){\n  # m1 is the fit model\n  m1_emm &lt;- emmeans(m1,\n                    specs = c(\"tx\", \"surgery\"))\n  return(m1_emm)\n}\n\nfig3g_lmm1_emm &lt;- list()\nfig3g_aov1_emm &lt;- list()\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1_emm[[y_label]] &lt;- emmeans_out(fig3g_lmm1[[y_label]])\n  fig3g_aov1_emm[[y_label]] &lt;- emmeans_out(fig3g_aov1[[y_label]])\n}\n\npairs_out &lt;- function(m1_emm){\n  # m1 is the fit model\n  m1_pairs &lt;- contrast(m1_emm,\n                       method = \"revpairwise\",\n                       simple = \"each\",\n                       combine = TRUE,\n                       adjust = \"none\") |&gt;\n  summary(infer = TRUE) |&gt;\n  data.table()\n  return(m1_pairs)\n}\n\nfig3g_lmm1_pairs &lt;- list()\nfig3g_aov1_pairs &lt;- list()\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1_pairs[[y_label]] &lt;- pairs_out(fig3g_lmm1_emm[[y_label]])\n  fig3g_aov1_pairs[[y_label]] &lt;- pairs_out(fig3g_aov1_emm[[y_label]])\n}"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#compare-lmm-to-rm-anova-and-to-graphpad-output",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#compare-lmm-to-rm-anova-and-to-graphpad-output",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Compare LMM to RM ANOVA and to GraphPad output",
    "text": "Compare LMM to RM ANOVA and to GraphPad output\n\nANOVA replicates!\ntested using ucp1 only\n\n\nCode\nanova(fig3g_lmm1[[\"ucp1\"]]) |&gt;\n  kable(digits = 4,\n        caption = \"LMM fit\") |&gt;\n  kable_styling()\n\n\n\n\nLMM fit\n\n\n\nSum Sq\nMean Sq\nNumDF\nDenDF\nF value\nPr(&gt;F)\n\n\n\n\ntx\n24.8575\n24.8575\n1\n10\n8.3181\n0.0163\n\n\nsurgery\n31.4641\n31.4641\n1\n10\n10.5288\n0.0088\n\n\ntx:surgery\n5.2770\n5.2770\n1\n10\n1.7658\n0.2134\n\n\n\n\n\n\n\n\nCode\nanova(fig3g_aov1[[\"ucp1\"]]) |&gt;\n  kable(digits = 4, caption = \"RM ANOVA fit\") |&gt;\n  kable_styling()\n\n\n\n\nRM ANOVA fit\n\n\n\nnum Df\nden Df\nMSE\nF\nges\nPr(&gt;F)\n\n\n\n\ntx\n1\n10\n6.2148\n8.3181\n0.3597\n0.0163\n\n\nsurgery\n1\n10\n2.9884\n10.5288\n0.2548\n0.0088\n\n\ntx:surgery\n1\n10\n2.9884\n1.7658\n0.0542\n0.2134\n\n\n\n\n\n\n\n\n\n\n\nFig 3g ANOVA table from Excel file\n\n\nlmm1 and aov1 give the same results here because there is no missing data, which the lmm is better at handling. Both replicate the GraphPad Prism results.\n\n\nContrasts replicate!\n\n\nCode\n# create a column of sidak adjusted p-values in the contrast tables\nfor(i in 1:length(y_list)){ # over the 6 responses\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  m1_pairs[3:4, p_sidak := Sidak.p.adjust(p.value)]\n  fig3g_lmm1_pairs[[y_list[i]]] &lt;- m1_pairs\n}\n\n# make a pretty output table\ncontrast_table &lt;- data.table(NULL)\nkeep_cols &lt;- c(\"tx\", \"contrast\", \"estimate\", \"p_sidak\")\nfor(i in 1:length(y_list)){ # over the 6 responses\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  contrast_table &lt;- rbind(contrast_table,\n                          m1_pairs[3:4, .SD, .SDcols = keep_cols])\n}\n\ncontrast_table |&gt;\n  kable(digits = 4) |&gt;\n  kable_styling() |&gt;\n  pack_rows(y_list[1], 1, 2) |&gt;\n  pack_rows(y_list[2], 3, 4) |&gt;\n  pack_rows(y_list[3], 5, 6) |&gt;\n  pack_rows(y_list[4], 7, 8) |&gt;\n  pack_rows(y_list[5], 9, 10) |&gt;\n  pack_rows(y_list[6], 11, 12)\n\n\n\n\n\n\ntx\ncontrast\nestimate\np_sidak\n\n\n\n\nucp1\n\n\nSAL\nCre - YFP\n-3.2278\n0.0178\n\n\nOHDA\nCre - YFP\n-1.3522\n0.3684\n\n\nelovl3\n\n\nSAL\nCre - YFP\n-3.5792\n0.0083\n\n\nOHDA\nCre - YFP\n-1.5600\n0.2574\n\n\ncidea\n\n\nSAL\nCre - YFP\n-2.2268\n0.0119\n\n\nOHDA\nCre - YFP\n-0.8875\n0.3538\n\n\nfasn\n\n\nSAL\nCre - YFP\n-1.8012\n0.0060\n\n\nOHDA\nCre - YFP\n-0.6543\n0.3409\n\n\nacacb\n\n\nSAL\nCre - YFP\n-1.8589\n0.0147\n\n\nOHDA\nCre - YFP\n-0.4956\n0.6315\n\n\nch_reb_pb\n\n\nSAL\nCre - YFP\n-2.7360\n0.0069\n\n\nOHDA\nCre - YFP\n-1.3383\n0.1767\n\n\n\n\n\n\n\n\n\n\n\nFig 3g contrasts from the Excel file\n\n\nNotes\n\nthe direction of my contrast is Cre+ - Cre- (or, using the Excel file labels, this is Cre - YFP), since I like the direction to be what happens when you add the treatment, relative to a control.\nThe authors used a Sidak adjustment on the two simple Cre- - Cre+ contrasts only.\n\nThe contrasts replicate (other than the sign, but that is because I chose the opposite direction of the contrast)!\nI do have thoughts on the correction:\n\nThe researchers do not state why the set of adjusted p-values is 2 (the two simple effects of surgery) and not 4 (the additional two simple effects tx).\nThe holm method of adjustment is more powerful than Sidak.\nI would not adjust if I were only investigating ucp1 as the response. Each of these is a test of its own question with different expectations given working knowledge. See xxx.\nThat said, there are 6 response variables from the experiment and if our hypothesis is something like “is there some difference in gene expression given this set of genes?” then I would adjust using the FDR, as this is a question applied to the whole gene set. This is exactly the norm in gene expression studies with thousands of genes. I never see researchers adjust for multiple responses except in these large large gene expression studies (or similar). So there is inconsistency in the logic applied to the statistical analysis not just within a field but within a single paper."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#how-i-would-adjust-adjusting-all-6-responses-using-fdr",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#how-i-would-adjust-adjusting-all-6-responses-using-fdr",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "How I would adjust: adjusting all 6 responses using FDR",
    "text": "How I would adjust: adjusting all 6 responses using FDR\n\n\nCode\n# this seems ultra klunky but it works\np &lt;- numeric(length(y_list))\nfor(j in 1:4){ # do this for each simple effect in the contrast table\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    p[i] &lt;- m1_pairs[j, p.value]\n  }\n  p_adj &lt;- p.adjust(p, \"fdr\")\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    m1_pairs[j, p_fdr := p_adj[i]]\n    fig3g_lmm1_pairs[[y_list[i]]] &lt;- m1_pairs\n  }\n}\n\n# create a table of p-values for cre contrasts only\n\nout_table &lt;- data.table(\n  response = y_list,\n  Sal_p = numeric(length(y_list)),\n  OHDA_p = numeric(length(y_list)),\n  Sal_fdr = numeric(length(y_list)),\n  OHDA_fdr = numeric(length(y_list))\n)\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    out_table[response == y_list[[i]], Sal_p := m1_pairs[3, p.value]]\n    out_table[response == y_list[[i]], OHDA_p:= m1_pairs[4, p.value]]\n    out_table[response == y_list[[i]], Sal_fdr := m1_pairs[3, p_fdr]]\n    out_table[response == y_list[[i]], OHDA_fdr := m1_pairs[4, p_fdr]]\n  }\n\nout_table |&gt;\n  kable(caption = \"unadjusted and FDR adjust p-values for Cre+ - Cre- contrasts within Saline and 6-OHDA treatments\") |&gt;\n  kable_styling()\n\n\n\n\nunadjusted and FDR adjust p-values for Cre+ - Cre- contrasts within Saline and 6-OHDA treatments\n\n\nresponse\nSal_p\nOHDA_p\nSal_fdr\nOHDA_fdr\n\n\n\n\nucp1\n0.0089590\n0.2052979\n0.0089590\n0.2463575\n\n\nelovl3\n0.0041345\n0.1382491\n0.0082690\n0.2463575\n\n\ncidea\n0.0059646\n0.1961155\n0.0088577\n0.2463575\n\n\nfasn\n0.0030145\n0.1881198\n0.0082690\n0.2463575\n\n\nacacb\n0.0073814\n0.3929358\n0.0088577\n0.3929358\n\n\nch_reb_pb\n0.0034794\n0.0926347\n0.0082690\n0.2463575"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#plotsreplicate",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#plotsreplicate",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Plots…replicate!",
    "text": "Plots…replicate!\n\n\nCode\nfig3g[, cre := ifelse(surgery == \"YFP\", \"Cre-\", \"Cre+\")]\nfig3g[, ohda := ifelse(tx == \"SAL\", \"SAL\", \"6-OHDA\")]\n\nfig3g[, treatment := paste(ohda, cre, sep = \"\\n\") |&gt;\n      factor(levels = c(\"SAL\\nCre-\", \"SAL\\nCre+\", \"6-OHDA\\nCre-\", \"6-OHDA\\nCre+\"))]\nplot_it &lt;- function(y_col,\n                    m1_pairs){\n  \n  gg &lt;- ggplot(data = fig3g,\n               aes(x = treatment,\n                   y = get(y_col))) +\n    geom_point(aes(color = surgery),\n               size = 2,\n               show.legend = FALSE) +\n    geom_line(aes(group = ear_tag),\n              color = \"gray\") +\n    ylab(\"Log 2 Fold Change\") +\n    ggtitle(y_col) +\n    scale_color_manual(values = pal_okabe_ito_2) +\n    theme_pubr() +\n    theme(axis.title.x = element_blank())\n  \n  # add p-values\n  p_table &lt;- data.table(\n    group1 = c(\"SAL\\nCre-\", \"6-OHDA\\nCre-\"),\n    group2 = c(\"SAL\\nCre+\", \"6-OHDA\\nCre+\"),\n    p = m1_pairs[3:4, p_sidak] |&gt;\n      p_round(digits = 4) |&gt; #rstatix package\n      p_format(digits = 4, #rstatix package\n                        accuracy = 1e-04,\n                        add.p = TRUE),\n    y.position = fig3g[, max(get(y_col))] + \n      0.05*(fig3g[, max(get(y_col))] - fig3g[, min(get(y_col))])\n  )\n  gg &lt;- gg +\n    stat_pvalue_manual(\n      data = p_table,\n      tip.length = 0.001)\n\n  return(gg)\n}\n\ngg_list &lt;- list()\nfor(i in 1:length(y_list)){\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  # use the sidak p-values\n  m1_pairs[, p.value := p_sidak]\n  gg &lt;- plot_it(y_col = y_list[i], m1_pairs)\n  gg_list[[y_list[i]]] &lt;- gg\n}\nplot_grid(plotlist = gg_list, nrow = 2)\n\n\n\n\n\n\n\n\n\nWhat’s going on with the direction of the effect in Fig 3g? Compare my figure with the published figure.\n\n\n\nFig 3g\n\n\nCompared to my figure built from the archived data, the data in Fig3g is reflected about the horizontal axis at y = 0, that is, the data are upside down, so the apparent direction of the differences is exactly opposite that of the archived data in the Excel file. The GraphPad prism contrasts tables in the Excel file match the archived data in the Excel file and not the plotted data. This doesn’t matter for the p-values but since directions of the differences are exactly opposite, the interpretation of the results is exactly opposite.\nSo, what’s up with the reflected (upside down) data? The matrices of archived values are \\(\\Delta C_q\\) and centered (\\(\\Delta\\Delta C_q\\)) values, which decrease as expression levels increase. We want an increase in expression to look like an increase in the y-value. So to get the effects in this meaningful direction, we can multiply the \\(\\Delta C_q\\) values by -1.\nLet’s reflect the \\(\\Delta\\Delta C_q\\) values by multiplying them by -1 and replot:\n\n\nCode\n# reflect the values in the response variables\nfig3g[, ucp1_ref := -ucp1]\nfig3g[, elovl3_ref := -elovl3]\nfig3g[, cidea_ref := -cidea]\nfig3g[, fasn_ref := -fasn]\nfig3g[, acacb_ref := -acacb]\nfig3g[, ch_reb_pb_ref := -ch_reb_pb]\n\ny_list_ref &lt;- paste0(y_list, \"_ref\")\ngg_list &lt;- list()\nfor(i in 1:length(y_list)){\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  # use the sidak p-values\n  m1_pairs[, p.value := p_sidak]\n  gg &lt;- plot_it(y_col = y_list_ref[i], m1_pairs)\n  gg_list[[y_list[i]]] &lt;- gg\n}\nplot_grid(plotlist = gg_list, nrow = 2)\n\n\n\n\n\n\n\n\n\nOkay - this replicates the plot!\n\n\nCode\nfor(i in 1:length(y_list)){\n  m1 &lt;- fig3g_lmm1[[y_list[i]]]\n}"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#published-methods-cut-and-pasted-from-the-article",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#published-methods-cut-and-pasted-from-the-article",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Published methods, cut and pasted from the article",
    "text": "Published methods, cut and pasted from the article\nA combination of axonal target injection of retrograde Cre and somatic expression of a Cre-dependent payload has been widely used to manipulate projection-specific circuits in the brain. However, legacy peripheral viral tracers such as pseudorabies virus and herpes simplex virus are highly toxic, restricting their use beyond acute anatomical mapping. In search for newer and safer viral vectors suitable for long-term functional manipulations, we found that AAV9 exhibited a high retrograde potential from iWAT to DRGs (Extended Data Fig. 4a). We adopted a published viral engineering pipeline22 to generate randomized mutants of AAV9 (Extended Data Fig. 4b,c). Although our initial intent was to improve retrograde efficiency from fat to DRGs, the evolved new retrograde vector optimized for organ tracing (or ROOT) is more desirable mainly for its significantly reduced off-target expression such as in SChGs, contralateral DRGs and the liver (Fig. 2a,b and Extended Data Fig. 4d–g).\nROOT provides an opportunity to specifically ablate the sensory innervation in fat—we injected Cre-dependent diphtheria toxin subunit A (DTA) construct (mCherry-flex-DTA) into the T13/L1 DRGs bilaterally while injecting Cre- or YFP-expressing ROOT unilaterally in the iWATs (Fig. 2c).\nAs thermogenic and lipogenesis programs are both downstream of sympathetic signalling24,26,29, we next tested whether the sensory-elicited gene expression changes are dependent on intact sympathetic innervation. We bilaterally injected 6-OHDA—a catecholaminergic toxin for selective sympathetic denervation (Extended Data Fig. 6c,d)—into the iWAT of mice that had previously undergone unilateral sensory ablation (Fig. 3f)."
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "",
    "text": "Fig 2s from the article"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#vital-info",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#vital-info",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Vital info",
    "text": "Vital info\nData From: Osseni, Alexis, et al. “Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.” Nature Communications 13.1 (2022): 7108.\nFig: 2s download data\nkey words:\nPublished methods: Mann-Whitney U on all data\nDesign: Completely Randomized Design with Subsampling (CRDS)\nResponse: fibrotic area\nKey learning concepts: linear mixed model, random intercept, nested ANOVA\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#the-experiment",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#the-experiment",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "The experiment",
    "text": "The experiment"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#setup",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#setup",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#import-and-wrangle",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#import-and-wrangle",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\"\nfile_name &lt;- \"ncomms-source-data files OSSENI et al.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig2s_wide &lt;- read_excel(file_path,\n                    sheet = \"Figure 2\",\n                    range = \"E138:J186\",\n                    col_names = FALSE) |&gt;\n  data.table()\nmouse_id &lt;- paste(\"mouse\", 1:6, sep = \"_\")\ntreatment_levels &lt;- c(\"MDX-Veh\", \"MDX-TubA\")\nmouse_treatment &lt;- paste(rep(treatment_levels, each = 3), mouse_id)\ncolnames(fig2s_wide) &lt;- mouse_treatment\nfig2s &lt;- melt(fig2s_wide,\n              measure.vars = mouse_treatment,\n              variable.name = \"mouse_treatment\",\n              value.name = \"fibrotic_area\") |&gt;\n  na.omit()\nfig2s[, c(\"treatment\", \"mouse_id\") := tstrsplit(mouse_treatment, \" \")]\nfig2s[, treatment := factor(treatment, levels = treatment_levels)]\n\nfile_out_name &lt;- \"fig2s-CRDS-Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, file_out_name)\nwrite_xlsx(fig2s, fileout_path)"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#fit-the-models",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#fit-the-models",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Fit the models",
    "text": "Fit the models\nThe Mann-Whitney U test used by the authors\n\n\nCode\nm0 &lt;- wilcox.test(fig2s[treatment == treatment_levels[1], fibrotic_area], fig2s[treatment == treatment_levels[2], fibrotic_area])\nm0\n\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  fig2s[treatment == treatment_levels[1], fibrotic_area] and fig2s[treatment == treatment_levels[2], fibrotic_area]\nW = 8740, p-value = 0.000204\nalternative hypothesis: true location shift is not equal to 0\n\n\nA linear mixed-model is the best practice method\n\n\nCode\nm1 &lt;- lmer(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm1_emm &lt;- emmeans(m1, specs = \"treatment\")\nm1_pairs &lt;- contrast(m1_emm, method = \"revpairwise\")\nm1_pairs\n\n\n contrast               estimate     SE df t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0639 0.0393  4  -1.627  0.1792\n\nDegrees-of-freedom method: kenward-roger \n\n\nA nested ANOVA is a classical method that is equivalent to the linear mixed model above when there are an equal number of technical replicates per mouse, but will be close otherwise. In general, things will rarely go wrong if one uses a nested ANOVA instead of the linear mixed-model. GraphPad Prism does nested ANOVA but not a linear mixed model.\n\n\nCode\nm2 &lt;- aov_4(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm2_emm &lt;- emmeans(m2, specs = \"treatment\")\nm2_pairs &lt;- contrast(m2_emm, method = \"revpairwise\")\nm2_pairs\n\n\n contrast               estimate     SE df t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0647 0.0395  4  -1.639  0.1766"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Data From",
    "section": "",
    "text": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\n\n\n\n\n\n\nlinear mixed model\n\n\nrandom intercept\n\n\nCRDS\n\n\nNested ANOVA\n\n\n\nFig 2s is a Completely Randomized Design with subsampling (CRDS), with 28-49 technical replicates per mouse. The researchers used a Mann-Whitney test that ignored the technical replication. This analysis is massively pseudoreplicated because techanical replicates are not independent evidence of effect of treatment. Individual mouse ID was archived, which makes it easy to re-analyze with models that account for the non-independence. The p-value accounting for non-independence is 0.18 while the p-value using Mann-Whitney on all data is 0.0002. Whoops!\n\n\n\n\n\nJun 2, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nFig 3g – The role of somatosensory innervation of adipose tissues\n\n\n\n\n\n\nlinear mixed model\n\n\nrandom intercept\n\n\nsplit plot\n\n\nggplot\n\n\n\nFig 3g is a split-plot design. I often see researchers analyze these using separate paired t-tests. This isn’t so bad, but is limiting, and a better alternative is a linear mixed model. But does this replicate the Repeated Measures ANOVA in GraphPad used by the researchers? It does! Yaaay!\n\n\n\n\n\nMay 21, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nFig 4h – FOXO1 is a master regulator of memory programming in CAR T cells\n\n\n\n\n\n\ntechnical replicates\n\n\npseudoreplication\n\n\nnested\n\n\nCRDS\n\n\nanalysis flag\n\n\n\nFig 4h contains thousands of technical replicates. Technical replicates should not be analyzed as if they were randomly assigned to one of the experimental treatments. They weren’t. The resulting p-value is junk.\n\n\n\n\n\nMay 17, 2024\n\n\nJeff Walker\n\n\n\n\n\n\nNo matching items"
  }
]