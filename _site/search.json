[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Data From began in 2018 as the name of a project that I used to collect example data sets for my Applied Biostatics class at the University of Southern Maine and for the R Markdown book Statistics for the Experimental Biologist that I was creating for this class.\n\nJeffrey A. Walker\nDepartment of Biological Sciences\nUniversity of Southern Maine\nwalker at maine dot edu\n\n\nOther sites\nStatistics for the Experimental Biologist\nBike Geometry Project – Exploration and classification of gravel bike geometry"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "",
    "text": "Fig 4h"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#vital-info",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#vital-info",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Vital info",
    "text": "Vital info\nData From: Doan, Alexander E., et al. “FOXO1 is a master regulator of memory programming in CAR T cells.” Nature (2024): 1-8.\nFig: 4h download data (note the tab is incorrectly labeled Figure 4i”)\nkey words: pseudoreplication, technical replicates, nested, simulation, confidence interval\nPublished methods: Wilcoxan rank-sum test (non-parametric t-test alternative)\nDesign: 2 x 1 CRDS\nResponse: per-cell module score, which is a combined expression level for a specified gene set.\nKey learning concepts: Pseudoreplication. Nested design.\nMore info: Chapter 16 Models for non-independence – linear mixed models\nQuick learning explanation: Pseudoreplication is the analysis of subsampled (technical) replicates as if they were experimental replicates. This is a violation of the assumption of independence of errors. Nested data are measures within a discrete unit or a hierarchy of units, for example technical replicates within a tumor within a mouse.\nComments: The researchers measured gene set expression levels in thousands of cells from mice assigned to two treatments, with five mice in each treatment. Cells from all mice within a treatment were pooled. The t-test assumes independent errors of all expression level scores but the scores of the different cells within a mouse are not independent – these are technical replicates or subsampled replicates – so the scores will be clustered (a clinical research term) or batched (a bench biology term) where each mouse is the cluster or batch.\nSingle-cell experiments of this design are effectively not worth the time and money because small p-values are almost guaranteed even if there is no true difference in expression level. That is, we are extremely unlikely to reliably learn anything. More generally, this design will result in extremely small p-values for very small, and possibly biologically meaningless, effect sizes. When this happens, researchers are likely to pursue research paths with trivial consequences for mouse health.\nAlways Remember: A p-value is a measure of evidence against the null model and not a measure of the truth of an effect. In bench biology, a p-value is best used to aid decision making – with a small p-value we can act as if an effect exists and pursue further experiments. If there is a high cost to these further experiments, we want a really small p-value (say &lt; 0.01) to act. If there is little cost to these further experiments we can use a larger p-value (say, &lt; 0.1) to act."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#pseudoreplication-red-flag",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#pseudoreplication-red-flag",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Pseudoreplication red flag",
    "text": "Pseudoreplication red flag\nLook at the figure!\nThe typical number of experimental replicates in bench biology is 3-8 with occasional replications up to about 30. The mere presence of many 10s or 100s of points per treatment is a red flag for pseudoreplication."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#background",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#background",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Background",
    "text": "Background\nCAR T cells are engineered immune cells that attack tumor cells. A common problem with CAR T cell treatment is the tumor cell killing activity diminishes over time. The researchers are interested in modifying the CAR T cells to maintain killing activity. FOX01 is a transcription factor that regulates genes that control the memory properties of T cells."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-experiment",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-experiment",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "The experiment",
    "text": "The experiment\nTreatment levels 1. tNGFR (control). This is truncated NGFR 2. FOX01_OE (treatment). This is a modification that overexpresses FOX01.\nUsing mice with osteosarcoma, five mice were infused with tNGFR CAR T cells and five mice were infused with FOX01_OE CAR T cells. Tumors were collected and CAR T cells were isolated and pooled across the five mice within a treatment for single-cell RNA sequencing.\nThe response is a per-cell module score, which is a combined expression level for a specified gene set, in log10 units."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-statistical-issue",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#the-statistical-issue",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "The statistical issue",
    "text": "The statistical issue\nThe treatments were not randomized to cell but to mouse, so the scores within mouse are not independent of each other because the cells within a tumor within a mouse share tumor environmental factors that cells within a tumor in other mice do not share."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#setup",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#setup",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Setup",
    "text": "Setup\n\n\nCode\nknitr::opts_chunk$set(echo = TRUE)\n\n# wrangling packages\nlibrary(here) # here makes a project transportable\nlibrary(janitor) # clean_names\nlibrary(readxl) # read excel, duh!\nlibrary(writexl) # write excel, duh!\nlibrary(data.table) # magical data frames\nlibrary(magrittr) # pipes\nlibrary(stringr) # string functions\nlibrary(forcats) # factor functions\n\n# analysis packages\nlibrary(emmeans) # the workhorse for inference\nlibrary(nlme) # gls and some lmm\nlibrary(lme4) # linear mixed models\nlibrary(lmerTest) # linear mixed model inference\nlibrary(afex) # ANOVA linear models\nlibrary(glmmTMB) # generalized linear models\nlibrary(MASS) # negative binomial and some other functions\nlibrary(car) # model checking and ANOVA\nlibrary(DHARMa) # model checking\nlibrary(mvtnorm)\n\n# graphing packages\nlibrary(ggsci) # color palettes\nlibrary(ggpubr) # publication quality plots\nlibrary(ggforce) # better jitter\nlibrary(cowplot) # combine plots\nlibrary(knitr) # kable tables\nlibrary(kableExtra) # kable_styling tables\n\n# ggplot_the_model.R packages not loaded above\nlibrary(insight)\nlibrary(lazyWeave)\n\n# use here from the here package\nhere &lt;- here::here\n# use clean_names from the janitor package\nclean_names &lt;- janitor::clean_names\n# use transpose from data.table\ntranspose &lt;- data.table::transpose\n\n# load functions used by this text written by me\n# ggplot_the_model.R needs to be in the folder \"R\"\n# if you didn't download this and add to your R folder in your\n# project, then this line will cause an error\nsource_path &lt;- here(\"R\", \"ggplot_the_model.R\")\nsource(source_path)\n\ndata_folder &lt;- \"data from\"\nimage_folder &lt;- \"images\"\noutput_folder &lt;- \"output\""
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#import-wrangle-and-summarize",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#import-wrangle-and-summarize",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Import, wrangle, and summarize",
    "text": "Import, wrangle, and summarize\nImport and wrangle using data.table.\n\n\nCode\ndata_from &lt;- \"FOXO1 is a master regulator of memory programming in CAR T cells\"\nfile_name &lt;- \"41586_2024_7300_MOESM9_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig4h_wide &lt;- read_excel(file_path,\n                    sheet = \"Figure 4i\",\n                    range = \"A4:h7659\",\n                    col_names = TRUE) |&gt;\n  data.table()\nsetnames(fig4h_wide,\n         old = names(fig4h_wide),\n         new = c(\"tNGFR_teff\", \"FOXO1OE_teff\", \"x1\",\n                 \"tNGFR_trm\", \"FOXO1OE_trm\", \"x2\",\n                 \"tNGFR_bulk\", \"FOXO1OE_bulk\"))\nfig4h_wide &lt;- fig4h_wide[, .SD, .SDcols = c(\"tNGFR_teff\", \"FOXO1OE_teff\",\n                                            \"tNGFR_trm\", \"FOXO1OE_trm\",\n                                            \"tNGFR_bulk\", \"FOXO1OE_bulk\")]\nfig4h &lt;- melt(fig4h_wide,\n             measure.vars = list(c(\"tNGFR_teff\", \"FOXO1OE_teff\"),\n                                 c(\"tNGFR_trm\", \"FOXO1OE_trm\"),\n                                 c(\"tNGFR_bulk\", \"FOXO1OE_bulk\")),\n             variable.name = \"treatment_code\",\n             value.name = c(\"teff\", \"trm\", \"bulk\"))\nfig4h[, treatment := ifelse(treatment_code == 1, \"tNGFR\", \"FOXO1OE\") |&gt;\n       factor(levels = c(\"tNGFR\", \"FOXO1OE\"))]\n\n\nSummarize data\n\n\nCode\nfig4h_long &lt;- melt(fig4h,\n                  id.vars = \"treatment\",\n                  measure.vars = c(\"teff\", \"trm\", \"bulk\"),\n                  variable.name = \"response\",\n                  value.name = \"score\")\nfig4h_summary &lt;- fig4h_long[!is.na(score), .(N = .N,\n                                mean = mean(score, na.rm = TRUE),\n                              sd = sd(score, na.rm = TRUE)),\n                          by = .(treatment, response)]\nfig4h_summary |&gt;\n  kable(caption = \"Summary data of three response measures\",\n        digits = c(1,1,0,3,3)) |&gt;\n  kable_styling()\n\n\n\nSummary data of three response measures\n\n\ntreatment\nresponse\nN\nmean\nsd\n\n\n\n\ntNGFR\nteff\n7346\n0.280\n0.332\n\n\nFOXO1OE\nteff\n7655\n0.499\n0.327\n\n\ntNGFR\ntrm\n7346\n0.031\n0.202\n\n\nFOXO1OE\ntrm\n7655\n0.105\n0.193\n\n\ntNGFR\nbulk\n7346\n0.379\n0.116\n\n\nFOXO1OE\nbulk\n7655\n0.448\n0.104"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#statistical-analysis-to-get-effect-sizes-but-no-inference",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#statistical-analysis-to-get-effect-sizes-but-no-inference",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Statistical analysis to get effect sizes (but no inference)",
    "text": "Statistical analysis to get effect sizes (but no inference)\nHere I fit a naïve linear model (t-test equivalent) ignoring nesting to get the effect size (fold change) and relative effects size (Cohen’s D).\n\n\nCode\nm1_teff &lt;- lm(teff ~ treatment, data = fig4h)\n#coef(summary(m1_teff))\nstats_table &lt;- data.table(\n  Response = \"TEFF\",\n  Difference = coef(summary(m1_teff))[2, 1],\n  \"Fold Change\" = 10^coef(summary(m1_teff))[2, 1],\n  Cohen = coef(summary(m1_teff))[2, 1]/summary(m1_teff)$sigma\n)\n\nm1_trm &lt;- lm(trm ~ treatment, data = fig4h)\nstats_table &lt;- rbind(stats_table,\n                     data.table(\n                       Response = \"TRM\",\n                       Difference = coef(summary(m1_trm))[2, 1],\n                       \"Fold Change\" = 10^coef(summary(m1_trm))[2, 1],\n                       Cohen = coef(summary(m1_trm))[2, 1]/summary(m1_trm)$sigma\n                     )\n)\n\nm1_bulk &lt;- lm(bulk ~ treatment, data = fig4h)\nstats_table &lt;- rbind(stats_table,\n                     data.table(\n                       Response = \"Bulk\",\n                       Difference = coef(summary(m1_bulk))[2, 1],\n                       \"Fold Change\" = 10^coef(summary(m1_bulk))[2, 1],\n                       Cohen = coef(summary(m1_bulk))[2, 1]/summary(m1_bulk)$sigma\n                     )\n)\nstats_table |&gt;\n  kable(digits = c(1,3,2,2)) |&gt;\n  kable_styling()\n\n\n\n\n\nResponse\nDifference\nFold Change\nCohen\n\n\n\n\nTEFF\n0.219\n1.65\n0.66\n\n\nTRM\n0.075\n1.19\n0.38\n\n\nBulk\n0.069\n1.17\n0.63\n\n\n\n\n\n\n\nThese fold-changes seem smallish, at least relative to fold changes for single genes (and not gene sets) that I typically see while scanning the bench biology literature. That said, what is important is not the fold change relative to other genes or gene sets but the biological consequences of the observed fold changes, a a kind of question that I’d love to see addressed more in the bench biology literature."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#what-wed-like-to-do-but-cannot",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#what-wed-like-to-do-but-cannot",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "What we’d like to do but cannot",
    "text": "What we’d like to do but cannot\nIf the cells for each mouse within a treatment hadn’t been pooled OR if we had the mouse ID for each cell, then we would simply average the scores over all cells within a mouse and use a t-test using the five values for tNGFR and five values for FOX01_OE."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#a-conservative-attempt-at-inference-using-resampling",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#a-conservative-attempt-at-inference-using-resampling",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "A conservative attempt at inference using resampling",
    "text": "A conservative attempt at inference using resampling\nThe experiment has five independent values per treatment. Assuming there is no variation in the response between mice (that is, all variation is among cells within a mouse), we can get a statistically-valid p-value by randomly sampling five values of each treatment and doing a t-test. This p-value will be very unstable due to the large variation within a treatment level relative to the difference between treatments, so a better method is to use the within-treamtent values as the sampling distribution.\nThe algorithm:\n\nSample five values of each treatment, with replacement\nDo a t-test\nSave the ttest statistic\nSave the effect (the difference in treatment means)\nRepeat 1-4 2000 times\n\nThe 95% confidence limits of the difference in means is computed as the 2.5 and 97.5 percentiles of the set of effects\nThe p-value is computed as the number of t-values less than zero (this is a one-sided test).\n\n\nCode\nset.seed(1)\nn_reps &lt;- 2000\nd_out &lt;- matrix(as.numeric(NA), nrow = n_reps, ncol = 3)\nt_out &lt;- matrix(as.numeric(NA), nrow = n_reps, ncol = 3)\ncolnames(d_out) &lt;- c(\"TEFF\", \"TRM\", \"Bulk\")\ncolnames(t_out) &lt;- c(\"TEFF\", \"TRM\", \"Bulk\")\n\ntngfr_teff &lt;- fig4h[treatment == \"tNGFR\", teff] |&gt;\n  na.omit()\nfox_teff &lt;- fig4h[treatment == \"FOXO1OE\", teff] |&gt;\n  na.omit()\ntngfr_trm &lt;- fig4h[treatment == \"tNGFR\", trm] |&gt;\n  na.omit()\nfox_trm &lt;- fig4h[treatment == \"FOXO1OE\", trm] |&gt;\n  na.omit()\ntngfr_bulk &lt;- fig4h[treatment == \"tNGFR\", bulk] |&gt;\n  na.omit()\nfox_bulk &lt;- fig4h[treatment == \"FOXO1OE\", bulk] |&gt;\n  na.omit()\n\nfor(i in 1:n_reps){\n  t_teff &lt;- t.test(sample(tngfr_teff, 5, replace = TRUE),\n                      sample(fox_teff, 5, replace = TRUE),\n                      equal.var = TRUE)\n  t_trm &lt;- t.test(sample(tngfr_trm, 5, replace = TRUE),\n                      sample(fox_trm, 5, replace = TRUE),\n                      equal.var = TRUE)\n  t_bulk &lt;- t.test(sample(tngfr_bulk, 5, replace = TRUE),\n                      sample(fox_bulk, 5, replace = TRUE),\n                      equal.var = TRUE)\n  d_out[i, \"TEFF\"] &lt;- t_teff$estimate |&gt; diff()\n  d_out[i, \"TRM\"] &lt;- t_trm$estimate |&gt; diff()\n  d_out[i, \"Bulk\"] &lt;- t_bulk$estimate |&gt; diff()\n\n  t_out[i, \"TEFF\"] &lt;- -t_teff$statistic\n  t_out[i, \"TRM\"] &lt;- -t_trm$statistic\n  t_out[i, \"Bulk\"] &lt;- -t_bulk$statistic\n\n}\n\nci &lt;- function(x){\n  return(quantile(x, c(0.025, 0.975)))\n}\n\nci_df &lt;- apply(d_out, 2, ci)\nci_table &lt;- data.table(\n  Response = colnames(ci_df),\n  t(ci_df)\n)\nci_table |&gt;\n  kable(caption = \"95% CIs of each response\",\n        digits = c(2, 2, 2)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n95% CIs of each response\n\n\nResponse\n2.5%\n97.5%\n\n\n\n\nTEFF\n-0.20\n0.64\n\n\nTRM\n-0.17\n0.31\n\n\nBulk\n-0.07\n0.20\n\n\n\n\n\n\n\nCode\nlt0 &lt;- function(x){\n  return(sum(x &lt; 0))\n}\n\np &lt;- apply(t_out, 2, lt0)/n_reps\np_table &lt;- data.table(\n  Response = names(p),\n  p = p)\np_table |&gt;\n  kable(caption = \"Resampled p-values of each response\",\n        digits = 2) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\nResampled p-values of each response\n\n\nResponse\np\n\n\n\n\nTEFF\n0.14\n\n\nTRM\n0.27\n\n\nBulk\n0.14\n\n\n\n\n\n\n\nA Confidence Interval is the set of bounds of the range of values that is consistent with the data and is useful to model the biological consequences of the low end vs. the high end.\nThe simplest use of a CI is to to simply use it as a binary p-value – if the CI includes zero, the p-value is not significant at the level of the CI (here, this is 5%). So, using the CI, we can infer that the p-value for each of the responses is not significant if we use 5% as our level. The directly measured p-values for all three responses are also not significant at this level and suggest we act as if there is no effect."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#better-p-valueskinda",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#better-p-valueskinda",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Better p-values…kinda",
    "text": "Better p-values…kinda\nThe resampling tests above are conservative because they use the total variance to estimate the t-value. What we really want is the variance among the mice, since this is the level that the treatment was applied, and this variance will be smaller than the total variance, so the denominator of the t-value will be smaller, the t-value will be bigger, and the p-value smaller! And we have a huge sample size to estimate this variance precisely.\nThe problem is, we don’t know the variance among the mice because the cells from mice within a treatment were pooled. So let’s model this and computed expected p-values across a range of among-mice variance. The amount of among-mice variance relative to the total variance (among-mice + among-cell) is the intraclass correlation coefficient (ICC), which ranges between zero and one. The further the ICC is from zero, the more correlated (dependent) the errors and the wrong the inference using a naïve test like that of the researchers.\nAlgorithm:\n\nStart with the lowest ICC in a pre-specified list of ICCs that range between 0 and 1\nUse the observed total variance and the ICC to compute the among-mouse (\\(\\sigma^2_\\alpha\\)) and among-cell (\\(\\sigma^2_\\varepsilon\\)) variances\nUse the among-mouse variance and the observed difference between treatment means to create fake mouse means with five mice per treatment and an expected difference between treatment means equal to the observed difference.\nUse the among-cell variance to create 1500 values per mouse (the average number of cells per mouse in the actual experiment) – these values are random “error” around each mouse mean.\nCompute the mean value for each mouse\nDo a t-test\nSave the t-value\nSave the p-value\nRepeat 2-8 2000 times\nCompute the Power of the modified experimental design at the specified ICC using the 2000 p-values\nCompute the expected p-value for this ICC by\n\n\nCompute the mean of the 2000 t-values\nCompute the p-value from the averaged t-value\n\n\nChange the ICC to the next higher ICC in the list and repeat 2-11.\n\n\n\nCode\nt_to_p &lt;- function(t){\n  p &lt;- 2 * pt(-abs(t), df = n * 2 - 2, lower.tail = TRUE)\n  return(p)\n}\n\nset.seed(1)\nn_reps &lt;- 2000\nn &lt;- 5\nn_ss &lt;- 1500\nsigma_total &lt;- summary(m1_teff)$sigma # estimated SD for TEFF\ndelta &lt;- .219 # observed difference for TEFF\nicc_vec &lt;- c(0.001, 0.005, 0.01, 0.02, 0.05, 0.1, 0.2, 0.3, 0.5, 0.75)\nt &lt;- numeric(n_reps)\ntable_out &lt;- data.table(NULL)\n#sigma_a^2: the variance among mice\n#sigma_e^2: the error variance (within mice)\nfor(sim_i in 1:length(icc_vec)){\n  icc &lt;- icc_vec[sim_i]\n  # icc = sigma_a^2/sigma_total^2\n  sigma_a &lt;- sqrt(icc * sigma_total^2)\n  # sigma_total^2 = sigma_a^2 + sigma_e^2\n  sigma_e &lt;- sqrt(sigma_total^2 - sigma_a^2)\n  for(rep_i in 1:n_reps){\n    tngfr_means &lt;- rnorm(n, sd = sigma_a) \n    fox_means &lt;- rnorm(n, sd = sigma_a) + delta \n    # slow\n    tngfr &lt;- rnorm(n * n_ss, mean = rep(tngfr_means, each = n_ss), sd = sigma_e) |&gt;\n      matrix(nrow = n_ss, ncol = n) |&gt;\n      apply(2, mean)\n    fox &lt;- rnorm(n * n_ss, mean = rep(fox_means, each = n_ss), sd = sigma_e) |&gt;\n      matrix(nrow = n_ss, ncol = n) |&gt;\n      apply(2, mean)\n    # fast shortcut since the estimated mean will be so close to true mean\n    # tngfr &lt;- tngfr_means\n    # fox &lt;- fox_means\n\n    t[rep_i] &lt;- t.test(tngfr, fox, var.equal = TRUE)$statistic\n  }\n  p &lt;- t_to_p(t)\n  table_out &lt;- rbind(\n    table_out,\n    data.table(\n      icc = icc,\n      t = mean(t),\n      power = sum(p &lt; 0.05)/n_reps\n    )\n  )\n  \n}\n\n\ntable_out[, p := 2 * pt(t, df = n * 2 - 2, lower.tail = TRUE)]\n\ngg1 &lt;- ggplot(data = table_out,\n              aes(x = icc,\n                  y = p)) +\n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dashed\") +\n  theme_pubr()\ngg2 &lt;- ggplot(data = table_out,\n              aes(x = icc,\n                  y = power)) +\n  geom_line() +\n  geom_hline(yintercept = 0.8, linetype = \"dashed\") +\n  theme_pubr()\nplot_grid(gg1, gg2, ncol = 2, labels = \"AUTO\")\n\n\n\n\n\n\n\n\n\nPanel A shows the expected, statistically valid p-value for the experimental design over a range of among-mouse variation relative to the total variation (the ICC). The modeling suggests that, given the observed difference, a modified experiment with known mouse ID for each cell would rarely observe small p-values unless the ICC were pretty small (less than about 0.25).\nPanel B shows the power of a modified experimental design with known mouse ID given different amounts of among-mouse variation relative to the total variation (the ICC) and using 5% as the significance level. Remember, Power is the probability of observing a p-value less than the set significance level. Typically, researchers want a power of 0.8 or higher to justify the time, cost and animal welfare of an experiment. The modeling suggests that a modified experimental design, with known mouse ID for each cell, and given the observed difference, would require a pretty small ICC (less than 0.15) in order to have good power.\nUnfortunately, we don’t know the actual ICC and it’s hard for me to make a reasonable guess, given my lack of familiarity with these kinds of data.\nAnd remember, the observed difference in expression levels seems kinda small."
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#why-the-actual-experimental-design-isnt-worth-the-time-money-or-cost-to-animal-welfare",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#why-the-actual-experimental-design-isnt-worth-the-time-money-or-cost-to-animal-welfare",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Why the actual experimental design isn’t worth the time, money, or cost to animal welfare",
    "text": "Why the actual experimental design isn’t worth the time, money, or cost to animal welfare\nGiven the actual (not modified to know mouse ID) experimental design, what is the rate of false positives (Type I error) - that is, the rate of significant p-values if there really were no effect of treatment? Like the power above, this depends on the relative amounts of among-mice and among-cell variance.\nAlgorithm:\n\nStart with the lowest ICC in a pre-specified list of ICCs that range between 0 and 1\nUse the observed total variance and the ICC to compute the among-mouse (\\(\\sigma^2_\\alpha\\)) and among-cell (\\(\\sigma^2_\\varepsilon\\)) variances\nUse the among-mouse variance to create fake mouse means with five mice per treatment and an expected difference between treatment means equal to zero.\nUse the among-cell variance to create 1500 values per mouse (the average number of cells per mouse in the actual experiment) – these values are random “error” around each mouse mean.\nCompute the mean value for each mouse\nDo a t-test\nSave the p-value\nRepeat 2-7 2000 times\nCompute the Type I error rate of the experimental design at the specified ICC using the 2000 p-values\nChange the ICC to the next higher ICC in the list and repeat 2-9.\n\n\n\nCode\nset.seed(1)\nn_reps &lt;- 2000\nn &lt;- 5\nn_ss &lt;- 1500\nsigma_total &lt;- summary(m1_teff)$sigma\nicc_vec &lt;- c(0, 0.001, 0.005, 0.01, 0.02, 0.05, 0.1, 0.2, 0.3, 0.5, 0.75)\np &lt;- numeric(n_reps)\ntable_out &lt;- data.table(NULL)\n#sigma_a^2: the variance among mice\n#sigma_e^2: the error variance (within mice)\nfor(sim_i in 1:length(icc_vec)){\n  icc &lt;- icc_vec[sim_i]\n  # icc = sigma_a^2/sigma_total^2\n  sigma_a &lt;- sqrt(icc * sigma_total^2)\n  # sigma_total^2 = sigma_a^2 + sigma_e^2\n  sigma_e &lt;- sqrt(sigma_total^2 - sigma_a^2)\n  for(rep_i in 1:n_reps){\n    mean_vec &lt;- rep(rnorm(n, sd = sigma_a), each = n_ss)\n    samp_1 &lt;- rnorm(n * n_ss, mean = mean_vec, sd = sigma_e)\n    mean_vec &lt;- rep(rnorm(n, sd = sigma_a), each = n_ss)\n    samp_2 &lt;- rnorm(n * n_ss, mean = mean_vec, sd = sigma_e)\n    p[rep_i] &lt;- t.test(samp_1, samp_2, var.equal = TRUE)$p.value\n  }\n  table_out &lt;- rbind(\n    table_out,\n    data.table(\n      icc = icc,\n      Type_I = sum(p &lt; 0.05)/n_reps\n    )\n  )\n  \n}\n\nggplot(data = table_out,\n       aes(x = icc,\n           y = Type_I)) +\n  geom_line() +\n  geom_hline(yintercept = 0.05, linetype = \"dashed\") +\n  theme_pubr()\n\n\n\n\n\n\n\n\n\nThe plot shows that at effectively any ICC not super close to zero, the Type I error rates are elevated and this elevation is extreme at even very small ICC – at an ICC of 0.005, this rate is 51%! At any biologically realistic ICC, the experimental design will result in significant p-values the majority of the time when the true treatment effect is zero!"
  },
  {
    "objectID": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#published-methods-cut-and-pasted-from-the-article",
    "href": "posts/FOXO1 is a master regulator of memory programming in CAR T cells/FOXO1 is a master regulator of memory programming in CAR T cells.html#published-methods-cut-and-pasted-from-the-article",
    "title": "Fig 4h – FOXO1 is a master regulator of memory programming in CAR T cells",
    "section": "Published Methods, cut and pasted from the article",
    "text": "Published Methods, cut and pasted from the article\nTo determine whether FOXO1 was also capable of increasing the activ- ity of CAR T cells against solid tumours, we infused tNGFR or FOXO1OE HER2.BBζ CAR T cells into 143B osteosarcoma-bearing NSG mice.\nTo generate single-cell RNA-seq libraries of tumour-infiltrating CAR T cells, Her2+ tumours were collected from five mice per condition, and human CD45+ cells were isolated by NGFR selection as described above (see ‘Cell selection’). Tumour-infiltrating CAR T cells were further purified by sorting human CD3+ TILs from each isolate using a Cytek Aurora Cell Sorter. A total of 20,000 CAR TILs were sorted from each tumour and pooled across five mice per group. Cells were barcoded and sequencing libraries were generated using the 10X Chromium Next GEM Single Cell 3’ v.3.1 kit (10X Genomics) according to the manufacturer’s instructions. Libraries were sequenced at the CHOP High Throughput Sequencing Core on an Illumina NovaSeq 6000 with an average read depth of 50,000 reads per cell.\nGene set scores for Teff, TRM and Treg cell subtypes were calculated with AddModuleScore (Seurat), using curated gene lists from a previous study58 (Extended Data Fig. 9g–i). AddModuleScore was also used to calculate a per-cell FOXO1 transcriptional activity score, using the top 100 upregulated genes in CD8+ HA.28ζ CAR T cells overexpressing FOXO1 versus tNGFR (Fig. 2)."
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html",
    "title": "Models for proportion (part to whole percent) data",
    "section": "",
    "text": "Better than Reproducibility of Fig 5c. The CIs and p-values are from a quasipoisson GLM model with offset"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#vital-info",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#vital-info",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Vital info",
    "text": "Vital info\nData From: Ahmed, A., Joseph, A. M., Zhou, J., Horn, V., Uddin, J., Lyu, M., … & Sonnenberg, G. F. (2024). CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation. Nature, 1-8.\nFig: 3k download data\nFig: 5c download data\nkey words:\nPublished methods: Mann-Whitney U test\nDesign: Completely Randomized Design (CRD)\nResponse: proportion (number of CTLA-4+ ILC3 cells relative to total ILC3 cell count)\nKey learning concepts: proportions and offsets\nMore info: 18.4 Example 2 – Use a GLM with an offset instead of a ratio of some measurement per total (“dna damage” data fig3b)"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#the-experiment",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#the-experiment",
    "title": "Models for proportion (part to whole percent) data",
    "section": "The Experiment",
    "text": "The Experiment\nIntestinal biopsies from patients with IBD versus age- and gender-matched controls"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#setup",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#setup",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#import-and-wrangle",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#import-and-wrangle",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation\"\nfile_name &lt;- \"41586_2024_7537_MOESM8_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nhealth_levels &lt;- c(\"Healthy\", \"IBD\")\nfig5c &lt;- read_excel(file_path,\n                    sheet = \"Fig. 5c\",\n                    range = \"F5:G25\",\n                    col_names = TRUE) |&gt;\n  data.table() |&gt;\n  melt(variable.name = \"health\", value.name = \"ctla4_pos\")\nfig5c[, health := factor(health, levels = health_levels)]\n\n\nfile_out_name &lt;- \"Fig5c-proportion - CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, file_out_name)\nwrite_xlsx(fig5c, fileout_path)"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#reproducibility",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#reproducibility",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Reproducibility",
    "text": "Reproducibility\n\n\nCode\nwilcox.test(ctla4_pos ~ health, data = fig5c)\n\n\n\n    Wilcoxon rank sum exact test\n\ndata:  ctla4_pos by health\nW = 52, p-value = 2.138e-05\nalternative hypothesis: true location shift is not equal to 0"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#lm",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#lm",
    "title": "Models for proportion (part to whole percent) data",
    "section": "LM",
    "text": "LM\n\n\nCode\nm1 &lt;- lm(ctla4_pos ~ health, data = fig5c)\nm1_emm &lt;- emmeans(m1, specs = \"health\")\nm1_pairs &lt;- contrast(m1_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\nm1_pairs |&gt;\n  kable() |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\ncontrast\nestimate\nSE\ndf\nlower.CL\nupper.CL\nt.ratio\np.value\n\n\n\n\nIBD - Healthy\n5.9105\n1.33596\n38\n3.20599\n8.61501\n4.424158\n7.87e-05\n\n\n\n\n\n\n\n\n\nCode\nggcheck_the_model(m1)"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#glm-for-percent-proportion-of-whole-data",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#glm-for-percent-proportion-of-whole-data",
    "title": "Models for proportion (part to whole percent) data",
    "section": "GLM for percent (proportion of whole) data",
    "text": "GLM for percent (proportion of whole) data\n\n\nCode\nfig5c[, ctla4_prop := ctla4_pos/100]\nm2 &lt;- glm(ctla4_prop ~ health,\n          family = quasibinomial,\n          data = fig5c)\nm2_emm &lt;- emmeans(m2, specs = \"health\")\nm2_pairs &lt;- contrast(m2_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\nm2_pairs |&gt;\n  kable() |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\ncontrast\nestimate\nSE\ndf\nasymp.LCL\nasymp.UCL\nz.ratio\np.value\n\n\n\n\nIBD - Healthy\n1.110088\n0.2486297\nInf\n0.622783\n1.597393\n4.464826\n8e-06"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#should-i-use-mann-whitney-a-linear-model-or-a-quasibinomial-glm-for-proportion-data",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#should-i-use-mann-whitney-a-linear-model-or-a-quasibinomial-glm-for-proportion-data",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Should I use Mann-Whitney, a Linear Model, or a Quasibinomial GLM for proportion data?",
    "text": "Should I use Mann-Whitney, a Linear Model, or a Quasibinomial GLM for proportion data?\nAnswer: None of the Above\nProportions have strange, non-normal distributions. Samples tend to be right skewed if the mean is closer to zero but left skewed if the mean is closer to 1. And, samples with means closer to 0.5 tend to have more variance than samples closer to 0 or 1. This is probably why the authors used a non-parametric test (Mann-Whitney U). A Mann-Whitney test has higher power than a linear model / t-test but other than the p-value, there are no statistics to plot with the data. There is no effect in a a Mann-Whitney – it is not a test of the differences in the means (or medians!). And, we can’t compute a confidence interval for the group means.\nA proportion is a ratio of a part to the whole. A modern statistical method for analyzing proportion data is to use a log-link generalized linear model with the part as the response and the whole as an offset variable. An offset variable is a covariate but the coefficient is forced to be one. By forcing the coefficient to be one, the effect is the ratio of the means of the two proportions (or the difference of the means of the proportions in log space)."
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#glm-for-percent-proportion-of-whole-data-when-both-part-and-whole-are-known",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#glm-for-percent-proportion-of-whole-data-when-both-part-and-whole-are-known",
    "title": "Models for proportion (part to whole percent) data",
    "section": "GLM for percent (proportion of whole) data when both part and whole are known",
    "text": "GLM for percent (proportion of whole) data when both part and whole are known\nThe effect (2.85) is the ratio of the mean proportion of the IBD group to the mean proportion of the Health group.\n\n\nCode\n# pretending to have the full count data. Don't do this if you don't have it!\nfake_ilc3 &lt;- 432987\nfig5c[, ctla4_count := ctla4_pos * 432987]\nfig5c[, ilc3_count := 432987]\n\nm3 &lt;- glm(ctla4_count ~ health + offset(log(ilc3_count)),\n          family = quasipoisson(link = \"log\"),\n          data = fig5c)\nm3_emm &lt;- emmeans(m3, specs = \"health\", type = \"response\")\nm3_pairs &lt;- contrast(m3_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\nm3_pairs |&gt;\n  kable() |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\ncontrast\nratio\nSE\ndf\nasymp.LCL\nasymp.UCL\nnull\nz.ratio\np.value\n\n\n\n\nIBD / Healthy\n2.849343\n0.6666548\nInf\n1.80132\n4.507114\n1\n4.47535\n7.6e-06\n\n\n\n\n\n\n\n\n\nCode\nmean(fig5c[health == \"IBD\", ctla4_pos])/mean(fig5c[health == \"Healthy\", ctla4_pos])\n\n\n[1] 2.849343"
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#a-simulation-comparing-mann-whitney-a-linear-modelt-test-a-quasibinomial-glm-for-proportions-and-a-quasipoisson-glm-with-offset",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#a-simulation-comparing-mann-whitney-a-linear-modelt-test-a-quasibinomial-glm-for-proportions-and-a-quasipoisson-glm-with-offset",
    "title": "Models for proportion (part to whole percent) data",
    "section": "A simulation comparing Mann-Whitney, a linear model/t-test, a quasibinomial GLM for proportions, and a quasipoisson GLM with offset",
    "text": "A simulation comparing Mann-Whitney, a linear model/t-test, a quasibinomial GLM for proportions, and a quasipoisson GLM with offset\n\n\nCode\nget_clean_proportion_data &lt;- function(n_sample, # sample size\n                                      n_cols, # number of samples\n                                      mu_num, # numerator\n                                      mu_denom, # denominator\n                                      theta, # size\n                                      rho_matrix, # correlation is in ij\n                                      seed_starter){\n  fake_y &lt;- rcorrvar(n = n_sample * n_cols,\n                     mu = c(mu_num, mu_denom),\n                     k_nb = 2,\n                     size = c(theta, theta),\n                     rho = rho_matrix,\n                     seed = seed_starter)$Neg_Bin_variables\n  \n  n_cols_extra &lt;- n_cols*2\n  num_mat &lt;- matrix(fake_y[,\"V1\"], nrow = n_sample, ncol = n_cols_extra)\n  denom_mat &lt;- matrix(fake_y[,\"V2\"], nrow = n_sample, ncol = n_cols_extra)\n  prop_mat &lt;- num_mat/denom_mat\n  #cor(ctla4_mat[, 2], ilc3_mat[, 2])\n\n  # check for zero counts\n  exc &lt;- NULL\n  for(j in 1:n_cols_extra){\n    exc_this &lt;- FALSE\n    if(any(num_mat[, j] == 0) == TRUE){exc_this &lt;- TRUE}\n    if(any(denom_mat[, j] == 0) == TRUE){exc_this &lt;- TRUE}\n    if(exc_this == TRUE){\n      exc &lt;- c(exc, j)\n    }\n  }\n  if(!is.null(exc)){\n    num_mat &lt;- num_mat[, -(exc)]\n    denom_mat &lt;- denom_mat[, -(exc)]\n    prop_mat &lt;- prop_mat[, -(exc)]\n  }\n  n_cols_extra &lt;- ncol(num_mat)\n  \n  # check for prop &gt; 1\n  exc &lt;- NULL\n  for(j in 1:n_cols_extra){\n    exc_this &lt;- FALSE\n    if(any(prop_mat[, j] &gt; 1) == TRUE){exc_this &lt;- TRUE}\n    if(exc_this == TRUE){\n      exc &lt;- c(exc, j)\n    }\n  }\n  if(!is.null(exc)){\n    num_mat &lt;- num_mat[, -(exc)]\n    denom_mat &lt;- denom_mat[, -(exc)]\n    prop_mat &lt;- prop_mat[, -(exc)]\n  }\n  \n  num_mat &lt;- num_mat[, 1:n_cols]\n  denom_mat &lt;- denom_mat[, 1:n_cols]\n  prop_mat &lt;- prop_mat[, 1:n_cols]\n  return(list(\n    numerator = num_mat,\n    denominator = denom_mat,\n    proportion = prop_mat\n  ))\n}\n\n\n\n\nCode\n# get parameters\ndo_it &lt;- FALSE\nif(do_it){\n  seed_sim &lt;- 2\n  data_params &lt;- fig5c[, .(mean = mean(ctla4_prop),\n                           sd = sd(ctla4_prop),\n                           N = .N), by = \"health\"]\n  \n  # first get theta that approximates that of the data\n  do_theta &lt;- FALSE\n  if(do_theta){\n    n_iter &lt;- 2000\n    mu_prop &lt;- data_params$mean\n    mu_ctla4 &lt;- mu_prop * 10^5\n    mu_ilc3 &lt;- c(10^5, 10^5)\n    n_vec &lt;- data_params$N\n    rho_ij &lt;- 0.9\n    rho_sim &lt;- diag(2)\n    rho_sim[1, 2] &lt;- rho_sim[2, 1] &lt;- rho_ij\n    theta_vec &lt;- c(0.75, 1, 2)\n    sd_table &lt;- data.table(\n      set = \"fig5c\",\n      sd_healthy = data_params[1, 3],\n      sd_ibd = data_params[2, 3]\n    )\n    colnames(sd_table) &lt;- c(\"Set\", \"SD (Healthy)\", \"SD (IBD)\")\n    for(theta_i in theta_vec){\n      fake_healthy &lt;- get_clean_proportion_data(\n        n_sample = n_vec[1], # sample size\n        n_cols = n_iter, # number of samples\n        mu_num = mu_ctla4[1], # numerator\n        mu_denom = mu_ilc3[1], # denominator\n        theta = theta_i, # size\n        rho_matrix = rho_sim, # correlation is in ij\n        seed_starter = 1)\n      fake_ibd &lt;- get_clean_proportion_data(\n        n_sample = n_vec[2], # sample size\n        n_cols = n_iter, # number of samples\n        mu_num = mu_ctla4[2], # numerator\n        mu_denom = mu_ilc3[2], # denominator\n        theta = theta_i, # size\n        rho_matrix = rho_sim, # correlation is in ij\n        seed_starter = 2)\n      sd_table &lt;- rbind(sd_table,\n                        data.table(\n                          \"Set\" = paste(\"Theta =\", theta_i),\n                          \"SD (Healthy)\" = sd(fake_healthy[[\"proportion\"]]),\n                          \"SD (IBD)\" = sd(fake_ibd[[\"proportion\"]])\n                        ))\n    }    \n  }\n\n# results of above show theta = 1 gives a pretty close approximation\n# of the SD of the proportions\n#             Set SD (Healthy)   SD (IBD)\n#          &lt;char&gt;        &lt;num&gt;      &lt;num&gt;\n# 1:        fig5c   0.02491151 0.05430466\n# 2: Theta = 0.75   0.03697002 0.08533117\n# 3:    Theta = 1   0.02506654 0.06500954\n# 4:    Theta = 2   0.01250806 0.03550890\n\n  # now do simulation\n  # I had abort with n_iter &gt;= 3000 so I'm doing two sets of 2500\n  n_iter &lt;- 2500\n  iter_sets &lt;- 4\n  total_iter &lt;- n_iter * iter_sets\n  mu_prop &lt;- data_params$mean\n  n_vec &lt;- data_params$N\n  rho_ij &lt;- 0.9\n  rho_sim &lt;- diag(2)\n  rho_sim[1, 2] &lt;- rho_sim[2, 1] &lt;- rho_ij\n  theta_i &lt;- 1 # this gives sd of proportions that are close to data. see above simulation\n\n  fd &lt;- data.table(\n    health = rep(c(\"Healthy\", \"IBD\"), data_params$N),\n    ilc3 = as.numeric(NA),\n    ctla4 = as.numeric(NA)\n  )\n  \n  power_matrix &lt;- matrix(nrow = total_iter, ncol = 5)\n  colnames(power_matrix) &lt;- c(\"mwu\",\"lm\", \"qb\", \"nb\", \"qp\")\n  type1_matrix &lt;- matrix(nrow = total_iter, ncol = 5)\n  colnames(type1_matrix) &lt;- c(\"mwu\",\"lm\", \"qb\", \"nb\", \"qp\")\n\n  seed_starter_sim &lt;- 0\n  for(iter_set in 1:iter_sets){\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    # power\n    # make effect size smaller so power &lt; 1\n    mu_prop[2] &lt;- mu_prop[1] * 1.5\n    mu_ctla4 &lt;- mu_prop * 10^5\n    mu_ilc3 &lt;- c(10^5, 10^5)\n    fake_healthy &lt;- get_clean_proportion_data(\n      n_sample = n_vec[1], # sample size\n      n_cols = n_iter, # number of samples\n      mu_num = mu_ctla4[1], # numerator\n      mu_denom = mu_ilc3[1], # denominator\n      theta = theta_i, # size\n      rho_matrix = rho_sim, # correlation is in ij\n      seed_starter = seed_starter_sim)\n    \n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_ibd &lt;- get_clean_proportion_data(\n      n_sample = n_vec[2], # sample size\n      n_cols = n_iter, # number of samples\n      mu_num = mu_ctla4[2], # numerator\n      mu_denom = mu_ilc3[2], # denominator\n      theta = theta_i, # size\n      rho_matrix = rho_sim, # correlation is in ij\n      seed_starter = seed_starter_sim)\n    ctla4_mat &lt;- rbind(fake_healthy[[\"numerator\"]],\n                       fake_ibd[[\"numerator\"]])\n    ilc3_mat &lt;- rbind(fake_healthy[[\"denominator\"]],\n                      fake_ibd[[\"denominator\"]])\n    ctla4_prop_mat &lt;- rbind(fake_healthy[[\"proportion\"]],\n                            fake_ibd[[\"proportion\"]])\n    \n    for(iter in 1:n_iter){\n      sim_i &lt;- n_iter*(iter_set - 1) + iter\n      # fake data\n      fd[, ctla4 := ctla4_mat[, iter]]\n      fd[, ilc3 := ilc3_mat[, iter]]\n      fd[, ctla4_prop := ctla4_prop_mat[, iter]]\n      \n      # Mann Whitney\n      power_matrix[sim_i, \"mwu\"] &lt;- wilcox.test(ctla4_prop ~ health, data = fd)$p.value\n      \n      # lm\n      m_lm &lt;- lm(ctla4_prop ~ health, data = fd)\n      power_matrix[sim_i, \"lm\"] &lt;- coef(summary(m_lm))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n      # glm bin\n      m_qb &lt;- glm(ctla4_prop ~ health,\n                  family = quasibinomial,\n                  data = fd)\n      power_matrix[sim_i, \"qb\"] &lt;- coef(summary(m_qb))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n      # glm nb\n      m_nb &lt;- glm.nb(ctla4 ~ health + offset(log(ilc3)),\n                     data = fd)\n      power_matrix[sim_i, \"nb\"] &lt;- coef(summary(m_nb))[\"healthIBD\", \"Pr(&gt;|z|)\"]\n      \n      # glm qp\n      m_qp &lt;- glm(ctla4 ~ health + offset(log(ilc3)),\n                  family = quasipoisson(link = \"log\"),\n                  data = fd)\n      power_matrix[sim_i, \"qp\"] &lt;- coef(summary(m_qp))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n      #       do_plot &lt;- FALSE\n      #       if(do_plot){\n      #         m_qb_emm &lt;- emmeans(m_qb, specs = \"health\", type = \"response\")\n      #         m_qb_pairs &lt;- contrast(m_qb_emm, method = \"revpairwise\") |&gt;\n      #           summary(infer = TRUE)\n      # #        plot_response(m_qb, m_qb_emm, m_qb_pairs)\n      #         ggplot(data = fd,\n      #                aes(x = health,\n      #                    y = ctla4_prop,\n      #                    color = health)) +\n      #           geom_point()\n      #       }\n      \n    }\n    \n    \n    # type I\n    mu_prop[2] &lt;- mu_prop[1]\n    mu_ctla4 &lt;- mu_prop * 10^5\n    mu_ilc3 &lt;- c(10^5, 10^5)\n    \n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_healthy &lt;- get_clean_proportion_data(\n      n_sample = n_vec[1], # sample size\n      n_cols = n_iter, # number of samples\n      mu_num = mu_ctla4[1], # numerator\n      mu_denom = mu_ilc3[1], # denominator\n      theta = theta_i, # size\n      rho_matrix = rho_sim, # correlation is in ij\n      seed_starter = seed_starter_sim)\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_ibd &lt;- get_clean_proportion_data(\n      n_sample = n_vec[2], # sample size\n      n_cols = n_iter, # number of samples\n      mu_num = mu_ctla4[2], # numerator\n      mu_denom = mu_ilc3[2], # denominator\n      theta = theta_i, # size\n      rho_matrix = rho_sim, # correlation is in ij\n      seed_starter = seed_starter_sim)\n    ctla4_mat &lt;- rbind(fake_healthy[[\"numerator\"]],\n                       fake_ibd[[\"numerator\"]])\n    ilc3_mat &lt;- rbind(fake_healthy[[\"denominator\"]],\n                      fake_ibd[[\"denominator\"]])\n    ctla4_prop_mat &lt;- rbind(fake_healthy[[\"proportion\"]],\n                            fake_ibd[[\"proportion\"]])\n    \n    for(iter in 1:n_iter){\n      sim_i &lt;- n_iter*(iter_set - 1) + iter\n      # fake data\n      fd[, ctla4 := ctla4_mat[, iter]]\n      fd[, ilc3 := ilc3_mat[, iter]]\n      fd[, ctla4_prop := ctla4_prop_mat[, iter]]\n      \n      # Mann Whitney\n      type1_matrix[sim_i, \"mwu\"] &lt;- wilcox.test(ctla4_prop ~ health, data = fd)$p.value\n      \n      # lm\n      m_lm &lt;- lm(ctla4_prop ~ health, data = fd)\n      type1_matrix[sim_i, \"lm\"] &lt;- coef(summary(m_lm))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n      # glm bin\n      m_qb &lt;- glm(ctla4_prop ~ health,\n                  family = quasibinomial,\n                  data = fd)\n      type1_matrix[sim_i, \"qb\"] &lt;- coef(summary(m_qb))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n      # glm nb\n      m_nb &lt;- glm.nb(ctla4 ~ health + offset(log(ilc3)),\n                     data = fd)\n      type1_matrix[sim_i, \"nb\"] &lt;- coef(summary(m_nb))[\"healthIBD\", \"Pr(&gt;|z|)\"]\n      \n      # glm qp\n      m_qp &lt;- glm(ctla4 ~ health + offset(log(ilc3)),\n                  family = quasipoisson(link = \"log\"),\n                  data = fd)\n      type1_matrix[sim_i, \"qp\"] &lt;- coef(summary(m_qp))[\"healthIBD\", \"Pr(&gt;|t|)\"]\n      \n    }    \n  }\n\n  saveRDS(power_matrix, \"power_matrix.Rds\")\n  saveRDS(type1_matrix, \"type1_matrix.Rds\")\n}else{\n  power_matrix &lt;- readRDS(\"power_matrix.Rds\")\n  type1_matrix &lt;- readRDS(\"type1_matrix.Rds\")\n}\n\npless &lt;- function(x, alpha = 0.05){\n  stat &lt;- sum(x &lt;= alpha)/length(x)\n  return(stat)\n}\n\n\n\n\nCode\nres &lt;- data.table(\n  Test = c(\"Mann-Whitney\", \"Linear Model/T-test\", \"Quasibinomial\", \"Negative Binomial\", \"Quasipoisson\"),\n  Power = apply(power_matrix, 2, pless, alpha = 0.05),\n  \"Type I\" = apply(type1_matrix, 2, pless, alpha = 0.05)\n)\nres |&gt;\n  kable(digits = c(1,2,3)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\nTest\nPower\nType I\n\n\n\n\nMann-Whitney\n0.69\n0.047\n\n\nLinear Model/T-test\n0.56\n0.040\n\n\nQuasibinomial\n0.58\n0.046\n\n\nNegative Binomial\n0.70\n0.106\n\n\nQuasipoisson\n0.83\n0.075\n\n\n\n\n\n\n\nFor data that look like those in fig. 5c, the Mann-Whitney has good Type I control and high power relative to the linear model/t-test and compared to the quasibinomial GLM model. But the quasipoisson GLM offset model for the original counts has 20% higher power than the Mann-Whitney, but slightly elevated Type 1. And the beauty of the quasipoisson GLM is we get model statistics to plot with the data (see the plot below).\nThe table below shows the Power and Type I error when alpha is set to 0.03. The power for the quasipoisson model with alpha = 0.03 has good Type I control and is 13% higher than the power for the Mann-Whitney with alpha = 0.05.\n\n\nCode\nres &lt;- data.table(\n  Test = c(\"Mann-Whitney\", \"Linear Model/T-test\", \"Quasibinomial\", \"Negative Binomial\", \"Quasipoisson\"),\n  Power = apply(power_matrix, 2, pless, alpha = 0.03),\n  \"Type I\" = apply(type1_matrix, 2, pless, alpha = 0.03)\n)\nres |&gt;\n  kable(digits = c(1,2,3)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\nTest\nPower\nType I\n\n\n\n\nMann-Whitney\n0.61\n0.027\n\n\nLinear Model/T-test\n0.47\n0.022\n\n\nQuasibinomial\n0.49\n0.027\n\n\nNegative Binomial\n0.64\n0.072\n\n\nQuasipoisson\n0.78\n0.047\n\n\n\n\n\n\n\nIf using the quasipoisson GLM we could make the test a bit more conservative by using smaller alpha, but again, I don’t think bench biologists really use alpha in any formal sense."
  },
  {
    "objectID": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#plot-the-model",
    "href": "posts/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation/CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation.html#plot-the-model",
    "title": "Models for proportion (part to whole percent) data",
    "section": "Plot the model",
    "text": "Plot the model\nA good question is, how do we Plot the Model? A proportion response makes sense for communication but the emmeans table has whole-count adjusted counts as the mean response. But these adjusted counts are proportions, just unscaled by the denominator. So we can rescale the mean and CIs as proportions (or percents) by dividing by the mean counts of the whole (ilc3 count).\n\n\nCode\nm3_emm_dt &lt;- m3_emm |&gt;\n  summary() |&gt;\n  data.table()\nm3_pairs_dt &lt;- data.table(m3_pairs)\n\n# rescale mean and CIs to percent\nmeans_table &lt;- fig5c[, .(ctla4 = mean(ctla4_count),\n                         ilc3 = mean(ilc3_count),\n                         ctla4_per = mean(ctla4_pos)), by = health]\nscale_factor &lt;- mean(fig5c$ilc3)\nm3_emm_dt[, mean :=rate/scale_factor]\nm3_emm_dt[, lo :=asymp.LCL/scale_factor]\nm3_emm_dt[, hi :=asymp.UCL/scale_factor]\n\ngg &lt;- ggplot(data = fig5c,\n             aes(x = health,\n                 y = ctla4_pos,\n                 color = health)) +\n  geom_sina(maxwidth = 0.5,\n            show.legend = FALSE) +\n  geom_errorbar(data = m3_emm_dt,\n                aes(x = health,\n                    y = mean,\n                    ymin = lo,\n                    ymax = hi),\n                width = 0.05,\n                color = \"black\") +\n  geom_point(data = m3_emm_dt,\n             aes(x = health,\n                 y = mean),\n             size = 3,\n             color = \"black\") +\n  ylab(\"CTLA-4+ (% of ILC3)\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\n  # add p-values\nm3_pairs_dt[, group1 := \"Healthy\"]\nm3_pairs_dt[, group2 := \"IBD\"]\nm3_pairs_dt[, p := p.value |&gt;\n              p_round(digits = 2) |&gt;\n              p_format(digits = 2, accuracy = 1e-03, add.p = TRUE)]\nmaxy &lt;- fig5c[, max(ctla4_pos)]\nminy &lt;- fig5c[, min(ctla4_pos)]\nm3_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]\n\ngg &lt;- gg +\n  stat_pvalue_manual(\n    data = m3_pairs_dt,\n    label = \"p\",\n    tip.length = 0.001)\n\ngg\n\n\n\n\n\n\n\n\n\nCode\nsave_it &lt;- FALSE\nif(save_it){\nout_fig &lt;- \"fig5c_ggplot.png\"\nout_path &lt;- here(\"figs\", data_from, out_fig)\nggsave(out_path)\n}"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "",
    "text": "ggplot better-than-replication of Fig 3b from the article. It’s better than because the confidence intervals from the model are asymmetric and reflect the right (upward) skew of the data"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#vital-info",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#vital-info",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Vital info",
    "text": "Vital info\nData From: Serrano, J., Boyd, J., Brown, I.S. et al. The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity. Nat Commun 15, 4915 (2024). https://doi.org/10.1038/s41467-024-49100-8\nFig: 3b download data\nkey words:\nPublished methods: ratio paired t-test\nDesign: Randomized Complete Block Design (RCBD)\nResponse: gel intensity\nKey learning concepts: asymmetric confidence intervals\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-experiment",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-experiment",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "The experiment",
    "text": "The experiment\nThe researchers engineered mice to express human TAS1R2 receptor in the muscles of muscle-specific TAS1R2 knockout (mKO) mice. Aspartame is a TAS1R2 agonist in humans but not mice. Presumably Saline was injected in muscle on one side and Aspartame on the other side of the same mouse, so mouse is a block, hence the ratio paierd t-test.\nTreatments\n\nVeh – Saline? injected into mTg mice muscle\nAsp – Aspartame injected into mTg mice muscle"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#setup",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#setup",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#import-and-wrangle",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#import-and-wrangle",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity\"\nfile_name &lt;- \"41467_2024_49100_MOESM5_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig3b_wide &lt;- read_excel(file_path,\n                    sheet = \"Fig.3b\",\n                    range = \"B7:C13\",\n                    col_names = TRUE) |&gt;\n  data.table()\nsetnames(fig3b_wide, old = names(fig3b_wide), new = c(\"Veh\", \"Asp\"))\nfig3b_wide[, mouse := paste0(\"mouse_\", .I)]\nfig3b &lt;- melt(fig3b_wide,\n              id.vars = \"mouse\",\n              variable.name = \"genotype\",\n              value.name = \"ppar1\")\n\n# output as clean excel file\nfileout_name &lt;- \"fig3b-RCBD-The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig3b, fileout_path)"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#fit-the-model",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#fit-the-model",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Fit the model",
    "text": "Fit the model\nThe paired t-test is a special case of a linear mixed model – specifically a linear mixed model with a single fixed factor and a single random intercept. For the ratio paired t-test, simply fit the model to the log transformed response.\nFor this experiment, genotype is the fixed factor, and mouse is the block, so will be fit as a random factor. Note that I include the log transorm in the model formula, which signals the emmeans package to report the results on the response scale, which makes the treatment effect a ratio instead of a log ratio.\n\n\nCode\nlmm1 &lt;- lmer(log(ppar1) ~ genotype + (1 | mouse),\n             data = fig3b)"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-linear-mixed-model-results-replicate-the-published-results",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-linear-mixed-model-results-replicate-the-published-results",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "The linear mixed model results replicate the published results",
    "text": "The linear mixed model results replicate the published results\n\n\nCode\nlmm1_emm &lt;- emmeans(lmm1,\n                     specs =\"genotype\",\n                     type = \"response\")\nlmm1_pairs &lt;- contrast(lmm1_emm,\n                        method =\"revpairwise\") |&gt;\n  summary(infer = TRUE)\nlmm1_pairs\n\n\n contrast  ratio    SE df lower.CL upper.CL null t.ratio p.value\n Asp / Veh  2.05 0.434  5     1.19     3.53    1   3.386  0.0195\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nTests are performed on the log scale \n\n\nThe treatment effect (“ratio”) is the geometric mean (not the mean!) of the ratios Asp/Veh. Ratios are nice for interpretation: p-PAR1 levels in the Aspartame treatment are 2.05 times the levels in the Vehicle treatment.\nThe effect (ratio of Asp/Veh), confidence interval, and p-value from the LMM are the same as in the archived table shown below.\n\n\n\nExcel table from the archived data file"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#plot-the-model",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#plot-the-model",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Plot the model!",
    "text": "Plot the model!\n\n\nCode\nlmm1_emm_dt &lt;- summary(lmm1_emm) |&gt;\n  data.table()\nlmm1_pairs_dt &lt;- lmm1_pairs |&gt;\n  data.table()\n\ngg &lt;- ggplot(data = fig3b,\n             aes(x = genotype,\n                 y = ppar1,\n                 color = genotype)) +\n  geom_jitter(width = 0.1,\n                show.legend = FALSE) +\n  geom_point(data = lmm1_emm_dt,\n                aes(x = genotype,\n                    y = response),\n                size = 3,\n                show.legend = FALSE) +\n  geom_errorbar(data = lmm1_emm_dt,\n                aes(x = genotype,\n                    y = response,\n                    ymin = lower.CL,\n                    ymax = upper.CL),\n                width = 0.05,\n                show.legend = FALSE) +\n  ylab(\"p-PAR1\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\n  # add p-values\nlmm1_pairs_dt[, group1 := \"Veh\"]\nlmm1_pairs_dt[, group2 := \"Asp\"]\nlmm1_pairs_dt[, p := p.value |&gt;\n              p_round(digits = 2) |&gt;\n              p_format(digits = 2, accuracy = 1e-04, add.p = TRUE)]\nmaxy &lt;- fig3b[, max(ppar1)]\nminy &lt;- fig3b[, min(ppar1)]\nlmm1_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]\n\ngg &lt;- gg +\n  stat_pvalue_manual(\n    data = lmm1_pairs_dt,\n    label = \"p\",\n    tip.length = 0.001)\n\ngg\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nNote the asymetric intervals! This is because the intevals were computed on the log-transformed values and then backtransformed to the scale of the response.\n\n\n\n\nCode\nsave_it &lt;- FALSE\nif(save_it){\nout_fig &lt;- \"fig3b_ggplot.png\"\nout_path &lt;- here(\"figs\", data_from, out_fig)\nggsave(out_path)\n}"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-ratio-paired-t-test",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-ratio-paired-t-test",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "The ratio paired t-test",
    "text": "The ratio paired t-test\nThe ratio paired t-test is a one-sample t-test of the log of the Asp/Veh ratios. For a null hypothesis of no effect, we expect the geometric mean of the ratios to be 1, so the log of this to be 0.\n\n\nCode\na &lt;- fig3b[genotype == \"Veh\", ppar1]\nb &lt;- fig3b[genotype == \"Asp\", ppar1]\nlog_ba &lt;- log(b/a)\nt.test(log_ba, mu = 0)\n\n\n\n    One Sample t-test\n\ndata:  log_ba\nt = 3.3863, df = 5, p-value = 0.01954\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.1727216 1.2613696\nsample estimates:\nmean of x \n0.7170456 \n\n\nThese are the same values as the archived values and the results from the linear mixed model above."
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-ratio-paired-t-test-is-just-a-paired-t-test-of-the-log-transformed-response",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#the-ratio-paired-t-test-is-just-a-paired-t-test-of-the-log-transformed-response",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "The ratio paired t-test is just a paired t-test of the log-transformed response",
    "text": "The ratio paired t-test is just a paired t-test of the log-transformed response\nThis was implied above but here are the results to verify this.\n\n\nCode\nlog_a &lt;- fig3b[genotype == \"Veh\", ppar1] |&gt;\n  log()\nlog_b &lt;- fig3b[genotype == \"Asp\", ppar1] |&gt;\n  log()\nt.test(log_b, log_a, paired = TRUE)\n\n\n\n    Paired t-test\n\ndata:  log_b and log_a\nt = 3.3863, df = 5, p-value = 0.01954\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1727216 1.2613696\nsample estimates:\nmean difference \n      0.7170456"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#a-generalized-linear-mixed-model-is-a-more-modern-way-of-analyzing-these-data",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#a-generalized-linear-mixed-model-is-a-more-modern-way-of-analyzing-these-data",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "A generalized linear mixed model is a more modern way of analyzing these data",
    "text": "A generalized linear mixed model is a more modern way of analyzing these data\nIntensity levels often have a non-Normal distribution that is characterized by a right skew and a variance that increases with the mean (you can see this even with the small sample in Fig 3b. A modern way to analyze data like this is a generalized linear model, or, since we have a RBCD, a generalized linear mixed model.\nHere, I fit a GLMM using the Gamma distribution, which is useful for continuous, positive data.\n\n\nCode\nglmm1 &lt;- glmmTMB(ppar1 ~ genotype + (1 | mouse),\n                 family = Gamma(link=\"log\"),\n                 data = fig3b)\n\nglmm1_emm &lt;- emmeans(glmm1,\n                     specs =\"genotype\",\n                     type = \"response\")\nglmm1_pairs &lt;- contrast(glmm1_emm,\n                        method =\"revpairwise\") |&gt;\n  summary(infer = TRUE)\nglmm1_pairs\n\n\n contrast  ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value\n Asp / Veh  2.05 0.398 Inf       1.4         3    1   3.715  0.0002\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nTests are performed on the log scale \n\n\nHuh. This is equivalent to the LMM/ratio paired t-test, except its an “asymptotic test”, so the p-value is optimistic and the confidence interval is narrow.\nI was expecting the effect to be the ratio of the means and not geometric mean of the ratios. This would have been the case with a GLM without the random intercept – see below, but first, here are the different means (expand the code block to see what each is)\n\n\nCode\na &lt;- fig3b[genotype == \"Veh\", ppar1]\nb &lt;- fig3b[genotype == \"Asp\", ppar1]\nmean(b)/mean(a) # ratio of means\n\n\n[1] 1.99065\n\n\nCode\nexp(log(mean(b)) - log(mean(a))) # difference of log transformed means backtransformed = \n\n\n[1] 1.99065\n\n\nCode\nexp(mean(log(b)) - mean(log(a))) # means of log transformed data backtransformed = geometric mean\n\n\n[1] 2.048372\n\n\nCode\nprod(b/a)^(1/length(b/a)) # geometric mean computation 1\n\n\n[1] 2.048372\n\n\nCode\nexp(mean(log(b/a))) # geometric mean computation 2\n\n\n[1] 2.048372\n\n\nAnd here is the GLM to show that the effect is the ratio of means\n\n\nCode\nglmm0 &lt;- glmmTMB(ppar1 ~ genotype,\n                 family = Gamma(link=\"log\"),\n                 data = fig3b)\n\nglmm0_emm &lt;- emmeans(glmm0,\n                     specs =\"genotype\",\n                     type = \"response\")\nglmm0_pairs &lt;- contrast(glmm0_emm,\n                        method =\"revpairwise\") |&gt;\n  summary(infer = TRUE)\nglmm0_pairs\n\n\n contrast  ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value\n Asp / Veh  1.99 0.702 Inf     0.998      3.97    1   1.953  0.0508\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nTests are performed on the log scale"
  },
  {
    "objectID": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#plot-the-glmm-model",
    "href": "posts/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity/The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity.html#plot-the-glmm-model",
    "title": "A LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model",
    "section": "Plot the GLMM model!",
    "text": "Plot the GLMM model!\n\n\nCode\nglmm1_emm_dt &lt;- summary(glmm1_emm) |&gt;\n  data.table()\nglmm1_pairs_dt &lt;- glmm1_pairs |&gt;\n  data.table()\n\ngg &lt;- ggplot(data = fig3b,\n             aes(x = genotype,\n                 y = ppar1,\n                 color = genotype)) +\n  geom_jitter(width = 0.1,\n                show.legend = FALSE) +\n  geom_point(data = glmm1_emm_dt,\n                aes(x = genotype,\n                    y = response),\n                size = 3,\n                show.legend = FALSE) +\n  geom_errorbar(data = glmm1_emm_dt,\n                aes(x = genotype,\n                    y = response,\n                    ymin = asymp.LCL,\n                    ymax = asymp.UCL),\n                width = 0.05,\n                show.legend = FALSE) +\n  ylab(\"p-PAR1\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\n  # add p-values\nglmm1_pairs_dt[, group1 := \"Veh\"]\nglmm1_pairs_dt[, group2 := \"Asp\"]\nglmm1_pairs_dt[, p := p.value |&gt;\n              p_round(digits = 2) |&gt;\n              p_format(digits = 2, accuracy = 1e-03, add.p = TRUE)]\nmaxy &lt;- fig3b[, max(ppar1)]\nminy &lt;- fig3b[, min(ppar1)]\nglmm1_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]\n\ngg &lt;- gg +\n  stat_pvalue_manual(\n    data = glmm1_pairs_dt,\n    label = \"p\",\n    tip.length = 0.001)\n\ngg"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "",
    "text": "Fig 3g from the article"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#vital-info",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#vital-info",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Vital info",
    "text": "Vital info\nData From: Wang, Yu, et al. “The role of somatosensory innervation of adipose tissues.” Nature 609.7927 (2022): 569-574.\nFig: 3g download data\nkey words:\nPublished methods: repeated measures ANOVA\nDesign: Randomized Split Plot Design (RSPD)\nResponse: fold-change in gene expression\nKey learning concepts: linear mixed model, random intercept, split-plot, repeated measures ANOVA\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#the-experiment",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#the-experiment",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "The experiment",
    "text": "The experiment\nTreatments\nFactor 1: tx\n\nSaline (control). In the Excel file, this is labeled “SAL”. This should result in intact sympathetic activity.\n6-OHDA (treatment). In the Excel file, this is labeled “OHDA”. This is 6-hydroxydopamine, a sympathetic neurotoxin that inhibits sympathatic activity.\n\nFactor 2: surgery\n\nCre- (control). In the Excel file, this is labeled “YFP”. This is a control for the Cre injection. This should result in an intact sensory system of fat.\nCre+ (treatment). In the Excel file, this is labeled “Cre”. This should result in an ablated sensory system of fat.\n\nBlocking or whole plot factor: ear_tag. This is the mouse ID.\nFor the tx treatment, either saline or 6-OHDA was delivered to both sides of a mouse. For the surgery treatment, one side was injected with Cre- and one with Cre+.\nThere are six response variables, each a log2 fold-change for the thermogenic and lipogenic genes:\n\nUcp1\nElovl3\nCidea\nFasn\nAcacb\nChREBPβ\n\ncomments:\n\nSplit plot design. Cre ablation of one limb under two different conditions. Each condition is a different mouse. Researchers used RMANOVA.\nuse base 2 for fold change! Yaaaay!\nAll statistical results in Excel file! Yaaaay! This should be mandatory."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#what-is-a-randomized-split-plot-design-rspd",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#what-is-a-randomized-split-plot-design-rspd",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "What is a randomized split plot design (RSPD)?",
    "text": "What is a randomized split plot design (RSPD)?\nThis is a randomized split plot design. tx (Sal or OHDA) is randomly assigned to Mouse - a mouse is the “plot”. Within a mouse, surgery (YFP or Cre) is assigned to side – this is the “subplot”. Mouse acts like a blocking factor for surgery but a completely randomized factor for tx. There is no subplot replication within a plot (mouse) so the linear mixed model (using R formula notation) is\nfc ~ tx * surgery + (1 | ear_tag)\nThe factor ear_tag is a random intercept.\nA question I had with this is, can I replicate the researcher’s results, as they used “Repeated Measures ANOVA” in GraphPad Prism. In general, I can replicate GraphPad results with a blocked design but I haven’t tried a split plot design (generally because I don’t think that I’ve found a paper with a split plot design that was analyzed in GraphPad using RM ANOVA)\nAdvantages of the linear mixed model\n\nit can handle missing data – ANOVA throws out data points if there is any value missing value within the Plot variable (here, this is mouse ear_tag)\nit is easy to handle non-normal data using generalized linear mixed models – ANOVA is for linear models only, although one can transform the response.\nit is flexible, for example it is easy to add covariates. This isn’t so important for the bench biology data that I mostly see, although it is useful for example if a response was dependent on mouse weight and we wanted to adjust for weight without using a ratio.\n\nAdvantages of the RM ANOVA model 1. It always works! LMM algorithms can fail, and not infrequently."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#setup",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#setup",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#import-and-wrangle",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#import-and-wrangle",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\nNote: there are two sets of Fig 3g data. The bottom set looks like it is the top set recentered so that the mean of the SAL-YFP treatment has is mean zero. Since the data in the figure looked centered this way, I’ll import the bottom set.\n\n\nCode\ndata_from &lt;- \"The role of somatosensory innervation of adipose tissues\"\nfile_name &lt;- \"41586_2022_5137_MOESM7_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig3g &lt;- read_excel(file_path,\n                    sheet = \"3g\",\n                    range = \"B34:K58\",\n                    col_names = TRUE) |&gt;\n  data.table() |&gt;\n  clean_names()\nfig3g[, surgery := factor(surgery, levels = c(\"YFP\", \"Cre\"))]\nfig3g[, tx := factor(tx, levels = c(\"SAL\", \"OHDA\"))]\n\n# output as clean excel file\nfileout_name &lt;- \"fig3g-SPD-The role of somatosensory innervation of adipose tissues.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig3g, fileout_path)"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#fit-the-models",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#fit-the-models",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Fit the models",
    "text": "Fit the models\nCreate a function to fit the same models to each of the six responses. This is better practice than cut and paste because its less like to leave bugs if edits are made to code. Two models are fit: lmm1 – a linear mixed model with a random intercept, aov1 – a repeated measures ANOVA model\n\n\nCode\nlmm1_fit &lt;- function(y_label){\n  # y_label is the column name of the response variable\n  r_formula &lt;- paste(y_label, \"~ tx * surgery + (1 | ear_tag)\") |&gt;\n    formula()\n  lmm1 &lt;- lmer(r_formula, data = fig3g)\n  return(lmm1)\n}\n\naov1_fit &lt;- function(y_label){\n  # y_label is the column name of the response variable\n  r_formula &lt;- paste(y_label, \"~ tx * surgery + (surgery | ear_tag)\") |&gt;\n    formula()\n  aov1 &lt;- aov_4(r_formula, data = fig3g)\n  return(aov1)\n}\n\nfig3g_lmm1 &lt;- list()\nfig3g_aov1 &lt;- list()\ny_list &lt;- c(\"ucp1\", \"elovl3\", \"cidea\", \"fasn\", \"acacb\", \"ch_reb_pb\")\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1[[y_label]] &lt;- lmm1_fit(y_label)\n  fig3g_aov1[[y_label]] &lt;- aov1_fit(y_label)\n}\n\n# get emmeans using function\n\nemmeans_out &lt;- function(m1){\n  # m1 is the fit model\n  m1_emm &lt;- emmeans(m1,\n                    specs = c(\"tx\", \"surgery\"))\n  return(m1_emm)\n}\n\nfig3g_lmm1_emm &lt;- list()\nfig3g_aov1_emm &lt;- list()\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1_emm[[y_label]] &lt;- emmeans_out(fig3g_lmm1[[y_label]])\n  fig3g_aov1_emm[[y_label]] &lt;- emmeans_out(fig3g_aov1[[y_label]])\n}\n\npairs_out &lt;- function(m1_emm){\n  # m1 is the fit model\n  m1_pairs &lt;- contrast(m1_emm,\n                       method = \"revpairwise\",\n                       simple = \"each\",\n                       combine = TRUE,\n                       adjust = \"none\") |&gt;\n  summary(infer = TRUE) |&gt;\n  data.table()\n  return(m1_pairs)\n}\n\nfig3g_lmm1_pairs &lt;- list()\nfig3g_aov1_pairs &lt;- list()\nfor(i in 1:length(y_list)){\n  y_label &lt;- y_list[i]\n  fig3g_lmm1_pairs[[y_label]] &lt;- pairs_out(fig3g_lmm1_emm[[y_label]])\n  fig3g_aov1_pairs[[y_label]] &lt;- pairs_out(fig3g_aov1_emm[[y_label]])\n}"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#compare-lmm-to-rm-anova-and-to-graphpad-output",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#compare-lmm-to-rm-anova-and-to-graphpad-output",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Compare LMM to RM ANOVA and to GraphPad output",
    "text": "Compare LMM to RM ANOVA and to GraphPad output\n\nANOVA replicates!\ntested using ucp1 only\n\n\nCode\nanova(fig3g_lmm1[[\"ucp1\"]]) |&gt;\n  kable(digits = 4,\n        caption = \"LMM fit\") |&gt;\n  kable_styling()\n\n\n\nLMM fit\n\n\n\nSum Sq\nMean Sq\nNumDF\nDenDF\nF value\nPr(&gt;F)\n\n\n\n\ntx\n24.8575\n24.8575\n1\n10\n8.3181\n0.0163\n\n\nsurgery\n31.4641\n31.4641\n1\n10\n10.5288\n0.0088\n\n\ntx:surgery\n5.2770\n5.2770\n1\n10\n1.7658\n0.2134\n\n\n\n\n\n\n\nCode\nanova(fig3g_aov1[[\"ucp1\"]]) |&gt;\n  kable(digits = 4, caption = \"RM ANOVA fit\") |&gt;\n  kable_styling()\n\n\n\nRM ANOVA fit\n\n\n\nnum Df\nden Df\nMSE\nF\nges\nPr(&gt;F)\n\n\n\n\ntx\n1\n10\n6.2148\n8.3181\n0.3597\n0.0163\n\n\nsurgery\n1\n10\n2.9884\n10.5288\n0.2548\n0.0088\n\n\ntx:surgery\n1\n10\n2.9884\n1.7658\n0.0542\n0.2134\n\n\n\n\n\n\n\n\n\n\nFig 3g ANOVA table from Excel file\n\n\nlmm1 and aov1 give the same results here because there is no missing data, which the lmm is better at handling. Both replicate the GraphPad Prism results.\n\n\nContrasts replicate!\n\n\nCode\n# create a column of sidak adjusted p-values in the contrast tables\nfor(i in 1:length(y_list)){ # over the 6 responses\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  m1_pairs[3:4, p_sidak := Sidak.p.adjust(p.value)]\n  fig3g_lmm1_pairs[[y_list[i]]] &lt;- m1_pairs\n}\n\n# make a pretty output table\ncontrast_table &lt;- data.table(NULL)\nkeep_cols &lt;- c(\"tx\", \"contrast\", \"estimate\", \"p_sidak\")\nfor(i in 1:length(y_list)){ # over the 6 responses\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  contrast_table &lt;- rbind(contrast_table,\n                          m1_pairs[3:4, .SD, .SDcols = keep_cols])\n}\n\ncontrast_table |&gt;\n  kable(digits = 4) |&gt;\n  kable_styling() |&gt;\n  pack_rows(y_list[1], 1, 2) |&gt;\n  pack_rows(y_list[2], 3, 4) |&gt;\n  pack_rows(y_list[3], 5, 6) |&gt;\n  pack_rows(y_list[4], 7, 8) |&gt;\n  pack_rows(y_list[5], 9, 10) |&gt;\n  pack_rows(y_list[6], 11, 12)\n\n\n\n\n\ntx\ncontrast\nestimate\np_sidak\n\n\n\n\nucp1\n\n\nSAL\nCre - YFP\n-3.2278\n0.0178\n\n\nOHDA\nCre - YFP\n-1.3522\n0.3684\n\n\nelovl3\n\n\nSAL\nCre - YFP\n-3.5792\n0.0083\n\n\nOHDA\nCre - YFP\n-1.5600\n0.2574\n\n\ncidea\n\n\nSAL\nCre - YFP\n-2.2268\n0.0119\n\n\nOHDA\nCre - YFP\n-0.8875\n0.3538\n\n\nfasn\n\n\nSAL\nCre - YFP\n-1.8012\n0.0060\n\n\nOHDA\nCre - YFP\n-0.6543\n0.3409\n\n\nacacb\n\n\nSAL\nCre - YFP\n-1.8589\n0.0147\n\n\nOHDA\nCre - YFP\n-0.4956\n0.6315\n\n\nch_reb_pb\n\n\nSAL\nCre - YFP\n-2.7360\n0.0069\n\n\nOHDA\nCre - YFP\n-1.3383\n0.1767\n\n\n\n\n\n\n\n\n\n\nFig 3g contrasts from the Excel file\n\n\nNotes\n\nthe direction of my contrast is Cre+ - Cre- (or, using the Excel file labels, this is Cre - YFP), since I like the direction to be what happens when you add the treatment, relative to a control.\nThe authors used a Sidak adjustment on the two simple Cre- - Cre+ contrasts only.\n\nThe contrasts replicate (other than the sign, but that is because I chose the opposite direction of the contrast)!\nI do have thoughts on the correction:\n\nThe researchers do not state why the set of adjusted p-values is 2 (the two simple effects of surgery) and not 4 (the additional two simple effects tx).\nThe holm method of adjustment is more powerful than Sidak.\nI would not adjust if I were only investigating ucp1 as the response. Each of these is a test of its own question with different expectations given working knowledge. See xxx.\nThat said, there are 6 response variables from the experiment and if our hypothesis is something like “is there some difference in gene expression given this set of genes?” then I would adjust using the FDR, as this is a question applied to the whole gene set. This is exactly the norm in gene expression studies with thousands of genes. I never see researchers adjust for multiple responses except in these large large gene expression studies (or similar). So there is inconsistency in the logic applied to the statistical analysis not just within a field but within a single paper."
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#how-i-would-adjust-adjusting-all-6-responses-using-fdr",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#how-i-would-adjust-adjusting-all-6-responses-using-fdr",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "How I would adjust: adjusting all 6 responses using FDR",
    "text": "How I would adjust: adjusting all 6 responses using FDR\n\n\nCode\n# this seems ultra klunky but it works\np &lt;- numeric(length(y_list))\nfor(j in 1:4){ # do this for each simple effect in the contrast table\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    p[i] &lt;- m1_pairs[j, p.value]\n  }\n  p_adj &lt;- p.adjust(p, \"fdr\")\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    m1_pairs[j, p_fdr := p_adj[i]]\n    fig3g_lmm1_pairs[[y_list[i]]] &lt;- m1_pairs\n  }\n}\n\n# create a table of p-values for cre contrasts only\n\nout_table &lt;- data.table(\n  response = y_list,\n  Sal_p = numeric(length(y_list)),\n  OHDA_p = numeric(length(y_list)),\n  Sal_fdr = numeric(length(y_list)),\n  OHDA_fdr = numeric(length(y_list))\n)\n  for(i in 1:length(y_list)){ # over the 6 responses\n    m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n    out_table[response == y_list[[i]], Sal_p := m1_pairs[3, p.value]]\n    out_table[response == y_list[[i]], OHDA_p:= m1_pairs[4, p.value]]\n    out_table[response == y_list[[i]], Sal_fdr := m1_pairs[3, p_fdr]]\n    out_table[response == y_list[[i]], OHDA_fdr := m1_pairs[4, p_fdr]]\n  }\n\nout_table |&gt;\n  kable(caption = \"unadjusted and FDR adjust p-values for Cre+ - Cre- contrasts within Saline and 6-OHDA treatments\") |&gt;\n  kable_styling()\n\n\n\nunadjusted and FDR adjust p-values for Cre+ - Cre- contrasts within Saline and 6-OHDA treatments\n\n\nresponse\nSal_p\nOHDA_p\nSal_fdr\nOHDA_fdr\n\n\n\n\nucp1\n0.0089590\n0.2052979\n0.0089590\n0.2463575\n\n\nelovl3\n0.0041345\n0.1382491\n0.0082690\n0.2463575\n\n\ncidea\n0.0059646\n0.1961155\n0.0088577\n0.2463575\n\n\nfasn\n0.0030145\n0.1881198\n0.0082690\n0.2463575\n\n\nacacb\n0.0073814\n0.3929358\n0.0088577\n0.3929358\n\n\nch_reb_pb\n0.0034794\n0.0926347\n0.0082690\n0.2463575"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#plotsreplicate",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#plotsreplicate",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Plots…replicate!",
    "text": "Plots…replicate!\n\n\nCode\nfig3g[, cre := ifelse(surgery == \"YFP\", \"Cre-\", \"Cre+\")]\nfig3g[, ohda := ifelse(tx == \"SAL\", \"SAL\", \"6-OHDA\")]\n\nfig3g[, treatment := paste(ohda, cre, sep = \"\\n\") |&gt;\n      factor(levels = c(\"SAL\\nCre-\", \"SAL\\nCre+\", \"6-OHDA\\nCre-\", \"6-OHDA\\nCre+\"))]\nplot_it &lt;- function(y_col,\n                    m1_pairs){\n  \n  gg &lt;- ggplot(data = fig3g,\n               aes(x = treatment,\n                   y = get(y_col))) +\n    geom_point(aes(color = surgery),\n               size = 2,\n               show.legend = FALSE) +\n    geom_line(aes(group = ear_tag),\n              color = \"gray\") +\n    ylab(\"Log 2 Fold Change\") +\n    ggtitle(y_col) +\n    scale_color_manual(values = pal_okabe_ito_2) +\n    theme_pubr() +\n    theme(axis.title.x = element_blank())\n  \n  # add p-values\n  p_table &lt;- data.table(\n    group1 = c(\"SAL\\nCre-\", \"6-OHDA\\nCre-\"),\n    group2 = c(\"SAL\\nCre+\", \"6-OHDA\\nCre+\"),\n    p = m1_pairs[3:4, p_sidak] |&gt;\n      p_round(digits = 4) |&gt; #rstatix package\n      p_format(digits = 4, #rstatix package\n                        accuracy = 1e-04,\n                        add.p = TRUE),\n    y.position = fig3g[, max(get(y_col))] + \n      0.05*(fig3g[, max(get(y_col))] - fig3g[, min(get(y_col))])\n  )\n  gg &lt;- gg +\n    stat_pvalue_manual(\n      data = p_table,\n      tip.length = 0.001)\n\n  return(gg)\n}\n\ngg_list &lt;- list()\nfor(i in 1:length(y_list)){\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  # use the sidak p-values\n  m1_pairs[, p.value := p_sidak]\n  gg &lt;- plot_it(y_col = y_list[i], m1_pairs)\n  gg_list[[y_list[i]]] &lt;- gg\n}\nplot_grid(plotlist = gg_list, nrow = 2)\n\n\n\n\n\n\n\n\n\nWhat’s going on with the direction of the effect in Fig 3g? Compare my figure with the published figure.\n\n\n\nFig 3g\n\n\nCompared to my figure built from the archived data, the data in Fig3g is reflected about the horizontal axis at y = 0, that is, the data are upside down, so the apparent direction of the differences is exactly opposite that of the archived data in the Excel file. The GraphPad prism contrasts tables in the Excel file match the archived data in the Excel file and not the plotted data. This doesn’t matter for the p-values but since directions of the differences are exactly opposite, the interpretation of the results is exactly opposite.\nSo, what’s up with the reflected (upside down) data? The matrices of archived values are \\(\\Delta C_q\\) and centered (\\(\\Delta\\Delta C_q\\)) values, which decrease as expression levels increase. We want an increase in expression to look like an increase in the y-value. So to get the effects in this meaningful direction, we can multiply the \\(\\Delta C_q\\) values by -1.\nLet’s reflect the \\(\\Delta\\Delta C_q\\) values by multiplying them by -1 and replot:\n\n\nCode\n# reflect the values in the response variables\nfig3g[, ucp1_ref := -ucp1]\nfig3g[, elovl3_ref := -elovl3]\nfig3g[, cidea_ref := -cidea]\nfig3g[, fasn_ref := -fasn]\nfig3g[, acacb_ref := -acacb]\nfig3g[, ch_reb_pb_ref := -ch_reb_pb]\n\ny_list_ref &lt;- paste0(y_list, \"_ref\")\ngg_list &lt;- list()\nfor(i in 1:length(y_list)){\n  m1_pairs &lt;- fig3g_lmm1_pairs[[y_list[i]]]\n  # use the sidak p-values\n  m1_pairs[, p.value := p_sidak]\n  gg &lt;- plot_it(y_col = y_list_ref[i], m1_pairs)\n  gg_list[[y_list[i]]] &lt;- gg\n}\nplot_grid(plotlist = gg_list, nrow = 2)\n\n\n\n\n\n\n\n\n\nOkay - this replicates the plot!\n\n\nCode\nfor(i in 1:length(y_list)){\n  m1 &lt;- fig3g_lmm1[[y_list[i]]]\n}"
  },
  {
    "objectID": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#published-methods-cut-and-pasted-from-the-article",
    "href": "posts/The role of somatosensory innervation of adipose tissues/The role of somatosensory innervation of adipose tissues.html#published-methods-cut-and-pasted-from-the-article",
    "title": "Fig 3g – The role of somatosensory innervation of adipose tissues",
    "section": "Published methods, cut and pasted from the article",
    "text": "Published methods, cut and pasted from the article\nA combination of axonal target injection of retrograde Cre and somatic expression of a Cre-dependent payload has been widely used to manipulate projection-specific circuits in the brain. However, legacy peripheral viral tracers such as pseudorabies virus and herpes simplex virus are highly toxic, restricting their use beyond acute anatomical mapping. In search for newer and safer viral vectors suitable for long-term functional manipulations, we found that AAV9 exhibited a high retrograde potential from iWAT to DRGs (Extended Data Fig. 4a). We adopted a published viral engineering pipeline22 to generate randomized mutants of AAV9 (Extended Data Fig. 4b,c). Although our initial intent was to improve retrograde efficiency from fat to DRGs, the evolved new retrograde vector optimized for organ tracing (or ROOT) is more desirable mainly for its significantly reduced off-target expression such as in SChGs, contralateral DRGs and the liver (Fig. 2a,b and Extended Data Fig. 4d–g).\nROOT provides an opportunity to specifically ablate the sensory innervation in fat—we injected Cre-dependent diphtheria toxin subunit A (DTA) construct (mCherry-flex-DTA) into the T13/L1 DRGs bilaterally while injecting Cre- or YFP-expressing ROOT unilaterally in the iWATs (Fig. 2c).\nAs thermogenic and lipogenesis programs are both downstream of sympathetic signalling24,26,29, we next tested whether the sensory-elicited gene expression changes are dependent on intact sympathetic innervation. We bilaterally injected 6-OHDA—a catecholaminergic toxin for selective sympathetic denervation (Extended Data Fig. 6c,d)—into the iWAT of mice that had previously undergone unilateral sensory ablation (Fig. 3f)."
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "",
    "text": "Better than Reproducibility of Fig 5c. The CIs and p-values are from a quasipoisson GLM model with offset"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#vital-info",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#vital-info",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Vital info",
    "text": "Vital info\nData From: Li, X., Wu, F., Günther, S., Looso, M., Kuenne, C., Zhang, T., … & Braun, T. (2023). Inhibition of fatty acid oxidation enables heart regeneration in adult mice. Nature, 622(7983), 619-626.\nFig: 2d download data\nkey words:\nPublished methods: t-test on both raw and proportion data.\nDesign: Completely Randomized Design (CRD)\nResponse: fibrotic_area (the area of the injured tissue in the heart), both raw and as a proportion of total heart area.\nKey learning concepts: proportions and offsets\nMore info: 18.4 Example 2 – Use a GLM with an offset instead of a ratio of some measurement per total (“dna damage” data fig3b)"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#the-experiment",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#the-experiment",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "The Experiment",
    "text": "The Experiment\nBackground: Postnatal maturation of cardiomyocytes is characterized by a metabolic switch from glycolysis to fatty acid oxidation, chromatin reconfiguration and exit from the cell cycle, instating a barrier for adult heart regeneration1,2. Here, to explore whether metabolic reprogramming can overcome this barrier and enable heart regeneration, we abrogate fatty acid oxidation in cardiomyocytes by inactivation of Cpt1b.\nAnalysis of RNA-sequencing (RNA-seq) datasets revealed reduced expression levels of several key genes of glycolysis and cell cycle progression in the course of CM maturation during the first week after birth, whereas genes related to fatty acid oxidation (FAO) and the Krebs cycle were upregulated (Extended Data Fig. 1a). FAO-related genes that were upregulated included the muscle-specific isoform of carnitine palmitoyltransferase Cpt1b but not the ubiquitously expressed Cpt1a isoform, which are required for mitochondrial uptake of fatty acids and subsequent FAO (Extended Data Fig. 1b).\nMotivation: To investigate whether Cpt1b inactivation and the ensuing proliferation of CMs enables heart regeneration, we subjected Cpt1bcKO and Cpt1biKO mice to ischaemia–reperfusion (I–R) injury, a model that closely mimics the situation in human patients receiving a stent for revascularization of an obstructed coronary artery. I–R-induced scars were virtually absent in Cpt1bcKO and Cpt1biKO mice after 3 weeks compared to control animals, although the area at risk (AAR) was similar in both mutant hearts 24 h after I–R surgery (Fig. 2a–f, Extended Data Fig. 5a,b and Supplementary Information)."
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#setup",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#setup",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#import-and-wrangle",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#import-and-wrangle",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"Inhibition of fatty acid oxidation enables heart regeneration in adult mice\"\nfile_name &lt;- \"41586_2023_6585_MOESM6_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\ngenotype_levels &lt;- c(\"Ctrl\", \"Cpt1biKO\")\nfig2d &lt;- read_excel(file_path,\n                    sheet = \"Fig2.d\",\n                    range = \"B1:C10\") |&gt;\n  data.table() |&gt;\n  melt(measure.vars = genotype_levels,\n       variable.name = \"genotype\",\n       value.name = \"fibrotic_area\") |&gt;\n  na.omit()\nfig2d[, genotype := factor(genotype, levels = genotype_levels)]\n\nfig2d_percent &lt;- read_excel(file_path,\n                    sheet = \"Fig2.d\",\n                    range = \"B12:C21\") |&gt;\n  data.table() |&gt;\n  melt(measure.vars = genotype_levels,\n       variable.name = \"genotype\",\n       value.name = \"percent\") |&gt;\n  na.omit()\nfig2d[, fibrotic_area_percent := fig2d_percent[, percent]]\nfig2d[, fibrotic_area_proportion := fibrotic_area_percent/100]\nfig2d[, heart_area := fibrotic_area/fibrotic_area_proportion]\n\n\nfileout_name &lt;- \"Fig2d-proportion - Inhibition of fatty acid oxidation enables heart regeneration in adult mice.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, fileout_name)\nwrite_xlsx(fig2d, fileout_path)"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#reproducibility-linear-model-t-test",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#reproducibility-linear-model-t-test",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Reproducibility – linear model / t-test",
    "text": "Reproducibility – linear model / t-test\n\n\nCode\nlm1 &lt;- lm(fibrotic_area ~ genotype, data = fig2d)\nlm1_emm &lt;- emmeans(lm1, specs = \"genotype\")\nlm1_pairs &lt;- contrast(lm1_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\n\ngg1 &lt;- plot_response(lm1, lm1_emm, lm1_pairs,\n                     y_label = \"Fibrotic Area\",\n                     palette = \"pal_okabe_ito_blue\")\n  \nlm2 &lt;- lm(fibrotic_area_percent ~ genotype, data = fig2d)\nlm2_emm &lt;- emmeans(lm2, specs = \"genotype\")\nlm2_pairs &lt;- contrast(lm2_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\n\ngg2 &lt;- plot_response(lm2, lm2_emm, lm2_pairs,\n                     y_label = \"Percent Fibrotic Area\",\n                     palette = \"pal_okabe_ito_blue\")\n\n# contrast_table &lt;- rbind(lm1_pairs, lm2_pairs)\n# contrast_table |&gt;\n#   kable(digits = 4) |&gt;\n#   kable_styling() |&gt;\n#   pack_rows(\"linear model/t-test of fibrotic area\", 1, 1) |&gt;\n#   pack_rows(\"linear model/t-test of fibrotic area as percent of total area\", 2, 2)\n\nplot_grid(gg1, gg2, ncol = 2)"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#notes-on-what-the-researchers-did",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#notes-on-what-the-researchers-did",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Notes on what the researchers did",
    "text": "Notes on what the researchers did\n\nThe researchers report a t-test of fibrotic area (left panel above). The effect size (the difference in mean fibrotic area between genotypes) is confounded by differences in heart size between genotypes. So this comparison is not very meaninful as is.\nThe researchers report a t-test of relative fibrotic area (the percent of total heart area that is fibrotic)(right panel above). Relative fibrotic area is a meaningful response but presenting this as a difference is weird as we move from near zero to near 0.5 to near 1.\nlook what the researcher’s t-tests implies about inference. Both t-tests imply the 95% CIs shown in the plots. These CIs imply mean fibrotic areas that are less then zero are consistent with the data!"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#a-glm-with-fibrotic-area-using-logheart-area-as-an-offset-variable-combines-the-two-analyses-above-into-a-single-analysis",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#a-glm-with-fibrotic-area-using-logheart-area-as-an-offset-variable-combines-the-two-analyses-above-into-a-single-analysis",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "A GLM with fibrotic area using log(heart area) as an offset variable combines the two analyses above into a single analysis!",
    "text": "A GLM with fibrotic area using log(heart area) as an offset variable combines the two analyses above into a single analysis!\nA common way to test for the effect of a treatment when the effect is confounded by a covariate is ANCOVA. For example, many researchers test for the effect of a treatment on O2 consumption and use body weight as a covariate, since O2 consupmption increases with body weight. A linear model with an offset is exactly like an a linear model with a continuous covariate (ANCOVA model) except the coefficient (slope) of the covariate is forced to be 1.\nHere is a covariate (ANCOVA) model:\n\\[\n\\texttt{log}(\\texttt{fibrotic area}) = b_0 + b_1 \\texttt{log}(\\texttt{heart area}) + b_2 \\texttt{genotype}\n\\]\nwhere \\(b_1\\) is the slope of fibrotic area on heart area (note that the model does not contain the interaction of \\(\\texttt{genotype}\\) and \\(\\texttt{heart area}\\)). If we don’t expect larger hearts to have relatively more (or less) fibrotic area, then we would expect \\(b_1 = 1\\). An offset forces this expectation.\nImportantly, if we use a GLM with log link, the model only models the log-transformed group means – not the means of the log transformed data, as in the ANCOVA model above.\n\n\nCode\nm3 &lt;- glm(fibrotic_area ~ genotype + offset(log(heart_area)),\n          family = Gamma(link = \"log\"),\n          data = fig2d)\nm3_emm &lt;- emmeans(m3, specs = \"genotype\", type = \"response\")\nm3_pairs &lt;- contrast(m3_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#what-is-the-effect-in-the-glm-model-with-offset",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#what-is-the-effect-in-the-glm-model-with-offset",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "What is the effect in the GLM model with offset?",
    "text": "What is the effect in the GLM model with offset?\nBy forcing the coefficient to be one, the effect (0.23) is the ratio of the mean proportion of the KO group to the mean proportion of the Cn group, even though we used the raw fibrotic area (and not the proportion) as the response variable! This is the beauty of the offset model!\n\n\nCode\nm3_pairs |&gt;\n  kable(digits = c(1,7,3,1,2,2,1,2,6)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\ncontrast\nratio\nSE\ndf\nlower.CL\nupper.CL\nnull\nt.ratio\np.value\n\n\n\n\nCpt1biKO / Ctrl\n0.2312978\n0.075\n14\n0.12\n0.46\n1\n-4.51\n0.000486\n\n\n\n\n\n\n\nHere is the ratio computed manually\n\n\nCode\nmean(fig2d[genotype == \"Cpt1biKO\", fibrotic_area_proportion])/mean(fig2d[genotype == \"Ctrl\", fibrotic_area_proportion])\n\n\n[1] 0.2312978"
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#plot-the-model-with-the-percent-data",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#plot-the-model-with-the-percent-data",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "Plot the model! With the percent data!",
    "text": "Plot the model! With the percent data!\nWhile fibrotic area was the response variable in our statistical model, we want to plot the model with the proportion data. This means we need to convert the estimated model means and CIs to proportions. This is easy, simply divide these values by the mean heart area, ignoring genotype levels.\n\n\nCode\nm3_emm_dt &lt;- m3_emm |&gt;\n  summary() |&gt;\n  data.table()\nm3_pairs_dt &lt;- data.table(m3_pairs)\n\ncommon_factor &lt;- mean(fig2d$heart_area)\nm3_emm_dt[, mean := response/common_factor * 100]\nm3_emm_dt[, lo := lower.CL/common_factor * 100]\nm3_emm_dt[, hi := upper.CL/common_factor * 100]\n\n\nHere is the percent fibrotic area computed from the model.\n\n\nCode\nm3_emm_dt[, .SD, .SDcols = c(\"genotype\", \"mean\")]\n\n\n   genotype     mean\n     &lt;fctr&gt;    &lt;num&gt;\n1:     Ctrl 8.127159\n2: Cpt1biKO 1.879794\n\n\nAnd here is the percent fibrotic area computed by simply averaging the percent data.\n\n\nCode\nfig2d[, .(fibrotic_area_percent = mean(fibrotic_area_percent)),\n                                by = .(genotype)]\n\n\n   genotype fibrotic_area_percent\n     &lt;fctr&gt;                 &lt;num&gt;\n1:     Ctrl              8.127159\n2: Cpt1biKO              1.879794\n\n\n\n\nCode\ngg &lt;- ggplot(data = fig2d,\n             aes(x = genotype,\n                 y = fibrotic_area_percent,\n                 color = genotype)) +\n  geom_sina(size = 2,\n            maxwidth = 0.5,\n            show.legend = FALSE) +\n  geom_errorbar(data = m3_emm_dt,\n                aes(x = genotype,\n                    y = mean,\n                    ymin = lo,\n                    ymax = hi),\n                width = 0.05,\n                color = \"black\") +\n  geom_point(data = m3_emm_dt,\n             aes(x = genotype,\n                 y = mean),\n             size = 3,\n             color = \"black\") +\n  ylab(\"Fibrotic Area (% of Heart Area)\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\n  # add p-values\nm3_pairs_dt[, group1 := \"Ctrl\"]\nm3_pairs_dt[, group2 := \"Cpt1biKO\"]\nm3_pairs_dt[, p := p.value |&gt;\n              p_round(digits = 2) |&gt;\n              p_format(digits = 2, accuracy = 1e-03, add.p = TRUE)]\nmaxy &lt;- fig2d[, max(fibrotic_area_percent)]\nminy &lt;- fig2d[, min(fibrotic_area_percent)]\nm3_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]\n\ngg &lt;- gg +\n  stat_pvalue_manual(\n    data = m3_pairs_dt,\n    label = \"p\",\n    tip.length = 0.001)\n\ngg\n\n\n\n\n\n\n\n\n\nCode\nsave_it &lt;- TRUE\nif(save_it){\nout_fig &lt;- \"fig2d_ggplot.png\"\nout_path &lt;- here(\"figs\", data_from, out_fig)\nggsave(out_path)\n}\n\n\nThis is beautiful. We don’t need two plots. The GLM with offset estimates the effect of genotype on Fibrotic Area adjusting for differences in total Heart Area. And we’ve plotted the model using the percent fibrotic area data and estimated means and CIs from the model."
  },
  {
    "objectID": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#but-is-the-glm-with-offset-any-good-a-simulation-comparing-it-to-what-the-researchers-did-or-might-have-done.",
    "href": "posts/Inhibition of fatty acid oxidation enables heart regeneration in adult mice/Inhibition of fatty acid oxidation enables heart regeneration in adult mice.html#but-is-the-glm-with-offset-any-good-a-simulation-comparing-it-to-what-the-researchers-did-or-might-have-done.",
    "title": "Models for proportion (part to whole percent) data: Part II",
    "section": "But is the GLM with offset any good? – A simulation comparing it to what the researchers did, or might have done.",
    "text": "But is the GLM with offset any good? – A simulation comparing it to what the researchers did, or might have done.\n\n\nCode\nget_clean_proportion_data &lt;- function(\n    n_sample,\n    n_cols,\n    alpha_num,\n    beta_num,\n    alpha_denom,\n    beta_denom,\n    rho_obs,\n    seed_starter){\n  rho_matrix = matrix(c(1, r_obs, r_obs, 1), nrow = 2, ncol = 2)\n  params_num &lt;- calc_theory(Dist = \"Gamma\", params = c(alpha_num, beta_num)) # fibrotic area\n  params_denom &lt;- calc_theory(Dist = \"Gamma\", params = c(alpha_denom, beta_denom)) # heart area\n  n_cols_extra &lt;- floor(n_cols * 1.2)\n  fake_y &lt;- rcorrvar(n = n_sample * n_cols_extra,\n                     k_cont = 2,\n                     method = \"Polynomial\",\n                     means = c(params_num[1], params_denom[1]), # mean\n                     vars = c(params_num[2]^2, params_denom[2]^2),\n                     skews = c(params_num[3], params_denom[3]),\n                     skurts = c(params_num[4], params_denom[4]),\n                     fifths = c(params_num[5], params_denom[5]),\n                     sixths = c(params_num[6], params_denom[6]),\n                     rho = rho_matrix,\n                     seed = seed_starter)$continuous_variables\n  exc &lt;- which(fake_y[, \"V1\"] &lt; 0)\n  if(length(exc &gt; 0)){\n    fake_y &lt;- fake_y[-exc, ]}\n  fake_y &lt;- fake_y[1:(n_sample * n_cols), ]\n  num_mat &lt;- matrix(fake_y[,\"V1\"], nrow = n_sample, ncol = n_cols)\n  denom_mat &lt;- matrix(fake_y[,\"V2\"], nrow = n_sample, ncol = n_cols)\n  prop_mat &lt;- num_mat/denom_mat\n  \n  return(list(\n    numerator = num_mat,\n    denominator = denom_mat,\n    proportion = prop_mat\n  ))\n}\n\n\n\n\nCode\n# get parameters\ndo_it &lt;- FALSE\nif(do_it){\n  iter_sets &lt;- 4\n  n_iter &lt;- 2500\n  total_iter &lt;- n_iter * iter_sets\n  # parameters\n  # sample size\n  fig2d_summary &lt;- fig2d[, .(N = .N), by = .(genotype)]\n  \n  # correlation between fibrotic area and heart area\n  fig2d[, fibrotic_area_resid := residuals(lm(fibrotic_area ~ genotype, data = fig2d))]\n  fig2d[, heart_area_resid := residuals(lm(heart_area ~ genotype, data = fig2d))]\n  r_obs &lt;- cor(fig2d$fibrotic_area_resid, fig2d$heart_area_resid)\n  # the correlation is low-ish: 0.367\n  rho_matrix = matrix(c(1, r_obs, r_obs, 1), nrow = 2, ncol = 2)\n  \n  # gamma parameters\n  # numerator -- fibrotic area\n  glm1 &lt;- glm(fibrotic_area ~ genotype,\n              family = Gamma(link = \"log\"),\n              data = fig2d)\n  glm1_emm &lt;- emmeans(glm1, specs = \"genotype\", type = \"response\") |&gt;\n    summary() |&gt;\n    data.table()\n  glm1_mu &lt;- glm1_emm[, response]\n  # make effect smaller for power\n  effect &lt;- 0.5\n  glm1_mu[2] &lt;- glm1_mu[1]*effect\n  glm1_alpha &lt;- gamma.shape(glm1)[[1]]\n  glm1_beta &lt;- glm1_alpha/glm1_mu # = rate or 1/scale\n  \n  # denominator -- heart area\n  glm2 &lt;- glm(heart_area ~ genotype,\n              family = Gamma(link = \"log\"),\n              data = fig2d)\n  glm2_emm &lt;- emmeans(glm2, specs = \"genotype\", type = \"response\") |&gt;\n    summary() |&gt;\n    data.table()\n  glm2_mu &lt;- glm2_emm[, response]\n  glm2_alpha &lt;- gamma.shape(glm2)[[1]]\n  glm2_beta &lt;- glm2_alpha/glm2_mu # = rate or 1/scale\n  \n  num_params_cn &lt;- calc_theory(Dist = \"Gamma\", params = c(glm1_alpha, glm1_beta[1])) # fibrotic area\n  denom_params_cn &lt;- calc_theory(Dist = \"Gamma\", params = c(glm2_alpha, glm2_beta[1])) # heart area\n  num_params_ko &lt;- calc_theory(Dist = \"Gamma\", params = c(glm1_alpha, glm1_beta[2])) # fibrotic area\n  denom_params_ko &lt;- calc_theory(Dist = \"Gamma\", params = c(glm2_alpha, glm2_beta[2])) # heart area\n  \n\n  fd &lt;- data.table(\n    genotype = rep(c(\"Ctrl\", \"Cpt1biKO\"), fig2d_summary$N),\n    fibrotic_area = as.numeric(NA),\n    heart_area = as.numeric(NA)\n  )\n  \n  power_matrix &lt;- matrix(nrow = total_iter, ncol = 4)\n  colnames(power_matrix) &lt;- c(\"mwu\",\"lm\", \"qb\", \"gamma\")\n  type1_matrix &lt;- matrix(nrow = total_iter, ncol = 4)\n  colnames(type1_matrix) &lt;- c(\"mwu\",\"lm\", \"qb\", \"gamma\")\n\n  seed_starter_sim &lt;- 0\n  for(iter_set in 1:iter_sets){\n    # power\n    # make effect size smaller so power &lt; 1\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_cn &lt;- get_clean_proportion_data(\n      n_sample = fig2d_summary[1, N],\n      n_cols = n_iter,\n      alpha_num = glm1_alpha,\n      beta_num = glm1_beta[1],\n      alpha_denom = glm2_alpha,\n      beta_denom = glm2_beta[1],\n      rho_obs = r_obs,\n      seed_start = seed_starter_sim)\n\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_ko &lt;- get_clean_proportion_data(\n      n_sample = fig2d_summary[2, N],\n      n_cols = n_iter,\n      alpha_num = glm1_alpha,\n      beta_num = glm1_beta[2],\n      alpha_denom = glm2_alpha,\n      beta_denom = glm2_beta[2],\n      rho_obs = r_obs,\n      seed_start = seed_starter_sim)\n    \n    fibrotic_area_mat &lt;- rbind(fake_cn[[\"numerator\"]],\n                               fake_ko[[\"numerator\"]])\n    heart_area_mat &lt;- rbind(fake_cn[[\"denominator\"]],\n                            fake_ko[[\"denominator\"]])\n    fibrotic_prop_mat &lt;- rbind(fake_cn[[\"proportion\"]],\n                               fake_ko[[\"proportion\"]])\n    \n    for(iter in 1:n_iter){\n      sim_i &lt;- n_iter*(iter_set - 1) + iter\n      # fake data\n      fd[, fibrotic_area := fibrotic_area_mat[, iter]]\n      fd[, heart_area := heart_area_mat[, iter]]\n      fd[, fibrotic_prop := fibrotic_prop_mat[, iter]]\n      \n      # Mann Whitney\n      power_matrix[sim_i, \"mwu\"] &lt;- wilcox.test(fibrotic_prop ~ genotype, data = fd)$p.value\n      \n      # lm\n      m_lm &lt;- lm(fibrotic_prop ~ genotype, data = fd)\n      power_matrix[sim_i, \"lm\"] &lt;- coef(summary(m_lm))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n      \n      # glm bin\n      m_qb &lt;- glm(fibrotic_prop ~ genotype,\n                  family = quasibinomial,\n                  data = fd)\n      power_matrix[sim_i, \"qb\"] &lt;- coef(summary(m_qb))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n      \n      # glm qp\n      m_gamma &lt;- glm(fibrotic_area ~ genotype + offset(log(heart_area)),\n                  family = Gamma(link = \"log\"),\n                  data = fd)\n      power_matrix[sim_i, \"gamma\"] &lt;- coef(summary(m_gamma))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n      \n      #       do_plot &lt;- FALSE\n      #       if(do_plot){\n      # m_gamma_emm &lt;- emmeans(m_gamma, specs = \"genotype\", type = \"response\")\n      # m_gamma_pairs &lt;- contrast(m_gamma_emm, method = \"revpairwise\") |&gt;\n      #   summary(infer = TRUE)\n      #        plot_response(m_qb, m_qb_emm, m_qb_pairs)\n              # ggplot(data = fd,\n              #        aes(x = genotype,\n              #            y = fibrotic_prop,\n              #            color = genotype)) +\n              #   geom_point()\n      #       }\n      \n    }\n    \n    # type I\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_cn &lt;- get_clean_proportion_data(\n      n_sample = fig2d_summary[1, N],\n      n_cols = n_iter,\n      alpha_num = glm1_alpha,\n      beta_num = glm1_beta[1],\n      alpha_denom = glm2_alpha,\n      beta_denom = glm2_beta[1],\n      rho_obs = r_obs,\n      seed_start = seed_starter_sim)\n\n    seed_starter_sim &lt;- seed_starter_sim + 1\n    fake_ko &lt;- get_clean_proportion_data(\n      n_sample = fig2d_summary[2, N],\n      n_cols = n_iter,\n      alpha_num = glm1_alpha,\n      beta_num = glm1_beta[1],\n      alpha_denom = glm2_alpha,\n      beta_denom = glm2_beta[1],\n      rho_obs = r_obs,\n      seed_start = seed_starter_sim)\n    \n    fibrotic_area_mat &lt;- rbind(fake_cn[[\"numerator\"]],\n                               fake_ko[[\"numerator\"]])\n    heart_area_mat &lt;- rbind(fake_cn[[\"denominator\"]],\n                            fake_ko[[\"denominator\"]])\n    fibrotic_prop_mat &lt;- rbind(fake_cn[[\"proportion\"]],\n                               fake_ko[[\"proportion\"]])\n    \n    for(iter in 1:n_iter){\n      sim_i &lt;- n_iter*(iter_set - 1) + iter\n      # fake data\n      fd[, fibrotic_area := fibrotic_area_mat[, iter]]\n      fd[, heart_area := heart_area_mat[, iter]]\n      fd[, fibrotic_prop := fibrotic_prop_mat[, iter]]\n      \n      # Mann Whitney\n      type1_matrix[sim_i, \"mwu\"] &lt;- wilcox.test(fibrotic_prop ~ genotype, data = fd)$p.value\n      \n      # lm\n      m_lm &lt;- lm(fibrotic_prop ~ genotype, data = fd)\n      type1_matrix[sim_i, \"lm\"] &lt;- coef(summary(m_lm))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n      \n      # glm bin\n      m_qb &lt;- glm(fibrotic_prop ~ genotype,\n                  family = quasibinomial,\n                  data = fd)\n      type1_matrix[sim_i, \"qb\"] &lt;- coef(summary(m_qb))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n      \n      # glm qp\n      m_gamma &lt;- glm(fibrotic_area ~ genotype + offset(log(heart_area)),\n                  family = Gamma(link = \"log\"),\n                  data = fd)\n      type1_matrix[sim_i, \"gamma\"] &lt;- coef(summary(m_gamma))[\"genotypeCtrl\", \"Pr(&gt;|t|)\"]\n\n    }    \n  }\n\n  saveRDS(power_matrix, \"power_matrix.Rds\")\n  saveRDS(type1_matrix, \"type1_matrix.Rds\")\n}else{\n  power_matrix &lt;- readRDS(\"power_matrix.Rds\")\n  type1_matrix &lt;- readRDS(\"type1_matrix.Rds\")\n}\n\npless &lt;- function(x, alpha = 0.05){\n  stat &lt;- sum(x &lt;= alpha)/length(x)\n  return(stat)\n}\n\n\n\n\nCode\nres &lt;- data.table(\n  Test = c(\"Mann-Whitney\", \"Linear Model/T-test\", \"Quasibinomial\", \"Gamma offset\"),\n  Power = apply(power_matrix, 2, pless, alpha = 0.05),\n  \"Type I\" = apply(type1_matrix, 2, pless, alpha = 0.05)\n)\nres |&gt;\n  kable(digits = c(1,2,3)) |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\nTest\nPower\nType I\n\n\n\n\nMann-Whitney\n0.71\n0.044\n\n\nLinear Model/T-test\n0.71\n0.049\n\n\nQuasibinomial\n0.75\n0.052\n\n\nGamma offset\n0.84\n0.061\n\n\n\n\n\n\n\nFor data that look like those in fig. 2d, the Gamma GLM with offset has 18% higher power than both the linear model/t-test and the Mann-Whitney U, but has a very slightly inflated Type I error."
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "",
    "text": "Fig 2s repro generated using ggplot. The technical replicates are de-emphasized by using a gray color."
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#vital-info",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#vital-info",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Vital info",
    "text": "Vital info\nData From: Osseni, Alexis, et al. “Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.” Nature Communications 13.1 (2022): 7108.\nFig: 2s download data\nkey words:\nPublished methods: Mann-Whitney U on all data\nDesign: Completely Randomized Design with Subsampling (CRDS)\nResponse: fibrotic area\nKey learning concepts: linear mixed model, random intercept, nested ANOVA\nQuick learning explanation: Nested data are measures within a discrete unit or a hierarchy of units, for example technical replicates within a tumor within a mouse.Pseudoreplication is the analysis of subsampled (technical) replicates as if they were independent measures of treatment effects. They aren’t, because technical replicates within a unit (a mouse, a culture) share causes of variation that not shared by technical replicates in other units. This is a violation of the assumption of independence of errors.\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#the-experiment",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#the-experiment",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "The experiment",
    "text": "The experiment"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#published-results",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#published-results",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Published results",
    "text": "Published results\n\n\n\nFig 2s from the article"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#setup",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#setup",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#import-and-wrangle",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#import-and-wrangle",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\"\nfile_name &lt;- \"ncomms-source-data files OSSENI et al.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nfig2s_wide &lt;- read_excel(file_path,\n                    sheet = \"Figure 2\",\n                    range = \"E138:J186\",\n                    col_names = FALSE) |&gt;\n  data.table()\nmouse_id &lt;- paste(\"mouse\", 1:6, sep = \"_\")\ntreatment_levels &lt;- c(\"MDX-Veh\", \"MDX-TubA\")\nmouse_treatment &lt;- paste(rep(treatment_levels, each = 3), mouse_id)\ncolnames(fig2s_wide) &lt;- mouse_treatment\nfig2s &lt;- melt(fig2s_wide,\n              measure.vars = mouse_treatment,\n              variable.name = \"mouse_treatment\",\n              value.name = \"fibrotic_area\") |&gt;\n  na.omit()\nfig2s[, c(\"treatment\", \"mouse_id\") := tstrsplit(mouse_treatment, \" \")]\nfig2s[, treatment := factor(treatment, levels = treatment_levels)]\n\nfile_out_name &lt;- \"fig2s-CRDS-Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, file_out_name)\nwrite_xlsx(fig2s, fileout_path)"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#fit-the-models",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#fit-the-models",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Fit the models",
    "text": "Fit the models\nThe Mann-Whitney U test used by the authors\n\n\nCode\nm0 &lt;- wilcox.test(fig2s[treatment == treatment_levels[1], fibrotic_area], fig2s[treatment == treatment_levels[2], fibrotic_area])\nm0\n\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  fig2s[treatment == treatment_levels[1], fibrotic_area] and fig2s[treatment == treatment_levels[2], fibrotic_area]\nW = 8740, p-value = 0.000204\nalternative hypothesis: true location shift is not equal to 0\n\n\nA linear mixed-model is the best practice method\n\n\nCode\nm1 &lt;- lmer(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm1_emm &lt;- emmeans(m1, specs = \"treatment\")\nm1_pairs &lt;- contrast(m1_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\nm1_pairs\n\n\n contrast               estimate     SE df lower.CL upper.CL t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0639 0.0393  4   -0.173   0.0452  -1.627  0.1792\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n\n\nA nested ANOVA is a classical method that is equivalent to the linear mixed model above when there are an equal number of technical replicates per mouse, but will be close otherwise. In general, things will rarely go wrong if one uses a nested ANOVA instead of the linear mixed-model. GraphPad Prism does nested ANOVA but not a linear mixed model.\n\n\nCode\nm2 &lt;- aov_4(fibrotic_area ~ treatment + (1 | mouse_id), data = fig2s)\nm2_emm &lt;- emmeans(m2, specs = \"treatment\")\nm2_pairs &lt;- contrast(m2_emm, method = \"revpairwise\") |&gt;\n  summary(infer = TRUE)\nm2_pairs\n\n\n contrast               estimate     SE df lower.CL upper.CL t.ratio p.value\n (MDX-TubA) - (MDX-Veh)  -0.0647 0.0395  4   -0.174   0.0449  -1.639  0.1766\n\nConfidence level used: 0.95"
  },
  {
    "objectID": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#plotting-technical-replicates",
    "href": "posts/Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation/Fig 2s Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylationtled.html#plotting-technical-replicates",
    "title": "Fig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation",
    "section": "Plotting technical replicates",
    "text": "Plotting technical replicates\nThe technical replicates are de-emphasized by using a gray color. The modeled means of each mouse are colored by treatment (these are the predicted means of the linear mixed model and not the simple mean of each mouse). The model means of each treatment are colord by treatment.\n\n\nCode\n# get estimated means from linear model\nfig2s_means &lt;- fig2s[, .(fibrotic_area = mean(fibrotic_area)), by = .(treatment, mouse_id)]\nfig2s_means[, fibrotic_area_model := predict(m1, fig2s_means)]\nm1_emm_dt &lt;- m1_emm |&gt;\n  summary() |&gt;\n  data.table()\nm1_pairs_dt &lt;- m1_pairs |&gt;\n  data.table()\ngg &lt;- ggplot(data = fig2s,\n             aes(x = treatment,\n                 y = fibrotic_area)) +\n  # technical reps\n  geom_jitter(color = \"gray\",\n              width = 0.2) +\n  geom_jitter(data = fig2s_means,\n              aes(x = treatment,\n                  y = fibrotic_area_model,\n                  color = treatment),\n              size = 3,\n              width = 0.1,\n              show.legend = FALSE) +\n  # mean and error\n  geom_point(data = m1_emm_dt,\n             aes(x = treatment,\n                 y = emmean,\n                 color = treatment),\n             size = 5,\n             show.legend = FALSE) +\n  geom_errorbar(data = m1_emm_dt,\n                aes(x = treatment, \n                    y = emmean,\n                    ymin = lower.CL, ymax = upper.CL,\n                    color = treatment),\n                width = 0.05,\n                show.legend = FALSE) +\n  ylab(\"Fibrotic Area\") +\n  scale_color_manual(values = pal_okabe_ito_2) +\n  theme_pubr() +\n  theme(axis.title.x = element_blank()) +\n  NULL\n\n  # add p-values\nm1_pairs_dt[, group1 := \"MDX-TubA\"]\nm1_pairs_dt[, group2 := \"MDX-Veh\"]\nm1_pairs_dt[, p := p.value |&gt;\n              p_round(digits = 2) |&gt;\n              p_format(digits = 2, accuracy = 1e-04, add.p = TRUE)]\nmaxy &lt;- fig2s[, max(fibrotic_area)]\nminy &lt;- fig2s[, min(fibrotic_area)]\nm1_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]\n\ngg &lt;- gg +\n  stat_pvalue_manual(\n    data = m1_pairs_dt,\n    label = \"p\",\n    tip.length = 0.001)\n\ngg\n\n\n\n\n\n\n\n\n\n\n\nCode\nsave_it &lt;- FALSE\nif(save_it){\nout_fig &lt;- \"fig2s_ggplot.png\"\nout_path &lt;- here(\"figs\", data_from, out_fig)\nggsave(out_path)\n}"
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html",
    "title": "Hot take: don’t adjust p-values",
    "section": "",
    "text": "(A) Reproduced published plot using ANOVA model. Note the modeled CIs imply negative counts and absurd variances. (B) Better-than-reproduced plot using NB-GLM modeled CIs that don’t dip below zero and reflect true variance among groups."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#vital-info",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#vital-info",
    "title": "Hot take: don’t adjust p-values",
    "section": "Vital info",
    "text": "Vital info\nData From: Cai, Q., Sahu, R., Ueberschlag-Pitiot, V., Souali-Crespo, S., Charvet, C., Silem, I., … & Duteil, D. (2024). LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice. Nature Communications, 15(1), 3563.\nFig: 7d download data\nkey words:\nPublished methods: one-way ANOVA with Tukey adjustment\nDesign: Completely Randomized Design with subsampling (CRDS)\nResponse: mRNA level\nKey learning concepts: not adjusting for multiple p-values, CIs that go below zero\nMore info: Chapter 16 Models for non-independence – linear mixed models"
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#the-experiment",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#the-experiment",
    "title": "Hot take: don’t adjust p-values",
    "section": "The Experiment",
    "text": "The Experiment\nDexamethasone (DEX) is a synthetic glucocortacoid hormone used to treat inflammation and chronic autoimmune diseases but it also stimulates muscle atrophy. The authors are investigating the role of interactions between Lysine-specific demethylase 1 (LSD1) and the glucocortacoid recepter (GCR) in the development of muscle atrophy.\nEarlier experiments presented in the paper show evidence that atrophy is mediated by a LSD1/GCR complex that regulates genes related to atrophy and other pathways. For this experiment, mice were treated with a combination of DEX and the LSD1-specific inhibitor CC-90011. Here the researchers are looking at the effect of the different treatment combinations on RNA expression of genes related to the ubiquitin-proteasome system (Fbxo32, Trim63) and the autophagy system (Atg7, Becn1, Bnip3).\nTreatment levels\n\nVehicle (Dex-/CC-) Expected to have low levels of target gene expression\nDex (Dex+/CC-) Positive control. Expected to have elevated levels of target gene expression relative to vehicle\nCC (Dex-/CC+) Important negative control. We expect this to be similar to Vehicle. If it is not, we need the interaction.\nDEX+CC (Dex+/CC+) If LSD1 works with the GCR as expected, then we expect these levels to be lower than Dex+/CC- but how much depends on CC concentration.\n\nAnalysis Flag: The data are two technical replicates per mouse, so all inference will be a little optimistic. The mouse ID was not archived so I cannot better-than-reproduce the results."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#setup",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#setup",
    "title": "Hot take: don’t adjust p-values",
    "section": "Setup",
    "text": "Setup"
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#import-and-wrangle",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#import-and-wrangle",
    "title": "Hot take: don’t adjust p-values",
    "section": "Import and Wrangle",
    "text": "Import and Wrangle\n\n\nCode\ndata_from &lt;- \"LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice\"\nfile_name &lt;- \"41467_2024_47846_MOESM4_ESM.xlsx\"\nfile_path &lt;- here(data_folder, data_from, file_name)\n\nread7d &lt;- function(range_val = \"B3:E13\", label_val = \"Fbxo32\"){\n  fig7d_part &lt;- read_excel(file_path,\n                    sheet = \"Fig. 7d\",\n                    range = range_val,\n                    col_names = TRUE) |&gt;\n  data.table() |&gt;\n    melt(variable.name = \"excel_label\", value.name = \"y\")\n  # un-normalize count by multiplying by 10^6\n  fig7d_part[, y := as.integer(y * 10^6)]\n  setnames(fig7d_part, old = \"y\", new = label_val)\n  fig7d_part[, mouse_id := paste0(\"mouse_\", .I)]\n  return(fig7d_part)\n}\nfig7d &lt;- read7d(range_val = \"B3:E13\", label_val = \"Fbxo32\")\nfig7d &lt;- merge(fig7d,\n               read7d(range_val = \"B16:E26\", label_val = \"Trim63\"),\n               by = c(\"excel_label\", \"mouse_id\"))\nfig7d &lt;- merge(fig7d,\n               read7d(range_val = \"B29:E39\", label_val = \"Atg7\"),\n               by = c(\"excel_label\", \"mouse_id\"))\nfig7d &lt;- merge(fig7d,\n               read7d(range_val = \"B42:E52\", label_val = \"Becn1\"),\n               by = c(\"excel_label\", \"mouse_id\"))\nfig7d &lt;- merge(fig7d,\n               read7d(range_val = \"B55:E65\", label_val = \"Bnip3\"),\n               by = c(\"excel_label\", \"mouse_id\"))\n\n# remove the missing count\nfig7d &lt;- na.omit(fig7d)\n\n# better treatment labels than in excel file\nfig7d[excel_label == \"Ctrl Oil\", treatment := \"Vehicle\"]\nfig7d[excel_label == \"DEX\", treatment := \"DEX\"]\nfig7d[excel_label == \"DEX+CC-90011\", treatment := \"DEX+CC\"]\nfig7d[excel_label == \"CC-90011\", treatment := \"CC\"]\nfig7d[, treatment := factor(treatment, levels = unique(fig7d$treatment))]\n\n# split treatment into two factors\nfig7d[treatment == \"Vehicle\", dex := \"Dex_neg\"]\nfig7d[treatment == \"Vehicle\", cc := \"CC_neg\"]\nfig7d[treatment == \"DEX\", dex := \"Dex_pos\"]\nfig7d[treatment == \"DEX\", cc := \"CC_neg\"]\nfig7d[treatment == \"DEX+CC\", dex := \"Dex_pos\"]\nfig7d[treatment == \"DEX+CC\", cc := \"CC_pos\"]\nfig7d[treatment == \"CC\", dex := \"Dex_neg\"]\nfig7d[treatment == \"CC\", cc := \"CC_pos\"]\n\nfig7d[, dex := factor(dex, levels = c(\"Dex_neg\", \"Dex_pos\"))]\nfig7d[, cc := factor(cc, levels = c(\"CC_neg\", \"CC_pos\"))]\n\n\nfile_out_name &lt;- \"LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.xlsx\"\nfileout_path &lt;- here(data_folder, data_from, file_out_name)\nwrite_xlsx(fig7d, fileout_path)"
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#does-the-unstandardization-matter",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#does-the-unstandardization-matter",
    "title": "Hot take: don’t adjust p-values",
    "section": "Does the unstandardization matter",
    "text": "Does the unstandardization matter\n\n\nCode\nFbxo32_4 &lt;- fig7d[, Fbxo32]/10^6 * 10^4\nm1 &lt;- lm(Fbxo32 ~ treatment, data = fig7d)\nm2 &lt;- lm(Fbxo32_4 ~ treatment, data = fig7d)\ncoef(summary(m1))\n\n\n                 Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept)      999999.5   744928.5 1.3424101 1.881059e-01\ntreatmentDEX    5499807.1  1053487.9 5.2205695 8.229828e-06\ntreatmentDEX+CC 2310044.2  1053487.9 2.1927581 3.506200e-02\ntreatmentCC      127648.4  1082356.0 0.1179357 9.067929e-01\n\n\nCode\ncoef(summary(m2))\n\n\n                 Estimate Std. Error   t value     Pr(&gt;|t|)\n(Intercept)      9999.995   7449.285 1.3424101 1.881059e-01\ntreatmentDEX    54998.071  10534.879 5.2205695 8.229828e-06\ntreatmentDEX+CC 23100.442  10534.879 2.1927581 3.506200e-02\ntreatmentCC      1276.484  10823.560 0.1179357 9.067929e-01\n\n\n\n\nCode\nm1 &lt;- lm(Fbxo32 ~ treatment, data = fig7d)"
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#the-reported-p-values-are-conservative-a-bit-on-the-multiple-testing-problem-or-not",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#the-reported-p-values-are-conservative-a-bit-on-the-multiple-testing-problem-or-not",
    "title": "Hot take: don’t adjust p-values",
    "section": "The reported p-values are conservative (a bit on the “multiple testing” problem), or not!",
    "text": "The reported p-values are conservative (a bit on the “multiple testing” problem), or not!\nThe researchers reported Tukey-adjusted p-values. The Tukey method adjusts for the number of tests in a “family” of tests, where a family is the set of tests that answer one question. The researchers follow the norm in bench bio and choose the whole set of six contrasts as the family. This would answer a question such as: “if we were to create these combinations, would we find any difference between at least on pair?”, which isn’t a very interesting question.\nThe researchers are focused on a much more specific question and at least two more questions, both related to controls:\n\nFamily 1: Is there evidence that CC attenuates DEX-induced expression? There is only one test in this family: DEX+CC - DEXI. This is the focal family.\nFamily 2: Is there evidence that DEX increase expression levels, as expected? This is the “positive control” family. There is only one test in this family: DEX - Vehicle.\nFamily 3: What is the effect of CC alone? This is “negative control” family. Without DEX-induced elevated express, we would expect this response to be similar to Vehicle. There is only one test in this family: CC - Vehicle.\n\nWhat about the interaction effect? The contrast (DEX+CC - DEX) is the focal contrast if there is no effect of CC alone. We could look at the CC alone effect (CC - Vehicle) and if it is sufficiently small, use (DEX+CC - DEX) as the focal contrast. Of course “sufficiently small” has a subjective bright line. The statistically correct way to address this is to compare the effect of CC with DEX (the focal contrast) to the effect of CC without DEX (CC - Vehicle). This comparison is the interaction effect. So we’ll add the interaction contrast as a 4th family, which we should think of as replacing the focal contrast (Family 1) and not “in addition to” the three families. But, I’ll compute both. Regardless, for these data, I think most researchers would agree that CC - Vehicle is sufficiently small that we can use the DEX+CC - DEX comparison without issue.\nSo we have three p-values that we care about and each is from a different family, so there is no justification for p-value adjustment for multiple tests. This would make the reported p-values conservative. In general, if I wanted to be more conservative, in order to avoid research time and waste, I’d simply make my “alpha” smaller, such as 0.01 or 0.005 instead of using more conservative tests like a Tukey p-value adjustment, since the conservative alpha doesn’t depend on things like number of tests in a family.\n\n\nCode\n# the researcher's analysis\nm0 &lt;- lm(Fbxo32 ~ treatment, data = fig7d)\nm0_emm &lt;- emmeans(m0, c(\"treatment\"))\nm0_pairs &lt;- contrast(m0_emm,\n                     method = \"revpairwise\",\n                     adjust = \"tukey\") |&gt;\n  summary(infer = TRUE)\n\n# the analysis only comparing the families of tests that we care about\nveh = c(1, 0, 0, 0)\ndex = c(0, 1, 0, 0)\ndex_cc = c(0, 0, 1, 0) # note the wonky ordering in fig 7d\ncc = c(0,0,0,1)\nfocal_contrasts = list(\n  \"DEX - Vehicle\" = dex - veh,\n  \"CC - Vehicle\" = cc - veh,\n  \"DEX+CC - DEX\" = dex_cc - dex,\n  \"interaction\" = (dex_cc - dex) - (cc - veh)\n)\nm1 &lt;- lm(Fbxo32 ~ treatment, data = fig7d)\nm1_emm &lt;- emmeans(m1, c(\"treatment\"))\nm1_pairs &lt;- contrast(m1_emm,\n                     method = focal_contrasts,\n                     adjust = \"none\") |&gt;\n  summary(infer = TRUE)\n\ncontrast_table &lt;-\n  rbind(m0_pairs, m1_pairs)\ncontrast_table |&gt;\n  kable(digits = 4) |&gt;\n  kable_styling() |&gt;\n  pack_rows(\"Adjusted\", 1, 6) |&gt;\n  pack_rows(\"Non-adjusted\", 7, 10)\n\n\n\n\n\ncontrast\nestimate\nSE\ndf\nlower.CL\nupper.CL\nt.ratio\np.value\n\n\n\n\nAdjusted\n\n\nDEX - Vehicle\n5499807.1\n1053488\n35\n2658652.5\n8340961.7\n5.2206\n0.0000\n\n\n(DEX+CC) - Vehicle\n2310044.2\n1053488\n35\n-531110.4\n5151198.8\n2.1928\n0.1452\n\n\n(DEX+CC) - DEX\n-3189762.9\n1053488\n35\n-6030917.5\n-348608.3\n-3.0278\n0.0228\n\n\nCC - Vehicle\n127648.4\n1082356\n35\n-2791360.5\n3046657.2\n0.1179\n0.9994\n\n\nCC - DEX\n-5372158.7\n1082356\n35\n-8291167.6\n-2453149.9\n-4.9634\n0.0001\n\n\nCC - (DEX+CC)\n-2182395.8\n1082356\n35\n-5101404.7\n736613.0\n-2.0163\n0.2015\n\n\nNon-adjusted\n\n\nDEX - Vehicle\n5499807.1\n1053488\n35\n3361112.9\n7638501.3\n5.2206\n0.0000\n\n\nCC - Vehicle\n127648.4\n1082356\n35\n-2069651.1\n2324947.8\n0.1179\n0.9068\n\n\nDEX+CC - DEX\n-3189762.9\n1053488\n35\n-5328457.1\n-1051068.7\n-3.0278\n0.0046\n\n\ninteraction\n-3317411.3\n1510408\n35\n-6383701.9\n-251120.7\n-2.1964\n0.0348\n\n\n\n\n\n\n\nThe top table contains the six Tukey-adjusted p-values reported by the researchers. The bottom table contains the unadjusted values of only the contrasts of interest. The adjusted p-value for the focal contrast DEX+CC - DEX is 0.023 while the unadjusted value is 0.0046.\nThe p-value of the interaction is 0.035 – note that it’s effect size is very similar to that of the DEX+CC - DEX but the p-value is bigger because the SE of an interaction is bigger than the SE of a main contrast (because the interaction is a function of 4 means and not just 2). Using the interaction p-value is not just statistically correct, it is more conservative."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#fig7d-is-a-good-example-of-how-a-linearanova-model-for-count-data-often-implies-silly-confidence-intervals",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#fig7d-is-a-good-example-of-how-a-linearanova-model-for-count-data-often-implies-silly-confidence-intervals",
    "title": "Hot take: don’t adjust p-values",
    "section": "Fig7d is a good example of how a linear/ANOVA model for count data often implies silly confidence intervals",
    "text": "Fig7d is a good example of how a linear/ANOVA model for count data often implies silly confidence intervals\n\n\nCode\ngg1 &lt;- plot_response(m1,\n              m1_emm,\n              m1_pairs[1:3,],\n              palette = \"pal_okabe_ito_blue\",\n#              x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"),\n              NULL)\n\nm2 &lt;- glm.nb(Fbxo32 ~ treatment, data = fig7d)\nm2_emm &lt;- emmeans(m2, c(\"treatment\"), type = \"response\")\nm2_pairs &lt;- contrast(m2_emm,\n                     method = focal_contrasts,\n                     adjust = \"none\") |&gt;\n  summary(infer = TRUE)\n\nm2_pairs &lt;- m2_pairs[, -7]\ngg2 &lt;- plot_response(m2,\n              m2_emm,\n              m2_pairs[1:3,],\n              palette = \"pal_okabe_ito_blue\",\n#              x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"),\n              NULL)\nplot_grid(gg1, gg2, ncol = 2, labels = \"AUTO\")\n\n\n\n\n\n\n\n\n\nCode\nsave_it &lt;- FALSE\nif(save_it){\n  out_fig &lt;- \"fig7d_ggplot.png\"\n  out_path &lt;- here(\"figs\", data_from, out_fig)\n  ggsave(out_path)\n}\n\n\nThe two plots above are the estimated means and 95% CIs from the linear/ANOVA model (A) and a negative-binomial Generalized Linear Model (B). The linear/ANOVA model implies two absurd things about the confidence of the means of the groups\n\nHomogeneity of variances – remember, equal variance among treatment levels is an assumption of a linear/ANOVA model, so the model standard error of the mean of a group is a function only of the group sample size. The modeled SEs/CIs are too big for the groups with small mean counts and too small for the groups with large mean counts.\nValues below zero. A good way to think about a CI is, values within a confidence interval are reasonably plausible values for the group mean. The CIs of Vehicle and CC imply that negative means are “reasonably plausible” values, which is absurd, counts cannot be negative.\n\nBy contrast, the CIs from the GLM more accurately model the data.\n\nThe modeled CIs vary among the groups and look much more like the sampled CIs. In a negative-binomial GLM, the model standard error of the mean of a group is a function of the sample size and the mean of the group – groups with larger means have larger variances/standard errors. It’s easy to see this phenomenon with these data; the spread of points for DEX is much more than that for Vehicle, but the linear/ANOVA model CIs do not model this.\nthe CIs are asymmetric, the upper bound is further from the mean than the lower bound. Again, this reflects the skew of the data.\nthe CIs do not (and cannot) dip below zero.\n\nWe don’t see figures like Panel A above because researchers plot sample SEs and not modeled SEs – the SE actually used to compute the p-value. So “inference from the plot” is inconsistent with the p-value. This is why researchers should plot the model (modeled SE/CI) and not the data (sampled SE/CI)."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#a-bit-more-about-generalized-linear-models-glm",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#a-bit-more-about-generalized-linear-models-glm",
    "title": "Hot take: don’t adjust p-values",
    "section": "A bit more about Generalized Linear Models (GLM)",
    "text": "A bit more about Generalized Linear Models (GLM)\nCount data in biology often have a distribution that nicely approximates a sample from a Negative Binomial or a Quasipoisson distribution. Two features of count data that violate assumptions of a linear/ANOVA model are\n\nHomeogeneity of variance – the variance of the response is proportional to the mean of the group, so groups with a higher mean count have higher variances\nNormal – counts are right skewed, that is, there is a high density of low counts and a low density of high counts\n\nGeneralized Linear Models (GLM) were developed to compute confidence intervals and p-values for counts and other kinds of data with non-normal distributions."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#for-these-data-the-linearanova-model-has-more-power-than-a-negative-binomial-glm",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#for-these-data-the-linearanova-model-has-more-power-than-a-negative-binomial-glm",
    "title": "Hot take: don’t adjust p-values",
    "section": "For these data, the Linear/ANOVA model has more power than a Negative-Binomial GLM",
    "text": "For these data, the Linear/ANOVA model has more power than a Negative-Binomial GLM\nDespite the violations, tests from linear/ANOVA models that give a p-value often have good long-run performance, that is, they have relatively high power and controlled type I error Ives 2015. GLM models for count data can have higher power than a linear/ANOVA model, but this sometimes requires some more sophisticated methods such as bootstrap resampling Warton et al. 2016.\nHere I use a simulation to compare the Type I error and Power of the 1) Linear/ANOVA model, 2) a Negative Binomial GLM, and 3) a quasipoisson GLM for data that look like those in Figure 7d. I explicitly simulate the Trim63 response with the same unbalanced data as in the experiment (the CC group only has 9 measures and not 10).\n\n\nCode\n# get parameters\ndo_it &lt;- FALSE\nif(do_it){\n  data_params &lt;- fig7d[, .(mean = mean(Trim63),\n                           N = .N), by = \"treatment\"]\n  mu &lt;- rep(data_params$mean, data_params$N)\n  N &lt;- sum(data_params$N)\n  m1 &lt;- glm.nb(Trim63 ~ dex * cc, data = fig7d)\n  theta_sim &lt;- m1$theta\n  \n  n_sim &lt;- 2000\n  fd &lt;- data.table(\n    treatment = rep(c(\"veh\", \"dex\", \"dex_cc\", \"cc\"), data_params$N),\n    dex = rep(c(\"no_dex\", \"dex\", \"dex\", \"no_dex\"), data_params$N),\n    cc = rep(c(\"no_cc\", \"no_cc\", \"cc\", \"cc\"), data_params$N),\n    Trim63 = as.numeric(NA)\n  )\n  \n  # power\n  power_matrix &lt;- matrix(nrow = n_sim, ncol = 6)\n  colnames(power_matrix) &lt;- c(\"lm_focal\", \"lm_ixn\", \"nb_focal\", \"nb_ixn\", \"qp_focal\", \"qp_ixn\")\n  for(sim_i in 1:n_sim){\n    # fake data\n    fd[, Trim63 := rnegbin(N, mu, theta_sim)]\n    \n    # lm/ANOVA\n    m_lm &lt;- lm(Trim63 ~ dex * cc, data = fd)\n    power_matrix[sim_i, \"lm_ixn\"] &lt;- coef(summary(m_lm))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|t|)\"]\n    m_lm_pairs &lt;- emmeans(m_lm, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    power_matrix[sim_i, \"lm_focal\"] &lt;- m_lm_pairs[3, \"p.value\"] # effect of CC when dex is present\n    \n    # glm neg bin\n    m_nb &lt;- glm.nb(Trim63 ~ dex * cc, data = fd)\n    power_matrix[sim_i, \"nb_ixn\"] &lt;- coef(summary(m_nb))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|z|)\"]\n    m_nb_pairs &lt;- emmeans(m_nb, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    power_matrix[sim_i, \"nb_focal\"] &lt;- m_nb_pairs[3, \"p.value\"] # effect of CC when dex is present\n    \n    # glm quasipoisson\n    m_qp &lt;- glm(Trim63 ~ dex * cc,\n                family = quasipoisson(link = \"log\"),\n                data = fd)\n    power_matrix[sim_i, \"qp_ixn\"] &lt;- coef(summary(m_qp))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|t|)\"]\n    m_qp_pairs &lt;- emmeans(m_qp, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    power_matrix[sim_i, \"qp_focal\"] &lt;- m_qp_pairs[3, \"p.value\"] # effect of CC when dex is present\n\n  }\n  \n  \n  # type I\n  type1_matrix &lt;- matrix(nrow = n_sim, ncol = 6)\n  colnames(type1_matrix) &lt;- c(\"lm_focal\", \"lm_ixn\", \"nb_focal\", \"nb_ixn\", \"qp_focal\", \"qp_ixn\")\n\n  for(sim_i in 1:n_sim){\n    # fake data\n    fd[, Trim63 := rnegbin(N, mu[1], theta_sim)]\n    \n    # lm/ANOVA\n    m_lm &lt;- lm(Trim63 ~ dex * cc, data = fd)\n    type1_matrix[sim_i, \"lm_ixn\"] &lt;- coef(summary(m_lm))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|t|)\"]\n    m_lm_pairs &lt;- emmeans(m_lm, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    type1_matrix[sim_i, \"lm_focal\"] &lt;- m_lm_pairs[3, \"p.value\"] # effect of CC when dex is present\n    \n    # glm neg bin\n    m_nb &lt;- glm.nb(Trim63 ~ dex * cc, data = fd)\n    type1_matrix[sim_i, \"nb_ixn\"] &lt;- coef(summary(m_nb))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|z|)\"]\n    m_nb_pairs &lt;- emmeans(m_nb, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    type1_matrix[sim_i, \"nb_focal\"] &lt;- m_nb_pairs[3, \"p.value\"] # effect of CC when dex is present\n    \n    # glm quasipoisson\n    m_qp &lt;- glm(Trim63 ~ dex * cc,\n                family = quasipoisson(link = \"log\"),\n                data = fd)\n    type1_matrix[sim_i, \"qp_ixn\"] &lt;- coef(summary(m_qp))[\"dexno_dex:ccno_cc\", \"Pr(&gt;|t|)\"]\n    m_qp_pairs &lt;- emmeans(m_qp, specs = c(\"dex\", \"cc\")) |&gt;\n      contrast(method = \"revpairwise\", simple = \"each\", combine = TRUE, adjust = \"none\") |&gt;\n      summary(infer = TRUE)\n    type1_matrix[sim_i, \"qp_focal\"] &lt;- m_qp_pairs[3, \"p.value\"] # effect of CC when dex is present\n  }\n  saveRDS(power_matrix, \"power_matrix.Rds\")\n  saveRDS(type1_matrix, \"type1_matrix.Rds\")\n}else{\n  power_matrix &lt;- readRDS(\"power_matrix.Rds\")\n  type1_matrix &lt;- readRDS(\"type1_matrix.Rds\")\n}\n\npless &lt;- function(x){\n  stat &lt;- sum(x &lt; 0.05)/length(x)\n  return(stat)\n}\n\nres &lt;- data.table(\n  Test = c(\"LM: DEX+CC - DEX\", \"LM: Interaction\",\n           \"GLM-NB: DEX+CC - DEX\", \"GLM-NB: Interaction\",\n           \"GLM-QP: DEX+CC - DEX\", \"GLM-QP: Interaction\"),\n  Power = apply(power_matrix, 2, pless),\n  \"Type I\" = apply(type1_matrix, 2, pless)\n)\nres |&gt;\n  kable() |&gt;\n  kable_styling(full_width = FALSE)\n\n\n\n\n\nTest\nPower\nType I\n\n\n\n\nLM: DEX+CC - DEX\n0.8120\n0.0520\n\n\nLM: Interaction\n0.6930\n0.0475\n\n\nGLM-NB: DEX+CC - DEX\n0.7340\n0.0745\n\n\nGLM-NB: Interaction\n0.6970\n0.0685\n\n\nGLM-QP: DEX+CC - DEX\n0.7935\n0.0575\n\n\nGLM-QP: Interaction\n0.5595\n0.0490\n\n\n\n\n\n\n\nCurious. The linear model with an untransformed response has better Type I control and slightly more power than a negative binomial GLM.\nThat said, I really like the GLM for two reasons:\n\nThe effect is a multiple of the reference, which is a really meaningful way of comparing responses (for example, looking at the table below, the effect is 6.5, meaning the expression level is 6.5 times larger than that of Vehicle)\nThe CIs of the means are asymmetric, which reflects the skewed distribution of the data. This also avoids absurd CIs such as a negative lower bound (counts can’t be negative!)."
  },
  {
    "objectID": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#lets-plot-the-model-for-all-genes",
    "href": "posts/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice/LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.html#lets-plot-the-model-for-all-genes",
    "title": "Hot take: don’t adjust p-values",
    "section": "Let’s plot the model for all genes",
    "text": "Let’s plot the model for all genes\n\n\nCode\nget_model_result &lt;- function(gene_i){\n  model_formula &lt;- paste(gene_i, \"~ treatment\") |&gt;\n    as.formula()\n  m1 &lt;- glm.nb(model_formula, data = fig7d)\n  m1_emm &lt;- emmeans(m1, specs = c(\"treatment\"), type = \"response\")\n  m1_pairs &lt;- contrast(m1_emm,\n                       method = focal_contrasts,\n                       adjust = \"none\") |&gt;\n    summary(infer = TRUE)\n  return(list(m1 = m1, m1_emm = m1_emm, m1_pairs = m1_pairs))\n}\n\nres1 &lt;- get_model_result(\"Fbxo32\")\ngg1 &lt;- plot_response(res1$m1, res1$m1_emm, res1$m1_pairs[c(1,3,2),], palette = \"pal_okabe_ito_blue\",\n                     x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"))\nres2 &lt;- get_model_result(\"Trim63\")\ngg2 &lt;- plot_response(res2$m1, res2$m1_emm, res2$m1_pairs[c(1,3,2),], palette = \"pal_okabe_ito_blue\",\n                     x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"))\nres3 &lt;- get_model_result(\"Atg7\")\ngg3 &lt;- plot_response(res3$m1, res3$m1_emm, res3$m1_pairs[c(1,3,2),], palette = \"pal_okabe_ito_blue\",\n                     x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"))\nres4 &lt;- get_model_result(\"Becn1\")\ngg4 &lt;- plot_response(res4$m1, res4$m1_emm, res4$m1_pairs[c(1,3,2),], palette = \"pal_okabe_ito_blue\",\n                     x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"))\nres5 &lt;- get_model_result(\"Bnip3\")\ngg5 &lt;- plot_response(res5$m1, res5$m1_emm, res5$m1_pairs[c(1,3,2),], palette = \"pal_okabe_ito_blue\",\n                     x_axis_labels = c(\"DEX-\\nCC-\", \"DEX+\\nCC-\", \"DEX+\\nCC+\", \"DEX-\\nCC+\"))\n\nplot_grid(gg1, gg2, gg3, gg4, gg5, nrow = 3)\n\n\n\n\n\n\n\n\n\nCode\n# gg1\n# gg2\n# gg3\n# gg4\n# gg5"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Data From",
    "section": "",
    "text": "Models for proportion (part to whole percent) data: Part II\n\n\nData From Fig 2d – Inhibition of fatty acid oxidation enables heart regeneration in adult mice\n\n\n\npercents\n\n\nproportions\n\n\ngeneralized linear model\n\n\noffset\n\n\npower\n\n\nsimulation\n\n\n\nThe researchers present two tests/plots: the effect of genotype on fibrotic area and the effect on the percent of fibrotic area, relative to total heart area. A GLM with offset combines these into a single analysis/plot and has more power than the linear model/t-test or Mann-Whitney U.\n\n\n\n\n\nJul 11, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nModels for proportion (part to whole percent) data\n\n\nData From Fig 5c – CTLA-4-expressing ILC3s restrain interleukin-23-mediated inflammation\n\n\n\npercents\n\n\nproportions\n\n\ngeneralized linear model\n\n\noffset\n\n\npower\n\n\nsimulation\n\n\n\nThe data in fig 5c are the percent of a cell subtype relative to all cells of a type, which is a common response variable in bench biology. The researchers analyzed this part-to-whole (a proportion) response with a Mann-Whitney U test. A better practice method is a GLM of the count of the part using the count of the whole as an offset. The effect is the ratio of the treatment proportion relative to the control proportion. This post also shows how to plot the proportion with estimated means and CIs from the GLM with offset model.\n\n\n\n\n\nJul 5, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nHot take: don’t adjust p-values\n\n\nData From Fig 7d – LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice\n\n\n\np-values\n\n\nmultiple testing\n\n\ngeneralized linear model\n\n\nabsurd CI\n\n\npower\n\n\nsimulation\n\n\npseudoreplication\n\n\nanalysis flag\n\n\n\nTwo interesting bits with Fig 7d: 1) The researchers analyzed figure 7b data using one-way ANOVA with Tukey adjustment. Post-hoc p-value adjustment is common but typically unjustified for bench biology data like these. The example is a good one to talk about p-value adjustment in bench biology. 2) The linear/ANOVA model implies absurd inference from the CI/SE error bars, including mean counts less than zero!\n\n\n\n\n\nJun 25, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nA LMM or GLMM alternative to ratio paired t-test is the best practice to plot the model\n\n\nData From Fig 3b – The TAS1R2 G-protein-coupled receptor is an ambient glucose sensor in skeletal muscle that regulates NAD homeostasis and mitochondrial capacity\n\n\n\nlinear mixed model\n\n\nratio paired t-test\n\n\ngeneralized linear mixed model\n\n\nggplot\n\n\n\nThe researchers analyzed figure 3b with a ratio paired t-test, which is a special case of a linear mixed model with a log-transformed response. A generalized linear mixed model with a Gamma distribution and log link is an alternative. An advantage to fitting the LMM or GLMM is asymmetric confidence intervals of the group means that reflect the skew of the data. Plot the model!\n\n\n\n\n\nJun 8, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nFig 2s – Pharmacological inhibition of HDAC6 improves muscle phenotypes in dystrophin-deficient mice by downregulating TGF-β via Smad3 acetylation\n\n\n\n\n\n\nlinear mixed model\n\n\nrandom intercept\n\n\nCRDS\n\n\nnested ANOVA\n\n\nggplot\n\n\n\nFig 2s is a Completely Randomized Design with subsampling (CRDS), with 28-49 technical replicates per mouse. The researchers used a Mann-Whitney test that ignored the technical replication. This analysis is massively pseudoreplicated because techanical replicates are not independent evidence of effect of treatment. Individual mouse ID was archived, which makes it easy to re-analyze with models that account for the non-independence. The p-value accounting for non-independence is 0.18 while the p-value using Mann-Whitney on all data is 0.0002. Whoops!\n\n\n\n\n\nJun 2, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nFig 3g – The role of somatosensory innervation of adipose tissues\n\n\n\n\n\n\nlinear mixed model\n\n\nrandom intercept\n\n\nsplit plot\n\n\nggplot\n\n\n\nFig 3g is a split-plot design. I often see researchers analyze these using separate paired t-tests. This isn’t so bad, but is limiting, and a better alternative is a linear mixed model. But does this replicate the Repeated Measures ANOVA in GraphPad used by the researchers? It does! Yaaay!\n\n\n\n\n\nMay 21, 2024\n\n\nJeff Walker\n\n\n\n\n\n\n\n\n\n\n\n\nFig 4h – FOXO1 is a master regulator of memory programming in CAR T cells\n\n\n\n\n\n\ntechnical replicates\n\n\npseudoreplication\n\n\nnested ANOVA\n\n\nCRDS\n\n\nanalysis flag\n\n\n\nFig 4h contains thousands of technical replicates. Technical replicates should not be analyzed as if they were randomly assigned to one of the experimental treatments. They weren’t. The resulting p-value is junk.\n\n\n\n\n\nMay 17, 2024\n\n\nJeff Walker\n\n\n\n\n\n\nNo matching items"
  }
]