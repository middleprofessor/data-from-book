m2_emm <- emmeans(m2, c("treatment"), type = "response")
m2_pairs <- contrast(m2_emm,
method = "revpairwise",
adjust = "tukey") |>
summary(infer = TRUE)
m2_pairs <- m2_pairs[, -7]
gg2 <- plot_response(m2,
m2_emm,
m2_pairs[1:3,],
palette = "pal_okabe_ito_blue",
#              x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"),
NULL)
plot_grid(gg1, gg2, ncol = 2, labels = "AUTO")
gg1 <- plot_response(m1,
m1_emm,
m1_pairs[1:3,],
palette = "pal_okabe_ito_blue",
#              x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"),
NULL)
m2 <- glm.nb(Fbxo32 ~ treatment, data = fig7d)
m2_emm <- emmeans(m2, c("treatment"), type = "response")
m2_pairs <- contrast(m2_emm,
method = focal_contrasts,
adjust = "none") |>
summary(infer = TRUE)
m2_pairs <- m2_pairs[, -7]
gg2 <- plot_response(m2,
m2_emm,
m2_pairs[1:3,],
palette = "pal_okabe_ito_blue",
#              x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"),
NULL)
plot_grid(gg1, gg2, ncol = 2, labels = "AUTO")
?saveRDS
# get parameters
do_it <- TRUE
if(do_it){
data_params <- fig7d[, .(mean = mean(Trim63),
N = .N), by = "treatment"]
mu <- rep(data_params$mean, data_params$N)
N <- sum(data_params$N)
m1 <- glm.nb(Trim63 ~ dex * cc, data = fig7d)
theta_sim <- m1$theta
n_sim <- 2000
fd <- data.table(
treatment = rep(c("veh", "dex", "dex_cc", "cc"), data_params$N),
dex = rep(c("no_dex", "dex", "dex", "no_dex"), data_params$N),
cc = rep(c("no_cc", "no_cc", "cc", "cc"), data_params$N),
Trim63 = as.numeric(NA)
)
# power
power_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(power_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu, theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
# type I
type1_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(type1_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu[1], theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
saveRDS(power_matrix, "power_matrix.Rds")
saveRDS(type1_matrix, "type1_matrix.Rds")
}else{
power_matrix <- readRDS("power_matrix.Rds")
type1_matrix <- readRDS("type1_matrix.Rds")
}
pless <- function(x){
stat <- sum(x < 0.05)/length(x)
return(stat)
}
res <- data.table(
Test = c("LM: DEX+CC - DEX", "LM: Interaction", "GLM: DEX+CC - DEX", "GLM: Interaction"),
Power = apply(power_matrix, 2, pless),
"Type I" = apply(type1_matrix, 2, pless)
)
res |>
kable() |>
kable_styling(full_width = FALSE)
# get parameters
do_it <- FALSE
if(do_it){
data_params <- fig7d[, .(mean = mean(Trim63),
N = .N), by = "treatment"]
mu <- rep(data_params$mean, data_params$N)
N <- sum(data_params$N)
m1 <- glm.nb(Trim63 ~ dex * cc, data = fig7d)
theta_sim <- m1$theta
n_sim <- 2000
fd <- data.table(
treatment = rep(c("veh", "dex", "dex_cc", "cc"), data_params$N),
dex = rep(c("no_dex", "dex", "dex", "no_dex"), data_params$N),
cc = rep(c("no_cc", "no_cc", "cc", "cc"), data_params$N),
Trim63 = as.numeric(NA)
)
# power
power_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(power_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu, theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
# type I
type1_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(type1_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu[1], theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
saveRDS(power_matrix, "power_matrix.Rds")
saveRDS(type1_matrix, "type1_matrix.Rds")
}else{
power_matrix <- readRDS("power_matrix.Rds")
type1_matrix <- readRDS("type1_matrix.Rds")
}
pless <- function(x){
stat <- sum(x < 0.05)/length(x)
return(stat)
}
res <- data.table(
Test = c("LM: DEX+CC - DEX", "LM: Interaction", "GLM: DEX+CC - DEX", "GLM: Interaction"),
Power = apply(power_matrix, 2, pless),
"Type I" = apply(type1_matrix, 2, pless)
)
res |>
kable() |>
kable_styling(full_width = FALSE)
knitr::purl("ggptm.Rmd")
packageVersion("quarto")
packageVersion("quarto")
install.packages("quarto")
knitr::opts_chunk$set(echo = TRUE)
# wrangling packages
library(here) # here makes a project transportable
library(janitor) # clean_names
library(readxl) # read excel, duh!
library(writexl) # write excel, duh!
library(data.table) # magical data frames
library(magrittr) # pipes
library(stringr) # string functions
library(forcats) # factor functions
# analysis packages
library(emmeans) # the workhorse for inference
library(nlme) # gls and some lmm
library(lme4) # linear mixed models
library(lmerTest) # linear mixed model inference
library(afex) # ANOVA linear models
library(glmmTMB) # generalized linear models
library(MASS) # negative binomial and some other functions
library(car) # model checking and ANOVA
library(DHARMa) # model checking
library(mvtnorm)
library(MHTdiscrete) # sidak
# graphing packages
library(ggsci) # color palettes
library(ggpubr) # publication quality plots
library(ggforce) # better jitter
library(cowplot) # combine plots
library(knitr) # kable tables
library(kableExtra) # kable_styling tables
# ggplot_the_model.R packages not loaded above
library(insight)
library(lazyWeave)
# use here from the here package
here <- here::here
# use clean_names from the janitor package
clean_names <- janitor::clean_names
# use transpose from data.table
transpose <- data.table::transpose
# load functions used by this text written by me
# ggplot_the_model.R needs to be in the folder "R"
# if you didn't download this and add to your R folder in your
# project, then this line will cause an error
source_path <- here("R", "ggplot_the_model.R")
source(source_path)
source_path <- here("R", "ggptm.R")
source(source_path)
data_folder <- "data from"
image_folder <- "images"
output_folder <- "output"
packageVersion("quarto")
packageVersion("quarto")
knitr::opts_chunk$set(echo = TRUE)
# wrangling packages
library(here) # here makes a project transportable
library(janitor) # clean_names
library(readxl) # read excel, duh!
library(writexl) # write excel, duh!
library(data.table) # magical data frames
library(magrittr) # pipes
library(stringr) # string functions
library(forcats) # factor functions
# analysis packages
library(emmeans) # the workhorse for inference
library(nlme) # gls and some lmm
library(lme4) # linear mixed models
library(lmerTest) # linear mixed model inference
library(afex) # ANOVA linear models
library(glmmTMB) # generalized linear models
library(MASS) # negative binomial and some other functions
library(car) # model checking and ANOVA
library(DHARMa) # model checking
library(mvtnorm)
library(MHTdiscrete) # sidak
# graphing packages
library(ggsci) # color palettes
library(ggpubr) # publication quality plots
library(ggforce) # better jitter
library(cowplot) # combine plots
library(knitr) # kable tables
library(kableExtra) # kable_styling tables
# ggplot_the_model.R packages not loaded above
library(insight)
library(lazyWeave)
# use here from the here package
here <- here::here
# use clean_names from the janitor package
clean_names <- janitor::clean_names
# use transpose from data.table
transpose <- data.table::transpose
# load functions used by this text written by me
# ggplot_the_model.R needs to be in the folder "R"
# if you didn't download this and add to your R folder in your
# project, then this line will cause an error
source_path <- here("R", "ggplot_the_model.R")
source(source_path)
source_path <- here("R", "ggptm.R")
source(source_path)
data_folder <- "data from"
image_folder <- "images"
output_folder <- "output"
data_from <- "LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice"
file_name <- "41467_2024_47846_MOESM4_ESM.xlsx"
file_path <- here(data_folder, data_from, file_name)
read7d <- function(range_val = "B3:E13", label_val = "Fbxo32"){
fig7d_part <- read_excel(file_path,
sheet = "Fig. 7d",
range = range_val,
col_names = TRUE) |>
data.table() |>
melt(variable.name = "excel_label", value.name = "y")
# un-normalize count by multiplying by 10^6
fig7d_part[, y := as.integer(y * 10^6)]
setnames(fig7d_part, old = "y", new = label_val)
fig7d_part[, mouse_id := paste0("mouse_", .I)]
return(fig7d_part)
}
fig7d <- read7d(range_val = "B3:E13", label_val = "Fbxo32")
fig7d <- merge(fig7d,
read7d(range_val = "B16:E26", label_val = "Trim63"),
by = c("excel_label", "mouse_id"))
fig7d <- merge(fig7d,
read7d(range_val = "B29:E39", label_val = "Atg7"),
by = c("excel_label", "mouse_id"))
fig7d <- merge(fig7d,
read7d(range_val = "B42:E52", label_val = "Becn1"),
by = c("excel_label", "mouse_id"))
fig7d <- merge(fig7d,
read7d(range_val = "B55:E65", label_val = "Bnip3"),
by = c("excel_label", "mouse_id"))
# remove the missing count
fig7d <- na.omit(fig7d)
# better treatment labels than in excel file
fig7d[excel_label == "Ctrl Oil", treatment := "Vehicle"]
fig7d[excel_label == "DEX", treatment := "DEX"]
fig7d[excel_label == "DEX+CC-90011", treatment := "DEX+CC"]
fig7d[excel_label == "CC-90011", treatment := "CC"]
fig7d[, treatment := factor(treatment, levels = unique(fig7d$treatment))]
# split treatment into two factors
fig7d[treatment == "Vehicle", dex := "Dex_neg"]
fig7d[treatment == "Vehicle", cc := "CC_neg"]
fig7d[treatment == "DEX", dex := "Dex_pos"]
fig7d[treatment == "DEX", cc := "CC_neg"]
fig7d[treatment == "DEX+CC", dex := "Dex_pos"]
fig7d[treatment == "DEX+CC", cc := "CC_pos"]
fig7d[treatment == "CC", dex := "Dex_neg"]
fig7d[treatment == "CC", cc := "CC_pos"]
fig7d[, dex := factor(dex, levels = c("Dex_neg", "Dex_pos"))]
fig7d[, cc := factor(cc, levels = c("CC_neg", "CC_pos"))]
file_out_name <- "LSD1 inhibition circumvents glucocorticoid-induced muscle wasting of male mice.xlsx"
fileout_path <- here(data_folder, data_from, file_out_name)
write_xlsx(fig7d, fileout_path)
Fbxo32_4 <- fig7d[, Fbxo32]/10^6 * 10^4
m1 <- lm(Fbxo32 ~ treatment, data = fig7d)
m2 <- lm(Fbxo32_4 ~ treatment, data = fig7d)
coef(summary(m1))
coef(summary(m2))
m1 <- lm(Fbxo32 ~ treatment, data = fig7d)
# the researcher's analysis
m0 <- lm(Fbxo32 ~ treatment, data = fig7d)
m0_emm <- emmeans(m0, c("treatment"))
m0_pairs <- contrast(m0_emm,
method = "revpairwise",
adjust = "tukey") |>
summary(infer = TRUE)
# the analysis only comparing the families of tests that we care about
veh = c(1, 0, 0, 0)
dex = c(0, 1, 0, 0)
dex_cc = c(0, 0, 1, 0) # note the wonky ordering in fig 7d
cc = c(0,0,0,1)
focal_contrasts = list(
"DEX - Vehicle" = dex - veh,
"CC - Vehicle" = cc - veh,
"DEX+CC - DEX" = dex_cc - dex,
"interaction" = (dex_cc - dex) - (cc - veh)
)
m1 <- lm(Fbxo32 ~ treatment, data = fig7d)
m1_emm <- emmeans(m1, c("treatment"))
m1_pairs <- contrast(m1_emm,
method = focal_contrasts,
adjust = "none") |>
summary(infer = TRUE)
contrast_table <-
rbind(m0_pairs, m1_pairs)
contrast_table |>
kable(digits = 4) |>
kable_styling() |>
pack_rows("Adjusted", 1, 6) |>
pack_rows("Non-adjusted", 7, 10)
gg1 <- plot_response(m1,
m1_emm,
m1_pairs[1:3,],
palette = "pal_okabe_ito_blue",
#              x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"),
NULL)
m2 <- glm.nb(Fbxo32 ~ treatment, data = fig7d)
m2_emm <- emmeans(m2, c("treatment"), type = "response")
m2_pairs <- contrast(m2_emm,
method = focal_contrasts,
adjust = "none") |>
summary(infer = TRUE)
m2_pairs <- m2_pairs[, -7]
gg2 <- plot_response(m2,
m2_emm,
m2_pairs[1:3,],
palette = "pal_okabe_ito_blue",
#              x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"),
NULL)
plot_grid(gg1, gg2, ncol = 2, labels = "AUTO")
save_it <- TRUE
if(save_it){
out_fig <- "fig7d_ggplot.png"
out_path <- here("figs", data_from, out_fig)
ggsave(out_path)
}
# get parameters
do_it <- FALSE
if(do_it){
data_params <- fig7d[, .(mean = mean(Trim63),
N = .N), by = "treatment"]
mu <- rep(data_params$mean, data_params$N)
N <- sum(data_params$N)
m1 <- glm.nb(Trim63 ~ dex * cc, data = fig7d)
theta_sim <- m1$theta
n_sim <- 2000
fd <- data.table(
treatment = rep(c("veh", "dex", "dex_cc", "cc"), data_params$N),
dex = rep(c("no_dex", "dex", "dex", "no_dex"), data_params$N),
cc = rep(c("no_cc", "no_cc", "cc", "cc"), data_params$N),
Trim63 = as.numeric(NA)
)
# power
power_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(power_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu, theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
power_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
power_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
# type I
type1_matrix <- matrix(nrow = n_sim, ncol = 4)
colnames(type1_matrix) <- c("lm_focal", "lm_ixn", "glm_focal", "glm_ixn")
for(sim_i in 1:n_sim){
# fake data
fd[, Trim63 := rnegbin(N, mu[1], theta_sim)]
# lm/ANOVA
m_lm <- lm(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "lm_ixn"] <- coef(summary(m_lm))["dexno_dex:ccno_cc", "Pr(>|t|)"]
m_lm_pairs <- emmeans(m_lm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "lm_focal"] <- m_lm_pairs[3, "p.value"] # effect of CC when dex is present
# glm neg bin
m_glm <- glm.nb(Trim63 ~ dex * cc, data = fd)
type1_matrix[sim_i, "glm_ixn"] <- coef(summary(m_glm))["dexno_dex:ccno_cc", "Pr(>|z|)"]
m_glm_pairs <- emmeans(m_glm, specs = c("dex", "cc")) |>
contrast(method = "revpairwise", simple = "each", combine = TRUE, adjust = "none") |>
summary(infer = TRUE)
type1_matrix[sim_i, "glm_focal"] <- m_glm_pairs[3, "p.value"] # effect of CC when dex is present
}
saveRDS(power_matrix, "power_matrix.Rds")
saveRDS(type1_matrix, "type1_matrix.Rds")
}else{
power_matrix <- readRDS("power_matrix.Rds")
type1_matrix <- readRDS("type1_matrix.Rds")
}
pless <- function(x){
stat <- sum(x < 0.05)/length(x)
return(stat)
}
res <- data.table(
Test = c("LM: DEX+CC - DEX", "LM: Interaction", "GLM: DEX+CC - DEX", "GLM: Interaction"),
Power = apply(power_matrix, 2, pless),
"Type I" = apply(type1_matrix, 2, pless)
)
res |>
kable() |>
kable_styling(full_width = FALSE)
get_model_result <- function(gene_i){
model_formula <- paste(gene_i, "~ treatment") |>
as.formula()
m1 <- glm.nb(model_formula, data = fig7d)
m1_emm <- emmeans(m1, specs = c("treatment"), type = "response")
m1_pairs <- contrast(m1_emm,
method = focal_contrasts,
adjust = "none") |>
summary(infer = TRUE)
return(list(m1 = m1, m1_emm = m1_emm, m1_pairs = m1_pairs))
}
res1 <- get_model_result("Fbxo32")
gg1 <- plot_response(res1$m1, res1$m1_emm, res1$m1_pairs[c(1,3,2),], palette = "pal_okabe_ito_blue",
x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"))
res2 <- get_model_result("Trim63")
gg2 <- plot_response(res2$m1, res2$m1_emm, res2$m1_pairs[c(1,3,2),], palette = "pal_okabe_ito_blue",
x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"))
res3 <- get_model_result("Atg7")
gg3 <- plot_response(res3$m1, res3$m1_emm, res3$m1_pairs[c(1,3,2),], palette = "pal_okabe_ito_blue",
x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"))
res4 <- get_model_result("Becn1")
gg4 <- plot_response(res4$m1, res4$m1_emm, res4$m1_pairs[c(1,3,2),], palette = "pal_okabe_ito_blue",
x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"))
res5 <- get_model_result("Bnip3")
gg5 <- plot_response(res5$m1, res5$m1_emm, res5$m1_pairs[c(1,3,2),], palette = "pal_okabe_ito_blue",
x_axis_labels = c("DEX-\nCC-", "DEX+\nCC-", "DEX+\nCC+", "DEX-\nCC+"))
plot_grid(gg1, gg2, gg3, gg4, gg5, nrow = 3)
# gg1
# gg2
# gg3
# gg4
# gg5
