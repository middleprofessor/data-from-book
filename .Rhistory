lmm1_pairs
names(fig3b)
log(1)
?t.test
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
t.test(log_ba, mu = 0)
log_a <- fig3b[genotype == "Veh", ppar1] |>
log()
log_a <- fig3b[genotype == "Veh", ppar1] |>
log()
log_b <- fig3b[genotype == "Asp", ppar1] |>
log()
t.test(log_b, log_a, var.equal = TRUE)
log_a <- fig3b[genotype == "Veh", ppar1] |>
log()
log_b <- fig3b[genotype == "Asp", ppar1] |>
log()
t.test(log_b, log_a, paired = TRUE)
glmm1 <- glmmTMB(ppar1 ~ genotype + (1 | mouse),
family = Gamma(link="log"),
data = fig3b)
glmm1_emm <- emmeans(glmm1,
specs ="genotype",
type = "response")
glmm1_pairs <- contrast(glmm1_emm,
method ="revpairwise")
glmm1_pairs
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(ba)
prod(ba)^(1/length(ba))
glmm1 <- glmmTMB(ppar1 ~ genotype + (1 | mouse),
family = Gamma(link="log"),
data = fig3b)
glmm1_emm <- emmeans(glmm1,
specs ="genotype",
type = "response")
glmm1_pairs <- contrast(glmm1_emm,
method ="revpairwise") |>
summary(infer = TRUE)
glmm1_pairs
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(ba)
prod(ba)^(1/length(ba)) # geometric mean compuation 1
exp(mean(log_ba))
glmm0 <- glmmTMB(ppar1 ~ genotype,
family = Gamma(link="log"),
data = fig3b)
glmm0_emm <- emmeans(glmm0,
specs ="genotype",
type = "response")
glmm0_pairs <- contrast(glmm0_emm,
method ="revpairwise") |>
summary(infer = TRUE)
glmm1 <- glmmTMB(ppar1 ~ genotype + (1 | mouse),
family = Gamma(link="log"),
data = fig3b)
glmm1_emm <- emmeans(glmm1,
specs ="genotype",
type = "response")
glmm1_pairs <- contrast(glmm1_emm,
method ="revpairwise") |>
summary(infer = TRUE)
glmm0_pairs
glmm1_pairs
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(b)/mean(a)
mean(ba)
prod(ba)^(1/length(ba)) # geometric mean compuation 1
exp(mean(log_ba)) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(b)/mean(a)
exp(mean(log(b))/mean(log(a)))
mean(ba)
prod(ba)^(1/length(ba)) # geometric mean compuation 1
exp(mean(log_ba)) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(b)/mean(a)
mean(log(b))/mean(log(a))
mean(ba)
prod(ba)^(1/length(ba)) # geometric mean compuation 1
exp(mean(log_ba)) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(b)/mean(a)
mean(ba)
prod(ba)^(1/length(ba)) # geometric mean compuation 1
exp(mean(log_ba)) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
log_ba <- log(b/a)
ba <- b/a
mean(b)/mean(a)
mean(b/a)
prod(b/a)^(1/length(b/a)) # geometric mean compuation 1
exp(mean(log(b/a))) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
mean(b)/mean(a) # ratio of means
log(mean(b)) - log(mean(a))
mean(b/a) # (arithmetic) mean ratio
prod(b/a)^(1/length(b/a)) # geometric mean computation 1
exp(mean(log(b/a))) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
mean(b)/mean(a) # ratio of means
exp(log(mean(b)) - log(mean(a)))
mean(b/a) # (arithmetic) mean ratio
prod(b/a)^(1/length(b/a)) # geometric mean computation 1
exp(mean(log(b/a))) # geometric mean computation 2
glmm1 <- glmmTMB(ppar1 ~ genotype + (1 | mouse),
family = Gamma(link="log"),
data = fig3b)
glmm1_emm <- emmeans(glmm1,
specs ="genotype",
type = "response")
glmm1_pairs <- contrast(glmm1_emm,
method ="revpairwise") |>
summary(infer = TRUE)
glmm1_pairs
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
mean(b)/mean(a) # ratio of means
exp(log(mean(b)) - log(mean(a)))
exp(log(b) - log(a))
mean(b/a) # (arithmetic) mean ratio
prod(b/a)^(1/length(b/a)) # geometric mean computation 1
exp(mean(log(b/a))) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
mean(b)/mean(a) # ratio of means
exp(log(mean(b)) - log(mean(a)))
exp(mean(log(b)) - mean(log(a)))
mean(b/a) # (arithmetic) mean ratio
prod(b/a)^(1/length(b/a)) # geometric mean computation 1
exp(mean(log(b/a))) # geometric mean computation 2
a <- fig3b[genotype == "Veh", ppar1]
b <- fig3b[genotype == "Asp", ppar1]
mean(b)/mean(a) # ratio of means
exp(log(mean(b)) - log(mean(a)))
exp(mean(log(b)) - mean(log(a)))
prod(b/a)^(1/length(b/a)) # geometric mean computation 1
exp(mean(log(b/a))) # geometric mean computation 2
glmm0 <- glmmTMB(ppar1 ~ genotype,
family = Gamma(link="log"),
data = fig3b)
glmm0_emm <- emmeans(glmm0,
specs ="genotype",
type = "response")
glmm0_pairs <- contrast(glmm0_emm,
method ="revpairwise") |>
summary(infer = TRUE)
glmm0_pairs
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1)) +
geom_jitter()
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1)) +
geom_jitter()
gg
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1)) +
geom_jitter(width = 0.2)
gg
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1)) +
geom_jitter(width = 0.1) +
theme_pubr() +
ylab("p-PAR1")
gg
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = emmean)) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response),
ymin = lower.CL,
ymax = upper.CL) +
theme_pubr() +
ylab("p-PAR1")
is.data.frame(lmm1_emm)
?geom_errorbar
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL)) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm
lmm1 <- lmer(log(ppar1) ~ genotype + (1 | mouse),
data = fig3b)
lmm1_emm <- emmeans(lmm1,
specs ="genotype",
type = "response")
lmm1_pairs <- contrast(lmm1_emm,
method ="revpairwise") |>
summary(infer = TRUE)
lmm1_pairs
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL)) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype,
group = mouse)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1) +
geom_point(data = lmm1_emm,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
theme_pubr() +
ylab("p-PAR1")
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
ylab("p-PAR1") +
scale_color_manual(values = pal_okabe_ito_2) +
theme_pubr() +
theme(axis.title.x = element_blank()) +
gg
lmm1_emm <- summary(lmm1_emm)
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
ylab("p-PAR1") +
scale_color_manual(values = pal_okabe_ito_2) +
theme_pubr() +
theme(axis.title.x = element_blank()) +
NULL
gg
lmm1_emm <- emmeans(lmm1,
specs ="genotype",
type = "response")
lmm1_pairs <- contrast(lmm1_emm,
method ="revpairwise") |>
summary(infer = TRUE)
lmm1_pairs
lmm1_emm_dt <- summary(lmm1_emm) |>
data.table()
lmm1_pairs_dt <- lmm1_pairs |>
data.table()
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
ylab("p-PAR1") +
scale_color_manual(values = pal_okabe_ito_2) +
theme_pubr() +
theme(axis.title.x = element_blank()) +
NULL
lmm1_emm_dt <- summary(lmm1_emm) |>
data.table()
lmm1_pairs_dt <- lmm1_pairs |>
data.table()
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm_dt,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm_dt,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
ylab("p-PAR1") +
scale_color_manual(values = pal_okabe_ito_2) +
theme_pubr() +
theme(axis.title.x = element_blank()) +
NULL
# add p-values
lmm1_pairs_dt[, group1 := "Veh"]
lmm1_pairs_dt[, group2 := "Asp"]
lmm1_pairs_dt[, p := p.value |>
p_round(digits = 2) |>
p_format(digits = 2, accuracy = 1e-04, add.p = TRUE)]
maxy <- fig2s[, max(ppar1)]
lmm1_emm_dt <- summary(lmm1_emm) |>
data.table()
lmm1_pairs_dt <- lmm1_pairs |>
data.table()
gg <- ggplot(data = fig3b,
aes(x = genotype,
y = ppar1,
color = genotype)) +
geom_jitter(width = 0.1,
show.legend = FALSE) +
geom_point(data = lmm1_emm_dt,
aes(x = genotype,
y = response),
size = 3,
show.legend = FALSE) +
geom_errorbar(data = lmm1_emm_dt,
aes(x = genotype,
y = response,
ymin = lower.CL,
ymax = upper.CL),
width = 0.05,
show.legend = FALSE) +
ylab("p-PAR1") +
scale_color_manual(values = pal_okabe_ito_2) +
theme_pubr() +
theme(axis.title.x = element_blank()) +
NULL
# add p-values
lmm1_pairs_dt[, group1 := "Veh"]
lmm1_pairs_dt[, group2 := "Asp"]
lmm1_pairs_dt[, p := p.value |>
p_round(digits = 2) |>
p_format(digits = 2, accuracy = 1e-04, add.p = TRUE)]
maxy <- fig3b[, max(ppar1)]
miny <- fig3b[, min(ppar1)]
lmm1_pairs_dt[, y.position := maxy + 0.05*(maxy - miny)]
gg <- gg +
stat_pvalue_manual(
data = lmm1_pairs_dt,
label = "p",
tip.length = 0.001)
gg
save_it <- TRUE
if(save_it){
out_fig <- "fig3b_ggplot.png"
out_path <- here("figs", data_from, out_fig)
ggsave(out_path)
}
