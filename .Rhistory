fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "g",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
View(fig3)
data_from <- "Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice"
file_name <- "41467_2023_42473_MOESM7_ESM.xlsx"
file_path <- here(data_folder, data_from, file_name)
fig3_import <- function(range_in = "xxx"){
fig3_wide <- read_excel(file_path,
sheet = "Fig. 3",
range = range_in) |>
data.table()
fig3_long <- melt(fig3_wide,
measure.vars = colnames(fig3_wide),
variable.name = "treatment",
value.name = "cardiolipin") |>
na.omit()
fig3_long[, treatment := factor(treatment,
levels = colnames(fig3_wide))]
return(fig3_long)
}
fig3 <- data.table(NULL)
row_1 <- 12
for(fig_id in letters[4:21]){
row_2 <- row_1 + 5
range_in <- paste0(
"B",row_1,":E",row_2
)
fig3 <- rbind(
fig3,
data.table(
figure = fig_id,
fig3_import(range_in))
)
row_1 <- row_2 + 4
}
fig3 <- rbind(
fig3,
data.table(
figure = "f",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "g",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
View(fig3)
data_from <- "Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice"
file_name <- "41467_2023_42473_MOESM7_ESM.xlsx"
file_path <- here(data_folder, data_from, file_name)
fig3_import <- function(range_in = "xxx"){
fig3_wide <- read_excel(file_path,
sheet = "Fig. 3",
range = range_in) |>
data.table()
fig3_long <- melt(fig3_wide,
measure.vars = colnames(fig3_wide),
variable.name = "treatment",
value.name = "cardiolipin") |>
na.omit()
fig3_long[, treatment := factor(treatment,
levels = colnames(fig3_wide))]
return(fig3_long)
}
fig3 <- data.table(NULL)
row_1 <- 12
for(j in 1:18){
fig_id <- letters[j]
row_2 <- row_1 + 5
range_in <- paste0(
"B",row_1,":E",row_2
)
fig3 <- rbind(
fig3,
data.table(
figure = fig_id,
fig3_import(range_in))
)
row_1 <- row_2 + 4
}
fig3 <- rbind(
fig3,
data.table(
figure = "f",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "g",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
fig3 <- rbind(
fig3,
data.table(
figure = "h",
fig3_import("B21:E26"))
)
data_from <- "Lipocalin 2 regulates mitochondrial phospholipidome remodeling, dynamics, and function in brown adipose tissue in male mice"
file_name <- "41467_2023_42473_MOESM7_ESM.xlsx"
file_path <- here(data_folder, data_from, file_name)
fig3_import <- function(range_in = "xxx"){
fig3_wide <- read_excel(file_path,
sheet = "Fig. 3",
range = range_in) |>
data.table()
fig3_long <- melt(fig3_wide,
measure.vars = colnames(fig3_wide),
variable.name = "treatment",
value.name = "cardiolipin") |>
na.omit()
fig3_long[, treatment := factor(treatment,
levels = colnames(fig3_wide))]
return(fig3_long)
}
fig3 <- data.table(NULL)
row_1 <- 12
for(fig_id in letters[4:21]){
row_2 <- row_1 + 5
range_in <- paste0(
"B",row_1,":E",row_2
)
fig3 <- rbind(
fig3,
data.table(
figure = fig_id,
fig3_import(range_in))
)
row_1 <- row_2 + 4
}
View(fig3)
n_cardiolipins <- length(unique(fig3$figure))
n_cardiolipins
set_i <- 1
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- contrast(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none")
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none")
m1_pairs
m1_pairs
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
data.table
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
data.table()
m1_pairs
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
m1_pairs
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[, .SD, .SDcols = c("contrast", "p.value")]
)
)
}
View(p_table)
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")]
)
)
}
View(p_table)
p_table[, holm := p.adjust(p, "holm")]
p_table[, holm := p.adjust(p,value, "holm")]
p_table[, holm := p.adjust(p.value, "holm")]
View(p_table)
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")]
)
)
p_table[, holm := p.adjust(p.value, "holm")]
p_table[, fdr := p.adjust(p.value, "fdr")]
}
set_i
p_table
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")]
)
)
}
p_table[, holm := p.adjust(p.value, "holm")]
p_table[, fdr := p.adjust(p.value, "fdr")]
View(p_table)
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
m1 <- lm(cardiolipin ~ treatment, data = fig3[figure == lipin_id[set_i]])
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")]
)
)
}
p_table[, holm := p.adjust(p.value, "holm") |> round(3)]
p_table[, fdr := p.adjust(p.value, "fdr") |> round(3)]
p_table[, p.value := round(p.value, 4)]
View(p_table)
levels(fig3$treatment)
set_i <- 1
subdata <- fig3[figure == lipin_id[set_i]]
m1 <- lm(cardiolipin ~ treatment, data = subdata)
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6 and use t-test
t1 <- t.test(subdata[treatment == "WT-Saline",],
subdata[treatment == "WT-CL",],
var.equal = TRUE)
subdata[treatment == "WT-Saline",]
# authors are keeping contrasts in rows 1,2,6 and use t-test
t1 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "WT-CL", cardiolipin],
var.equal = TRUE)
t1
names(t1)
m1_pairs
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
subdata <- fig3[figure == lipin_id[set_i]]
m1 <- lm(cardiolipin ~ treatment, data = subdata)
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6 and use t-test
p1 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "WT-CL", cardiolipin],
var.equal = TRUE)$p.value
p2 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "KO-Saline", cardiolipin],
var.equal = TRUE)$p.value
p3 <- t.test(subdata[treatment == "KO-Saline", cardiolipin],
subdata[treatment == "KO-CL", cardiolipin],
var.equal = TRUE)$p.value
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")],
ttest = c(p1, p2, p3)
)
)
}
p_table[, holm := p.adjust(p.value, "holm") |> round(3)]
p_table[, fdr := p.adjust(p.value, "fdr") |> round(3)]
p_table[, p.value := round(p.value, 4)]
View(p_table)
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
subdata <- fig3[figure == lipin_id[set_i]]
m1 <- lm(cardiolipin ~ treatment, data = subdata)
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6 and use t-test
p1 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "WT-CL", cardiolipin],
var.equal = TRUE)$p.value
p2 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "KO-Saline", cardiolipin],
var.equal = TRUE)$p.value
p3 <- t.test(subdata[treatment == "KO-Saline", cardiolipin],
subdata[treatment == "KO-CL", cardiolipin],
var.equal = TRUE)$p.value
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")],
ttest = c(p1, p2, p3)
)
)
}
p_table[, holm := p.adjust(ttest, "holm") |> round(3)]
p_table[, fdr := p.adjust(ttest, "fdr") |> round(3)]
p_table[, p.value := round(ttest, 4)]
View(p_table)
data.table(
adjust = c("none", "holm", "fdr"),
n_lt_5 = c(sum(p_table[, ttest] < 0.05),
sum(p_table[, holm] < 0.05),
sum(p_table[, fdr] < 0.05),)
)
data.table(
adjust = c("none", "holm", "fdr"),
n_lt_5 = c(sum(p_table[, ttest] < 0.05),
sum(p_table[, holm] < 0.05),
sum(p_table[, fdr] < 0.05))
)
data.table(
adjust = c("none", "holm", "fdr"),
n_lt_5 = c(sum(p_table[, p.value] < 0.05),
sum(p_table[, ttest] < 0.05),
sum(p_table[, holm] < 0.05),
sum(p_table[, fdr] < 0.05))
)
lipin_id <- unique(fig3$figure)
n_cardiolipins <- length(lipin_id)
p_table <- data.table(NULL)
for(set_i in 1:n_cardiolipins){
subdata <- fig3[figure == lipin_id[set_i]]
m1 <- lm(cardiolipin ~ treatment, data = subdata)
m1_pairs <- emmeans(m1, specs = "treatment") |>
contrast(method = "revpairwise",
adjust = "none") |>
summary() |>
data.table()
# authors are keeping contrasts in rows 1,2,6 and use t-test
p1 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "WT-CL", cardiolipin],
var.equal = TRUE)$p.value
p2 <- t.test(subdata[treatment == "WT-Saline", cardiolipin],
subdata[treatment == "KO-Saline", cardiolipin],
var.equal = TRUE)$p.value
p3 <- t.test(subdata[treatment == "KO-Saline", cardiolipin],
subdata[treatment == "KO-CL", cardiolipin],
var.equal = TRUE)$p.value
p_table <- rbind(
p_table,
data.table(
lipin_id = lipin_id[set_i],
m1_pairs[c(1,2,6), .SD, .SDcols = c("contrast", "p.value")],
ttest = c(p1, p2, p3)
)
)
}
p_table[, holm := p.adjust(ttest, "holm") |> round(3)]
p_table[, fdr := p.adjust(ttest, "fdr") |> round(3)]
p_table[, ttest := round(ttest, 4)]
data.table(
adjust = c("lm","ttest", "holm", "fdr"),
n_lt_5 = c(sum(p_table[, p.value] < 0.05),
sum(p_table[, ttest] < 0.05),
sum(p_table[, holm] < 0.05),
sum(p_table[, fdr] < 0.05))
)
